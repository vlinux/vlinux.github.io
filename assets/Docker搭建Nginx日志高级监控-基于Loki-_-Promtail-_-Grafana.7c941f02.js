import{_ as r}from"./ValaxyMain.vue_vue_type_style_index_0_lang.b3f0e471.js";import{_ as c,c as p,w as l,o as d,r as a,g as s,R as n,p as g}from"./app.819a3b04.js";import"./YunFooter.vue_vue_type_script_setup_true_lang.4d539698.js";import"./YunCard.vue_vue_type_style_index_0_lang.a6c5f832.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.e1d0d7c0.js";const Ss=JSON.parse('{"title":"Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki + Promtail + Grafana","description":"","frontmatter":{"title":"Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki + Promtail + Grafana","categories":"\u76D1\u63A7\u5206\u6790","tags":["Loki"],"date":"2021-06-30T14:55:35.000Z"},"headers":[{"level":2,"title":"Ngin\u6DFB\u52A0GeoIP\u6A21\u5757","slug":"ngin\u6DFB\u52A0geoip\u6A21\u5757","link":"#ngin\u6DFB\u52A0geoip\u6A21\u5757","children":[]},{"level":2,"title":"1.1 \u505C\u6B62\u73B0\u6709Nginx","slug":"_1-1-\u505C\u6B62\u73B0\u6709nginx","link":"#_1-1-\u505C\u6B62\u73B0\u6709nginx","children":[]},{"level":2,"title":"1.2 \u5E26GeoIP\u91CD\u65B0\u7F16\u8BD1Nginx","slug":"_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx","link":"#_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx","children":[{"level":3,"title":"1.2.1 \u4E0B\u8F7DGeoIP\u4F9D\u8D56","slug":"_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56","link":"#_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56","children":[]},{"level":3,"title":"1.2.2 \u8FDB\u5165nginx/sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","slug":"_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","link":"#_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","children":[]},{"level":3,"title":"1.2.3 \u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","slug":"_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","link":"#_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","children":[]},{"level":3,"title":"1.2.4 \u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","slug":"_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","link":"#_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","children":[]}]},{"level":2,"title":"1.3. \u67E5\u770BGeoIP.dat\u4F4D\u7F6E","slug":"_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E","link":"#_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E","children":[]},{"level":2,"title":"1.4. \u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","slug":"_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","link":"#_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","children":[]},{"level":2,"title":"1.5. \u91CD\u542Fnginx","slug":"_1-5-\u91CD\u542Fnginx","link":"#_1-5-\u91CD\u542Fnginx","children":[]},{"level":2,"title":"1.6. \u67E5\u770B\u5927\u56FE","slug":"_1-6-\u67E5\u770B\u5927\u56FE","link":"#_1-6-\u67E5\u770B\u5927\u56FE","children":[]},{"level":2,"title":"1.7. \u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","slug":"_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","link":"#_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","children":[]}],"relativePath":"pages/posts/Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki-+-Promtail-+-Grafana.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki-+-Promtail-+-Grafana.md","lastUpdated":0}'),o=JSON.parse('{"title":"Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki + Promtail + Grafana","description":"","frontmatter":{"title":"Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki + Promtail + Grafana","categories":"\u76D1\u63A7\u5206\u6790","tags":["Loki"],"date":"2021-06-30T14:55:35.000Z"},"headers":[{"level":2,"title":"Ngin\u6DFB\u52A0GeoIP\u6A21\u5757","slug":"ngin\u6DFB\u52A0geoip\u6A21\u5757","link":"#ngin\u6DFB\u52A0geoip\u6A21\u5757","children":[]},{"level":2,"title":"1.1 \u505C\u6B62\u73B0\u6709Nginx","slug":"_1-1-\u505C\u6B62\u73B0\u6709nginx","link":"#_1-1-\u505C\u6B62\u73B0\u6709nginx","children":[]},{"level":2,"title":"1.2 \u5E26GeoIP\u91CD\u65B0\u7F16\u8BD1Nginx","slug":"_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx","link":"#_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx","children":[{"level":3,"title":"1.2.1 \u4E0B\u8F7DGeoIP\u4F9D\u8D56","slug":"_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56","link":"#_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56","children":[]},{"level":3,"title":"1.2.2 \u8FDB\u5165nginx/sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","slug":"_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","link":"#_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","children":[]},{"level":3,"title":"1.2.3 \u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","slug":"_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","link":"#_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","children":[]},{"level":3,"title":"1.2.4 \u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","slug":"_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","link":"#_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","children":[]}]},{"level":2,"title":"1.3. \u67E5\u770BGeoIP.dat\u4F4D\u7F6E","slug":"_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E","link":"#_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E","children":[]},{"level":2,"title":"1.4. \u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","slug":"_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","link":"#_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","children":[]},{"level":2,"title":"1.5. \u91CD\u542Fnginx","slug":"_1-5-\u91CD\u542Fnginx","link":"#_1-5-\u91CD\u542Fnginx","children":[]},{"level":2,"title":"1.6. \u67E5\u770B\u5927\u56FE","slug":"_1-6-\u67E5\u770B\u5927\u56FE","link":"#_1-6-\u67E5\u770B\u5927\u56FE","children":[]},{"level":2,"title":"1.7. \u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","slug":"_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","link":"#_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","children":[]}],"relativePath":"pages/posts/Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki-+-Promtail-+-Grafana.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki-+-Promtail-+-Grafana.md","lastUpdated":0}'),_={name:"pages/posts/Docker\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u57FA\u4E8ELoki-+-Promtail-+-Grafana.md",data(){return{data:o,frontmatter:o.frontmatter}},setup(){g("pageData",o)}},h=s("h1",{id:"\u624B\u628A\u624B\u642D\u5EFAnginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u2014\u2014-\u57FA\u4E8Eloki-promtail-grafana",tabindex:"-1"},[n("\u624B\u628A\u624B\u642D\u5EFANginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7 \u2014\u2014 \u57FA\u4E8ELoki + Promtail + Grafana "),s("a",{class:"header-anchor",href:"#\u624B\u628A\u624B\u642D\u5EFAnginx\u65E5\u5FD7\u9AD8\u7EA7\u76D1\u63A7-\u2014\u2014-\u57FA\u4E8Eloki-promtail-grafana","aria-hidden":"true"},"#")],-1),u=s("blockquote",null,[s("p",null,"\u53C2\u8003\u5B98\u65B9\u6587\u6863\uFF1A"),s("p",null,[n("Loki: "),s("a",{href:"https://grafana.com/docs/loki/latest/",target:"_blank",rel:"noreferrer"},"https://grafana.com/docs/loki/latest/")]),s("p",null,[n("Grafana Loki V2 Dashboard for Nginx "),s("a",{href:"https://grafana.com/grafana/dashboards/12559?pg=dashboards&plcmt=featured-main",target:"_blank",rel:"noreferrer"},"https://grafana.com/grafana/dashboards/12559?pg=dashboards&plcmt=featured-main")])],-1),m=s("p",null,"\u65E5\u5FD7\u6536\u96C6\u6548\u679C\u622A\u56FE\uFF1A",-1),y=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/12345678.png",alt:"12345678"})],-1),C=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/23456.png",alt:"23456"})],-1),A=s("h1",{id:"_1-loki-promtail\u7B80\u4ECB",tabindex:"-1"},[n("1. Loki + Promtail\u7B80\u4ECB "),s("a",{class:"header-anchor",href:"#_1-loki-promtail\u7B80\u4ECB","aria-hidden":"true"},"#")],-1),D=s("p",null,"\u5B98\u7F51\u6709\u8BF4\u660E\u3002",-1),x=s("p",null,"\u7B80\u5355\u7406\u89E3\uFF0C",-1),f=s("p",null,"Loki\u662F\u4E2A\u65E5\u5FD7\u76D1\u63A7\u7CFB\u7EDF\uFF0C\u53EF\u7528\u6765\u5206\u6790\u65E5\u5FD7\uFF0C\u5E76\u63D0\u4F9B\u7ED9Grafana\u8FDB\u884C\u56FE\u5F62\u5316\u5C55\u793A\u3002",-1),b=s("p",null,"Promtail\u662F\u4E2A\u65E5\u5FD7\u8F6C\u53D1\u7684\u4EE3\u7406\uFF0C\u7528\u4E8E\u7ED9Loki\u63D0\u4F9B\u65E5\u5FD7\u6570\u636E\u7684\u3002",-1),k=s("h1",{id:"_2-loki-promtail\u4E0B\u8F7D\u5E76\u5B89\u88C5\u542F\u52A8",tabindex:"-1"},[n("2. Loki + Promtail\u4E0B\u8F7D\u5E76\u5B89\u88C5\u542F\u52A8 "),s("a",{class:"header-anchor",href:"#_2-loki-promtail\u4E0B\u8F7D\u5E76\u5B89\u88C5\u542F\u52A8","aria-hidden":"true"},"#")],-1),v=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"wget https://github.com/grafana/loki/blob/main/cmd/loki/loki-local-config.yaml -O loki-config.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker run --name loki -v "),s("span",{style:{color:"#89DDFF"}},"$("),s("span",{style:{color:"#C3E88D"}},"pwd"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},":/mnt/config -p 3100:3100 grafana/loki:2.1.0 -config.file=/mnt/config/loki-config.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"wget https://github.com/grafana/loki/blob/main/clients/cmd/promtail/promtail-docker-config.yaml -O promtail-config.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker run --name promtail -v "),s("span",{style:{color:"#89DDFF"}},"$("),s("span",{style:{color:"#C3E88D"}},"pwd"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},":/mnt/config -v /usr/local/nginx/logs:/usr/local/nginx/logs grafana/promtail:2.1.0 -config.file=/mnt/config/promtail-config.yaml")]),n(`
`),s("span",{class:"line"})])])],-1),F=s("blockquote",null,[s("p",null,"\u811A\u672C\u6765\u81EA\u5B98\u7F51\uFF0C\u5BB9\u5668\u542F\u52A8\u540E\u5148\u505C\u6B62\uFF0C\u7136\u540E\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6")],-1),w=s("h1",{id:"_3-\u4FEE\u6539nginx\u914D\u7F6E",tabindex:"-1"},[n("3. \u4FEE\u6539Nginx\u914D\u7F6E "),s("a",{class:"header-anchor",href:"#_3-\u4FEE\u6539nginx\u914D\u7F6E","aria-hidden":"true"},"#")],-1),$=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"log_format json_analytics '{'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                            '"msec": "$msec", ' # request unixtime in seconds with a milliseconds resolution`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                            '"connection": "$connection", ' # connection serial number`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                            '"connection_requests": "$connection_requests", ' # number of requests made in connection`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"pid": "$pid", ' # process pid`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request_id": "$request_id", ' # the unique request id`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request_length": "$request_length", ' # request length (including headers and body)`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"remote_addr": "$remote_addr", ' # client IP`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"remote_user": "$remote_user", ' # client HTTP username`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"remote_port": "$remote_port", ' # client port`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"time_local": "$time_local", '`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"time_iso8601": "$time_iso8601", ' # local time in the ISO 8601 standard format`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request": "$request", ' # full path no arguments if the request`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request_uri": "$request_uri", ' # full path and arguments if the request`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"args": "$args", ' # args`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"status": "$status", ' # response status code`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"body_bytes_sent": "$body_bytes_sent", ' # the number of body bytes exclude headers sent to a client`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"bytes_sent": "$bytes_sent", ' # the number of bytes sent to a client`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"http_referer": "$http_referer", ' # HTTP referer`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"http_user_agent": "$http_user_agent", ' # user agent`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"http_x_forwarded_for": "$http_x_forwarded_for", ' # http_x_forwarded_for`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"http_host": "$http_host", ' # the request Host: header`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"server_name": "$server_name", ' # the name of the vhost serving the request`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request_time": "$request_time", ' # request processing time in seconds with msec resolution`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream": "$upstream_addr", ' # upstream backend server for proxied requests`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream_connect_time": "$upstream_connect_time", ' # upstream handshake time incl. TLS`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream_header_time": "$upstream_header_time", ' # time spent receiving upstream headers`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream_response_time": "$upstream_response_time", ' # time spend receiving upstream body`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream_response_length": "$upstream_response_length", ' # upstream response length`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"upstream_cache_status": "$upstream_cache_status", ' # cache HIT/MISS where applicable`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"ssl_protocol": "$ssl_protocol", ' # TLS protocol`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"ssl_cipher": "$ssl_cipher", ' # TLS cipher`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"scheme": "$scheme", ' # http or https`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"request_method": "$request_method", ' # request method`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"server_protocol": "$server_protocol", ' # request protocol, like HTTP/1.1 or HTTP/2.0`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"pipe": "$pipe", ' # "p" if request was pipelined, "." otherwise`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"gzip_ratio": "$gzip_ratio", '`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`                    '"http_cf_ray": "$http_cf_ray"'`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                    '}';")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"access_log logs/json_access.log json_analytics;")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),P=s("blockquote",null,[s("p",null,"\u8FD9\u4E00\u6B65\u662F\u5C06Nginx\u8F93\u51FA\u7684\u65E5\u5FD7\u6587\u4EF6\u8FDB\u884C\u683C\u5F0F\u5316")],-1),q=s("h1",{id:"_4-\u4FEE\u6539promtail\u914D\u7F6E",tabindex:"-1"},[n("4. \u4FEE\u6539Promtail\u914D\u7F6E "),s("a",{class:"header-anchor",href:"#_4-\u4FEE\u6539promtail\u914D\u7F6E","aria-hidden":"true"},"#")],-1),G=s("div",{class:"language-yaml"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"server"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"http_listen_port"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"grpc_listen_port"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"positions"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"filename"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/tmp/positions.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"clients"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"url"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"http://172.17.0.4:3100/loki/api/v1/push"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#676E95"}},"# Loki\u65E5\u5FD7\u63A8\u9001\u5730\u5740")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"scrape_configs"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"job_name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"    "),s("span",{style:{color:"#676E95"}},"#pipeline_stages:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"    "),s("span",{style:{color:"#676E95"}},"#- replace:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"    "),s("span",{style:{color:"#676E95"}},"#    expression: '(?:[0-9]{1,3}\\.){3}([0-9]{1,3})'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"    "),s("span",{style:{color:"#676E95"}},"#    replace: '***'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"static_configs"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"targets"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"localhost"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95"}},"# \u6839\u636E\u5B98\u65B9\u6587\u6863\uFF0C\u8FD9\u91CC\u53EA\u80FD\u662Flocalhost")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#F07178"}},"labels"),s("span",{style:{color:"#89DDFF"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          "),s("span",{style:{color:"#F07178"}},"job"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"nginx_access_log")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          "),s("span",{style:{color:"#F07178"}},"agent"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"promtail")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          "),s("span",{style:{color:"#F07178"}},"__path__"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/usr/local/nginx/logs/json_access.log"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#676E95"}},"# \u9700\u8981\u4E0A\u4F20\u7684\u65E5\u5FD7\u5730\u5740\u3002")]),n(`
`),s("span",{class:"line"})])])],-1),N=s("h1",{id:"_5-\u91CD\u542Floki-promtail\u5BB9\u5668",tabindex:"-1"},[n("5. \u91CD\u542FLoki+Promtail\u5BB9\u5668 "),s("a",{class:"header-anchor",href:"#_5-\u91CD\u542Floki-promtail\u5BB9\u5668","aria-hidden":"true"},"#")],-1),I=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker restart loki ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker restart promtail")]),n(`
`),s("span",{class:"line"})])])],-1),L=s("h1",{id:"_6-\u914D\u7F6Egrafana\u6570\u636E\u6E90",tabindex:"-1"},[n("6. \u914D\u7F6EGrafana\u6570\u636E\u6E90 "),s("a",{class:"header-anchor",href:"#_6-\u914D\u7F6Egrafana\u6570\u636E\u6E90","aria-hidden":"true"},"#")],-1),E=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630142131.png",alt:"image-20210630142131562"})],-1),T=s("h1",{id:"_7-\u914D\u7F6Egrafana\u6A21\u7248",tabindex:"-1"},[n("7. \u914D\u7F6EGrafana\u6A21\u7248 "),s("a",{class:"header-anchor",href:"#_7-\u914D\u7F6Egrafana\u6A21\u7248","aria-hidden":"true"},"#")],-1),j=s("p",null,"\u6A21\u7248ID\uFF1A12559",-1),S=s("p",null,"\u975E\u5E38\u88C5\u903C\uFF0C\u975E\u5E38\u70ED\u95E8",-1),H=s("p",null,"\u5BFC\u5165\u65B9\u6CD5\u4E0E\u672C\u535A\u5BA2\u591A\u7BC7\u65E5\u5FD7\u6536\u96C6Grafana\u5BFC\u5165\u65B9\u6CD5\u76F8\u540C",-1),V=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630142256.png",alt:"image-20210630142256248"})],-1),O=s("h1",{id:"_8-\u67E5\u770B\u9762\u677F",tabindex:"-1"},[n("8. \u67E5\u770B\u9762\u677F "),s("a",{class:"header-anchor",href:"#_8-\u67E5\u770B\u9762\u677F","aria-hidden":"true"},"#")],-1),J=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630142558.png",alt:"image-20210630142558503"})],-1),U=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630142622.png",alt:"image-20210630142622826"})],-1),z=s("p",null,"\u63D2\u4EF6\u56E0\u7D20\u663E\u793A\u4E0D\u5168\u8BF7\u81EA\u884C\u5B89\u88C5\uFF0Cgrafana-cli plugins install *****",-1),B=s("h1",{id:"_9-\u53EF\u67E5\u770B\u6307\u6807",tabindex:"-1"},[n("9. \u53EF\u67E5\u770B\u6307\u6807 "),s("a",{class:"header-anchor",href:"#_9-\u53EF\u67E5\u770B\u6307\u6807","aria-hidden":"true"},"#")],-1),M=s("ul",null,[s("li",null,"\u603B\u8BF7\u6C42\u91CF"),s("li",null,"\u72B6\u6001\u7801 2xx,3xx,5xx\u8BF7\u6C42\u91CF"),s("li",null,"\u6D41\u91CF\u60C5\u51B5"),s("li",null,"\u8BF7\u6C42\u660E\u7EC6"),s("li",null,"\u767E\u5206\u4E4B95\u8BF7\u6C42\u54CD\u5E94\u65F6\u95F4"),s("li",null,"\u6700\u5927\u8BF7\u6C42IP"),s("li",null,"\u6700\u5927\u8BF7\u6C42\u8DEF\u5F84")],-1),Z=s("h1",{id:"_10-\u56FD\u5BB6\u9762\u677F",tabindex:"-1"},[n("10. \u56FD\u5BB6\u9762\u677F "),s("a",{class:"header-anchor",href:"#_10-\u56FD\u5BB6\u9762\u677F","aria-hidden":"true"},"#")],-1),K=s("p",null,"Country\u9762\u677F\u65E0\u6570\u636E\uFF0C\u662F\u56E0\u4E3AGrafana\u6CA1\u6709\u5730\u56FE\u9762\u677F\u63D2\u4EF6\uFF0C\u4E14Nginx\u9ED8\u8BA4\u6CA1\u6709\u5F00\u542F\u56FD\u5BB6\u57CE\u5E02\u8FC7\u6EE4\u3002",-1),R=s("p",null,[s("strong",null,"\u6587\u7AE0\u6700\u4E0B\u9762\u8FDB\u884C\u64CD\u4F5C")],-1),Q=s("h1",{id:"_11-\u8D44\u6E90\u6D88\u8017",tabindex:"-1"},[n("11. \u8D44\u6E90\u6D88\u8017 "),s("a",{class:"header-anchor",href:"#_11-\u8D44\u6E90\u6D88\u8017","aria-hidden":"true"},"#")],-1),W=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630143102.png",alt:"image-20210630143102322"})],-1),X=s("p",null,"\u5C31\u8FD9\u8D44\u6E90\u6D88\u8017\uFF0C\u8FD8\u8981\u5565\u81EA\u884C\u8F66\uFF1F\u8981\u5565ELK\uFF1F",-1),Y=s("hr",null,null,-1),ss=s("h2",{id:"ngin\u6DFB\u52A0geoip\u6A21\u5757",tabindex:"-1"},[n("Ngin\u6DFB\u52A0GeoIP\u6A21\u5757 "),s("a",{class:"header-anchor",href:"#ngin\u6DFB\u52A0geoip\u6A21\u5757","aria-hidden":"true"},"#")],-1),ns=s("h2",{id:"_1-1-\u505C\u6B62\u73B0\u6709nginx",tabindex:"-1"},[n("1.1 \u505C\u6B62\u73B0\u6709Nginx "),s("a",{class:"header-anchor",href:"#_1-1-\u505C\u6B62\u73B0\u6709nginx","aria-hidden":"true"},"#")],-1),ls=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"./nginx -s stop")]),n(`
`),s("span",{class:"line"})])])],-1),es=s("h2",{id:"_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx",tabindex:"-1"},[n("1.2 \u5E26GeoIP\u91CD\u65B0\u7F16\u8BD1Nginx "),s("a",{class:"header-anchor",href:"#_1-2-\u5E26geoip\u91CD\u65B0\u7F16\u8BD1nginx","aria-hidden":"true"},"#")],-1),as=s("h3",{id:"_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56",tabindex:"-1"},[n("1.2.1 \u4E0B\u8F7DGeoIP\u4F9D\u8D56 "),s("a",{class:"header-anchor",href:"#_1-2-1-\u4E0B\u8F7Dgeoip\u4F9D\u8D56","aria-hidden":"true"},"#")],-1),os=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sudo apt install libgeoip1 libgeoip-dev geoip-bin")]),n(`
`),s("span",{class:"line"})])])],-1),ts=s("p",null,"github\u6587\u6863\u5982\u4E0B",-1),is=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630143344.png",alt:"img"})],-1),rs=s("h3",{id:"_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56",tabindex:"-1"},[n("1.2.2 \u8FDB\u5165nginx/sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56 "),s("a",{class:"header-anchor",href:"#_1-2-2-\u8FDB\u5165nginx-sbin\u76EE\u5F55\u67E5\u770B\u73B0\u6709nginx\u6A21\u5757\u4F9D\u8D56","aria-hidden":"true"},"#")],-1),cs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"./nginx -V")]),n(`
`),s("span",{class:"line"})])])],-1),ps=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630143504.png",alt:"image-20210630143504540"})],-1),ds=s("p",null,"\u5982\u4E0A\u56FE\uFF0C\u5C06\u7EA2\u7EBF\u4F4D\u7F6E\u62F7\u8D1D\uFF0C\u7528\u4E8E\u6DFB\u52A0\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1",-1),gs=s("h3",{id:"_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1",tabindex:"-1"},[n("1.2.3 \u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1 "),s("a",{class:"header-anchor",href:"#_1-2-3-\u6DFB\u52A0geoip\u6A21\u5757\u91CD\u65B0\u7F16\u8BD1","aria-hidden":"true"},"#")],-1),_s=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"./configure --prefix=/usr/local/nginx --with-http_gzip_static_module \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," --with-http_stub_status_module --with-http_ssl_module --with-pcre --with-file-aio \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," --with-http_realip_module --with-http_geoip_module --add-module=/usr/local/nginx-module-vts-master")]),n(`
`),s("span",{class:"line"})])])],-1),hs=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"make "),s("span",{style:{color:"#89DDFF"}},"&&"),s("span",{style:{color:"#A6ACCD"}}," make install ")]),n(`
`),s("span",{class:"line"})])])],-1),us=s("h3",{id:"_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F",tabindex:"-1"},[n("1.2.4 \u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F "),s("a",{class:"header-anchor",href:"#_1-2-4-\u6267\u884C\u547D\u4EE4\uFF0C\u67E5\u770Bgeoip\u662F\u5426\u7F16\u8BD1\u6210\u529F","aria-hidden":"true"},"#")],-1),ms=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx -V")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ys=s("p",null,"\u5E26 --with-http_geoip_module \u5373\u7F16\u8BD1\u6210\u529F",-1),Cs=s("h2",{id:"_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E",tabindex:"-1"},[n("1.3. \u67E5\u770BGeoIP.dat\u4F4D\u7F6E "),s("a",{class:"header-anchor",href:"#_1-3-\u67E5\u770Bgeoip-dat\u4F4D\u7F6E","aria-hidden":"true"},"#")],-1),As=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@daicytest01:/usr/local/nginx/sbin# whereis GeoIP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"GeoIP: /usr/include/GeoIP.h /usr/share/GeoIP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@daicytest01:/usr/share/GeoIP# ls -al")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"total 10012")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"drwxr-xr-x   2 root root    4096 Feb 17 22:14 "),s("span",{style:{color:"#82AAFF"}},".")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"drwxr-xr-x 121 root root    4096 Feb 17 22:14 ..")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r--   1 root root 2099217 Jan 23  2020 GeoIP.dat")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r--   1 root root 8138841 Jan 23  2020 GeoIPv6.dat")]),n(`
`),s("span",{class:"line"})])])],-1),Ds=s("h2",{id:"_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6",tabindex:"-1"},[n("1.4. \u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6 "),s("a",{class:"header-anchor",href:"#_1-4-\u4FEE\u6539nginx\u914D\u7F6E\u6587\u4EF6","aria-hidden":"true"},"#")],-1),xs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95"}},"# \u6DFB\u52A0\u56FD\u5BB6\u6A21\u5757\u914D\u7F6E")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," geoip_country /usr/share/GeoIP/GeoIP.dat"),s("span",{style:{color:"#89DDFF"}},";")]),n(`
`),s("span",{class:"line"})])])],-1),fs=s("h2",{id:"_1-5-\u91CD\u542Fnginx",tabindex:"-1"},[n("1.5. \u91CD\u542Fnginx "),s("a",{class:"header-anchor",href:"#_1-5-\u91CD\u542Fnginx","aria-hidden":"true"},"#")],-1),bs=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx -s reload ")]),n(`
`),s("span",{class:"line"})])])],-1),ks=s("h2",{id:"_1-6-\u67E5\u770B\u5927\u56FE",tabindex:"-1"},[n("1.6. \u67E5\u770B\u5927\u56FE "),s("a",{class:"header-anchor",href:"#_1-6-\u67E5\u770B\u5927\u56FE","aria-hidden":"true"},"#")],-1),vs=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210630144706.png",alt:"img"})],-1),Fs=s("h2",{id:"_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D",tabindex:"-1"},[n("1.7. \u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D "),s("a",{class:"header-anchor",href:"#_1-7-\u76D1\u63A7\u65E5\u5FD7\u652F\u6301\u6B63\u5219\u5339\u914D","aria-hidden":"true"},"#")],-1),ws=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@daicytest01:/usr/local/nginx/logs# ls")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"access.log  error.log  json_access.log  json_access.log.2021-02-17  nginx.pid")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@daicytest01:/usr/local/loki+promtail# vim promtail-config.yaml  ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  static_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - targets:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          - localhost")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          job: nginx_access_log")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          agent: promtail")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          __path__: /usr/local/nginx/logs/"),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}},"json_access.log"),s("span",{style:{color:"#89DDFF"}},"*")]),n(`
`),s("span",{class:"line"})])])],-1);function $s(e,Ps,qs,Gs,t,Ns){const i=r;return d(),p(i,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":l(()=>[h,u,m,y,C,A,D,x,f,b,k,v,F,w,$,P,q,G,N,I,L,E,T,j,S,H,V,O,J,U,z,B,M,Z,K,R,Q,W,X,Y,ss,ns,ls,es,as,os,ts,is,rs,cs,ps,ds,gs,_s,hs,us,ms,ys,Cs,As,Ds,xs,fs,bs,ks,vs,Fs,ws]),"main-header":l(()=>[a(e.$slots,"main-header")]),"main-header-after":l(()=>[a(e.$slots,"main-header-after")]),"main-nav":l(()=>[a(e.$slots,"main-nav")]),"main-content":l(()=>[a(e.$slots,"main-content")]),"main-content-after":l(()=>[a(e.$slots,"main-content-after")]),"main-nav-before":l(()=>[a(e.$slots,"main-nav-before")]),"main-nav-after":l(()=>[a(e.$slots,"main-nav-after")]),comment:l(()=>[a(e.$slots,"comment")]),footer:l(()=>[a(e.$slots,"footer")]),aside:l(()=>[a(e.$slots,"aside")]),"aside-custom":l(()=>[a(e.$slots,"aside-custom")]),default:l(()=>[a(e.$slots,"default")]),_:3},8,["frontmatter","data"])}const Hs=c(_,[["render",$s]]);export{Ss as __pageData,Hs as default};
