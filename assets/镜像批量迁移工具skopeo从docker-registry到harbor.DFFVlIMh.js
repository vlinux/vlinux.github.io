import{_ as p}from"./ValaxyMain.vue_vue_type_style_index_0_lang.Bth_JSAQ.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as g,u as m,a as u}from"./chunks/vue-router.DpP0leKZ.js";import{aa as b,ap as a,ag as e,af as s,ai as t,P as F,ab as y,a1 as f}from"./framework.GHZxz7jq.js";import"./index.Di1n2b66.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.BWywLGB4.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.DoKt6roH.js";const C=g("/posts/镜像批量迁移工具skopeo从docker-registry到harbor",async l=>JSON.parse('{"title":"镜像批量迁移工具skopeo从docker-registry到harbor","description":"","frontmatter":{"title":"镜像批量迁移工具skopeo从docker-registry到harbor","categories":"Kubernetes","tags":["skopeo"],"date":"2022-09-20 15:23:00"},"headers":[],"relativePath":"pages/posts/镜像批量迁移工具skopeo从docker-registry到harbor.md","lastUpdated":null}'),{lazy:(l,o)=>l.name===o.name}),O={__name:"镜像批量迁移工具skopeo从docker-registry到harbor",setup(l,{expose:o}){const{data:r}=C(),k=u(),c=m(),n=Object.assign(c.meta.frontmatter||{},r.value?.frontmatter||{});return k.currentRoute.value.data=r.value,f("valaxy:frontmatter",n),globalThis.$frontmatter=n,o({frontmatter:{title:"镜像批量迁移工具skopeo从docker-registry到harbor",categories:"Kubernetes",tags:["skopeo"],date:"2022-09-20 15:23:00"}}),(i,h)=>{const d=p;return y(),b(d,{frontmatter:F(n)},{"main-content-md":a(()=>[...h[0]||(h[0]=[s("h2",{id:"背景",tabindex:"-1"},[t("背景 "),s("a",{class:"header-anchor",href:"#背景","aria-label":'Permalink to "背景"'},"​")],-1),s("blockquote",null,[s("p",null,"docker-registry地址：docker-registry.kococ.cn"),s("p",null,"新镜像仓库harbor地址：harbor.kococ.cn"),s("p",null,"本例将docker-registry镜像迁移至 harbor")],-1),s("h3",{id:"安装",tabindex:"-1"},[t("安装 "),s("a",{class:"header-anchor",href:"#安装","aria-label":'Permalink to "安装"'},"​")],-1),s("blockquote",null,[s("p",null,"可以从github项目直接下载使用二进制命令"),s("p",null,"也可以在centos服务器上直接yum安装,需要epel源")],-1),s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," skopeo")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"获取test该namespace下所有服务镜像",tabindex:"-1"},[t("获取test该namespace下所有服务镜像 "),s("a",{class:"header-anchor",href:"#获取test该namespace下所有服务镜像","aria-label":'Permalink to "获取test该namespace下所有服务镜像"'},"​")],-1),s("blockquote",null,[s("p",null,"这里我的原镜像为docker-registry")],-1),s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," get"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," deployment,statefulset,daemonset"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," custom-columns='NAME:metadata.name,IMAGES:spec.template.spec.containers[*].image'"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -n"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," test"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," all-image")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"## 获取到所有image之后将域名去掉只保留除域名外")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"登录两个镜像仓库",tabindex:"-1"},[t("登录两个镜像仓库 "),s("a",{class:"header-anchor",href:"#登录两个镜像仓库","aria-label":'Permalink to "登录两个镜像仓库"'},"​")],-1),s("div",{class:"language-"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"docker login harbor.kcooc.cn")]),t(`
`),s("span",{class:"line"},[s("span",null,"docker login docker-registry.kococ.cn")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"迁移",tabindex:"-1"},[t("迁移 "),s("a",{class:"header-anchor",href:"#迁移","aria-label":'Permalink to "迁移"'},"​")],-1),s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cat"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," mv-image.sh")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#!/bin/bash")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," `"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cat"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," all-image`"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"skopeo"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," copy"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," docker://docker-registry.kococ.cn/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${i} "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"docker://harbor.kococ.cn/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${i} "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--authfile"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /root/.docker/config.json")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),s("button",{class:"code-block-unfold-btn"})],-1)])]),"main-header":a(()=>[e(i.$slots,"main-header")]),"main-header-after":a(()=>[e(i.$slots,"main-header-after")]),"main-nav":a(()=>[e(i.$slots,"main-nav")]),"main-content-before":a(()=>[e(i.$slots,"main-content-before")]),"main-content":a(()=>[e(i.$slots,"main-content")]),"main-content-after":a(()=>[e(i.$slots,"main-content-after")]),"main-nav-before":a(()=>[e(i.$slots,"main-nav-before")]),"main-nav-after":a(()=>[e(i.$slots,"main-nav-after")]),comment:a(()=>[e(i.$slots,"comment")]),footer:a(()=>[e(i.$slots,"footer")]),aside:a(()=>[e(i.$slots,"aside")]),"aside-custom":a(()=>[e(i.$slots,"aside-custom")]),default:a(()=>[e(i.$slots,"default")]),_:3},8,["frontmatter"])}}};export{O as default,C as usePageData};
