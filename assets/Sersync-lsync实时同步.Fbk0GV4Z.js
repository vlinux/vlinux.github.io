import{_ as F}from"./ValaxyMain.vue_vue_type_style_index_0_lang.Ds7uYSjE.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as y,u as g,a as c}from"./chunks/vue-router.DZN_KE5F.js";import{aa as o,ap as a,ag as l,af as i,ai as s,P as C,ab as B,a1 as b}from"./framework.GHZxz7jq.js";import"./index.D-1obavn.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.DXi5Caec.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.BDmJT3LT.js";const u=y("/posts/Sersync-lsync实时同步",async k=>JSON.parse('{"title":"Sersync/lsync实时同步","description":"","frontmatter":{"title":"Sersync/lsync实时同步","categories":"Linux技术","tags":["Sersync","Lsync","实时同步"],"date":"2020-03-12 16:10:00"},"headers":[],"relativePath":"pages/posts/Sersync-lsync实时同步.md","lastUpdated":null}'),{lazy:(k,t)=>k.name===t.name}),M={__name:"Sersync-lsync实时同步",setup(k,{expose:t}){const{data:e}=u(),p=c(),d=g(),n=Object.assign(d.meta.frontmatter||{},e.value?.frontmatter||{});return p.currentRoute.value.data=e.value,b("valaxy:frontmatter",n),globalThis.$frontmatter=n,t({frontmatter:{title:"Sersync/lsync实时同步",categories:"Linux技术",tags:["Sersync","Lsync","实时同步"],date:"2020-03-12 16:10:00"}}),(h,r)=>{const E=F;return B(),o(E,{frontmatter:C(n)},{"main-content-md":a(()=>[...r[0]||(r[0]=[i("h1",{id:"第一章-为什么需要实时同步",tabindex:"-1"},[s("第一章 为什么需要实时同步 "),i("a",{class:"header-anchor",href:"#第一章-为什么需要实时同步","aria-label":'Permalink to "第一章 为什么需要实时同步"'},"​")],-1),i("h2",{id:"_1-第二阶段实时同步解决了什么问题",tabindex:"-1"},[s("1.第二阶段实时同步解决了什么问题: "),i("a",{class:"header-anchor",href:"#_1-第二阶段实时同步解决了什么问题","aria-label":'Permalink to "1.第二阶段实时同步解决了什么问题:"'},"​")],-1),i("p",null,"解决 NFS单点故障问题 备份NFS数据并且提供冗余的服务功能",-1),i("h2",{id:"_2-实时同步难点",tabindex:"-1"},[s("2.实时同步难点 "),i("a",{class:"header-anchor",href:"#_2-实时同步难点","aria-label":'Permalink to "2.实时同步难点"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"什么条件才同步")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"多久同步一次")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"用什么备份方式同步")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"用什么工具同步")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第二章-inotify简介",tabindex:"-1"},[s("第二章 inotify简介 "),i("a",{class:"header-anchor",href:"#第二章-inotify简介","aria-label":'Permalink to "第二章 inotify简介"'},"​")],-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Inotify是一种强大的,细粒度的,异步的文件系统事件监视机制")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Linux2"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".6.13起加入了inotify支持"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",通过inotify可以监控文件系统中添加,删除,修改,移动等各种事件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"利用这个内核接口,第三方软件就可以监控文件系统下文件的各种变化情况")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"而inotify-tools正是实施这样监控的软件")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"关系图",-1),i("figure",null,[i("img",{src:"http:////upload-images.jianshu.io/upload_images/14248468-e23cc9187ab60ed7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/448/format/webp",alt:"img",loading:"lazy",decoding:"async"})],-1),i("h1",{id:"第三章-inotify实时同步",tabindex:"-1"},[s("第三章 Inotify实时同步 "),i("a",{class:"header-anchor",href:"#第三章-inotify实时同步","aria-label":'Permalink to "第三章 Inotify实时同步"'},"​")],-1),i("h2",{id:"_1-查看当前系统是否支持inotify",tabindex:"-1"},[s("1.查看当前系统是否支持inotify "),i("a",{class:"header-anchor",href:"#_1-查看当前系统是否支持inotify","aria-label":'Permalink to "1.查看当前系统是否支持inotify"'},"​")],-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@nfs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# uname "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"3.10.0"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"862"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".el7.x86_64")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@nfs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# ls "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"l "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"proc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sys"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fs"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotify"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"total "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," root root "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Oct "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"47"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," max_queued_events")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," root root "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Oct "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"47"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," max_user_instances")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rw"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," root root "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Oct "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"47"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," max_user_watches")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ====="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =====")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"max_queued_events   "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"===="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"设置inotify实例事件"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(event)队列可容纳的事件数量")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"max_user_instances  "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"===="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"设置每个用户可以运行的inotify或者inotifywatch命令的进程数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"max_user_watches    "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"===="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"设置inotifywait或者inotifywatch命令可以监视的文件数量"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(单进程)")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-安装inotify-tools",tabindex:"-1"},[s("2.安装inotify-tools "),i("a",{class:"header-anchor",href:"#_2-安装inotify-tools","aria-label":'Permalink to "2.安装inotify-tools"'},"​")],-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@nfs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# yum install inotify"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"tools "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"y")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-inotifywait详细参数解释",tabindex:"-1"},[s("3.inotifywait详细参数解释 "),i("a",{class:"header-anchor",href:"#_3-inotifywait详细参数解释","aria-label":'Permalink to "3.inotifywait详细参数解释"'},"​")],-1),i("div",{class:"language-go"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"go"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotifywait参数说明")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参数名称            参数说明")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"m ,"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"monitor       始终保持事件监听状态")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"r,"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"recursive      递归查询目录")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"q,"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"quiet          只打印监控事件的信息")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"exclude           排除文件或目录时,不区分大小写")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"t,"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"timeout        超时时间")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"timefmt          指定时间输出格式")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"format           指定输出格式")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"e,event           后面指定增,删,改等事件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotifywait events 事件说明")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"access             读取文件或目录内容")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"modify             修改文件或目录内容")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"attrib             文件或目录的属性改变")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"close_write        修改真实文件内容")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"close_nowrite   ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"close   ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"open               文件或目录被打开")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"moved_to           文件或目录移动到")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"moved_from         文件或目录从"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"..."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"移动到")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"move               移动文件或目录移动到监视目录")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"create             在监视目录下创建文件或目录")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"delete             删除监视目录下的文件或目录")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"delete_self ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"umount             卸载文件系统")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_4-查看inotify默认参数",tabindex:"-1"},[s("4.查看inotify默认参数 "),i("a",{class:"header-anchor",href:"#_4-查看inotify默认参数","aria-label":'Permalink to "4.查看inotify默认参数"'},"​")],-1),i("div",{class:"language-ruby"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"ruby"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# sysctl -a |egrep max_queued_events")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fs."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotify"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"max_queued_events"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 16384")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#  sysctl -a |egrep max_user_watches")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fs."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"epoll"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"max_user_watches"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 201256")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fs."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotify"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"max_user_watches"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8192")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# sysctl -a |egrep max_user_instances")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"fs."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotify"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"max_user_instances"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 128")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_5-针对上述命令进行测试",tabindex:"-1"},[s("5.针对上述命令进行测试 "),i("a",{class:"header-anchor",href:"#_5-针对上述命令进行测试","aria-label":'Permalink to "5.针对上述命令进行测试"'},"​")],-1),i("p",null,"参数解释:",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"%T"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"   #调用并显示定义好的时间格式")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"%w"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"   #显示发生变化的文件的绝对路径")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"%f"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"   #显示监控到的文件名称,去掉后只显示目录路径")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," delete,create"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"   #指定监控文件变化的类型")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"1.开启两个窗口:测试create和delete",-1),i("div",{class:"language-go"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"go"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotifywait "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"mrq "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"timefmt "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"%d/%m/%y %H:%M"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," --"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"format "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"%T %w%f"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"e delete,create "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"backup")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"2.测试close_write",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotifywait"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -mrq"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --timefmt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '%d/%m/%y %H:%M'"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --format"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '%w%f'"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," close_write"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /backup")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"3.打印出事件类型",-1),i("div",{class:"language-go"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"go"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotifywait "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"mrq "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"format "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"%w%f %e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"e delete,create "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"backup")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_6-把客户端监控到情况出发rsync推送变化的文件",tabindex:"-1"},[s("6.把客户端监控到情况出发rsync推送变化的文件 "),i("a",{class:"header-anchor",href:"#_6-把客户端监控到情况出发rsync推送变化的文件","aria-label":'Permalink to "6.把客户端监控到情况出发rsync推送变化的文件"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"#!/bin/bash ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Path"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"backup_Server"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"172.16.1.41")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"export"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," RSYNC_PASSWORD"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"123456")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"/usr/bin/inotifywait"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -mrq"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --format"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '%w%f'"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -e"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," create,close_write,delete"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," while"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," read"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," line")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    echo"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ${line}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," [ "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-f"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ${line} ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    then")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"       rsync"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -az"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ${line} "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"rsync_backup@"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${backup_Server}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"::data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"       rsync"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -az"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --delete"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data/"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," rsync_backup@"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"${backup_Server}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"::data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    fi")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_7-inotify优缺点",tabindex:"-1"},[s("7.inotify优缺点 "),i("a",{class:"header-anchor",href:"#_7-inotify优缺点","aria-label":'Permalink to "7.inotify优缺点"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotify优点")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")监控文件系统事件变化")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"inotify缺点")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")并发如果大于200个文("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"10-100k"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"),同步就会由延迟")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")我们前面的脚本,每次都是全部推送一次,但是确实是增量的,也可以只同步变化的文件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")监控到事件后,调用rsync同步是单进程("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"加"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"并发"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"4"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")我们自己写的脚本健壮性不高")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第四章-sersync简介",tabindex:"-1"},[s("第四章 sersync简介 "),i("a",{class:"header-anchor",href:"#第四章-sersync简介","aria-label":'Permalink to "第四章 sersync简介"'},"​")],-1),i("h2",{id:"_1-sersync介绍",tabindex:"-1"},[s("1.sersync介绍 "),i("a",{class:"header-anchor",href:"#_1-sersync介绍","aria-label":'Permalink to "1.sersync介绍"'},"​")],-1),i("p",null,"以下内容摘抄sersync作者官网的说明",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sersync主要用于服务器同步,web镜像等功能.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"基于boost1"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".41.0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",inotify api,rsync command开发.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"目前使用的比较多的同步解决方案是inotify-tools"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rsync")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-sersync优点",tabindex:"-1"},[s("2.sersync优点 "),i("a",{class:"header-anchor",href:"#_2-sersync优点","aria-label":'Permalink to "2.sersync优点"'},"​")],-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"1"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".sersync是使用c"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"编写,而且对linux系统文件系统产生的临时文件和重复的文件操作进行过滤(详细见附录,这个过滤脚本程序没有实现),所以结合rsync同步的时候,节省了运行时耗和网络资源,因此更快")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"2"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".相比较上面两个项目"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",sersync配置起来很简单,其中bin目录下已经有基本上静态编译的2进制文件,配合bin目录下的xml配置文件直接使用即可.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"3"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".另外本项目相比较其他脚本开源项目"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",使用多线程进行同步,尤其在同步较大文件时,能够保证多个服务器保持同步状态")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"4"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".本项目有出错处理机制"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",通过失败队列对出错的文件重新同步,如果仍旧失败,则每10个小时对同步失败的文件重新同步")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"5"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".本项目自带crontab功能"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",只需在xml配置文件中开启,即可按照您的要求,隔一段时间整体同步一次,无须在额外配置crontab功能")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"6"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".本项目socket与http插件拓展"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",满足您二次开发的需要.")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第五章-sersync安装部署",tabindex:"-1"},[s("第五章 sersync安装部署 "),i("a",{class:"header-anchor",href:"#第五章-sersync安装部署","aria-label":'Permalink to "第五章 sersync安装部署"'},"​")],-1),i("h2",{id:"_1-主机规划",tabindex:"-1"},[s("1.主机规划 "),i("a",{class:"header-anchor",href:"#_1-主机规划","aria-label":'Permalink to "1.主机规划"'},"​")],-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"nfs-server"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 172"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".16.1.31"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rsync"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"inotify"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sersync  "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"nfs-client")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"backup     172"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".16.1.41"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}}," rsync-server"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"           nfs-server")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-安装sersync",tabindex:"-1"},[s("2.安装sersync "),i("a",{class:"header-anchor",href:"#_2-安装sersync","aria-label":'Permalink to "2.安装sersync"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wget"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://down.whsir.com/downloads/sersync2.5.4_64bit_binary_stable_final.tar.gz")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"tar"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," zxf"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sersync2.5.4_64bit_binary_stable_final.tar.gz")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mv"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," GNU-Linux-x86"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sersync")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," sersync")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," confxml.xml"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," confxml.xml.bak")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-配置解释",tabindex:"-1"},[s("3.配置解释 "),i("a",{class:"header-anchor",href:"#_3-配置解释","aria-label":'Permalink to "3.配置解释"'},"​")],-1),i("div",{class:"language-xml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"#需要监控的目录      <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"localpath"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," watch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/data"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">   ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"#远程rsync服务器的IP地址和模块名称   <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"remote"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ip"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"172.16.1.41"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"data"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/>  ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"#rsync传输的参数    <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"commonParams"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," params"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"-az"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/> ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"#rsync密码文件路径  <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"auth"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," start"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"true"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," users"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"rsync_backup"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," passwordfile"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/etc/rsync.passwd"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/>    #")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_4-配置文件修改",tabindex:"-1"},[s("4.配置文件修改 "),i("a",{class:"header-anchor",href:"#_4-配置文件修改","aria-label":'Permalink to "4.配置文件修改"'},"​")],-1),i("div",{class:"language-xml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"xml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 23     <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"sersync"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 24         <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"localpath"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," watch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/data"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 25             <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"remote"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ip"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"172.16.1.41"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"data"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 26             "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'<!--<remote ip="192.168.8.39" name="tongbu"/>-->')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 27             "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},'<!--<remote ip="192.168.8.40" name="tongbu"/>-->')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 28         </"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"localpath"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 29         <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"rsync"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 30             <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"commonParams"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," params"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"-az"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 31             <"),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"auth"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," start"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"true"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," users"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"rsync_backup"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," passwordfile"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"/etc/rsync.passwd"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"/>")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_5-查看帮助说明",tabindex:"-1"},[s("5.查看帮助说明 "),i("a",{class:"header-anchor",href:"#_5-查看帮助说明","aria-label":'Permalink to "5.查看帮助说明"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs /opt/sersync]# ./sersync2 -h")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," system"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," param")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute：echo"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 50000000"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /proc/sys/fs/inotify/max_user_watches")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"execute：echo"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 327679"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /proc/sys/fs/inotify/max_queued_events")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"parse"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," the"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," command"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," param")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"_______________________________________________________")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-d:启用守护进程模式")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-r:在监控前，将监控目录与远程主机用rsync命令推送一遍")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"c参数-n:"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 指定开启守护线程的数量，默认为10个")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-o:指定配置文件，默认使用confxml.xml文件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-m:单独启用其他模块，使用"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," refreshCDN"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 开启刷新CDN模块")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-m:单独启用其他模块，使用"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," socket"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 开启socket模块")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"参数-m:单独启用其他模块，使用"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 开启http模块")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"不加-m参数，则默认执行同步程序")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"________________________________________________________________")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs /opt/sersync]#")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_6-启动服务",tabindex:"-1"},[s("6.启动服务 "),i("a",{class:"header-anchor",href:"#_6-启动服务","aria-label":'Permalink to "6.启动服务"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./sersync2"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -rdo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," confxml.xml")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_7-测试数据是否同步",tabindex:"-1"},[s("7.测试数据是否同步 "),i("a",{class:"header-anchor",href:"#_7-测试数据是否同步","aria-label":'Permalink to "7.测试数据是否同步"'},"​")],-1),i("p",null,"backup服务器操作：",-1),i("p",null,"1秒查看一下/data目录下文件的个数",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"while"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ;"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ls "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wc"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sleep"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"nfs服务端操作：",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"1..1000}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," echo "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "${'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'}"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ${i}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".txt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sleep"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第六章-lsyncd同步",tabindex:"-1"},[s("第六章 lsyncd同步 "),i("a",{class:"header-anchor",href:"#第六章-lsyncd同步","aria-label":'Permalink to "第六章 lsyncd同步"'},"​")],-1),i("h2",{id:"_1-官方地址",tabindex:"-1"},[s("1.官方地址 "),i("a",{class:"header-anchor",href:"#_1-官方地址","aria-label":'Permalink to "1.官方地址"'},"​")],-1),i("div",{class:"language-cpp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cpp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"https:"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"//github.com/axkibe/lsyncd](https://github.com/axkibe/lsyncd")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-lsyncd介绍",tabindex:"-1"},[s("2.lsyncd介绍 "),i("a",{class:"header-anchor",href:"#_2-lsyncd介绍","aria-label":'Permalink to "2.lsyncd介绍"'},"​")],-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Lysncd 实际上是lua语言封装了 inotify 和 rsync 工具，采用了 Linux 内核（2"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".6.13"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 及以后）里的 inotify 触发机制，然后通过rsync去差异同步，达到实时的效果。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"它最令人称道的特性是，完美解决了 `inotify "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rsync`海量文件同步带来的文件频繁发送文件列表的问题 —— 通过时间延迟或累计触发事件次数实现。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"另外，它的配置方式很简单，lua本身就是一种配置语言，可读性非常强。lsyncd也有多种工作模式可以选择，本地目录cp，本地目录rsync，远程目录rsyncssh。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"实现简单高效的本地目录同步备份（网络存储挂载也当作本地目录），一个命令搞定。")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-lsyncd安装",tabindex:"-1"},[s("3.lsyncd安装 "),i("a",{class:"header-anchor",href:"#_3-lsyncd安装","aria-label":'Permalink to "3.lsyncd安装"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"yum"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," install"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," lsyncd"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -y")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_4-创建配置文件",tabindex:"-1"},[s("4.创建配置文件 "),i("a",{class:"header-anchor",href:"#_4-创建配置文件","aria-label":'Permalink to "4.创建配置文件"'},"​")],-1),i("p",null,"只监控1个目录",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# cat /etc/lsyncd.conf")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"settings"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  logfile"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/var/log/lsyncd/lsyncd.log",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  statusFile"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/var/log/lsyncd/lsyncd.status",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  inotifyMode"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "CloseWrite",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  maxProcesses"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 8,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  default.rsync,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/data",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "rsync_backup@172.16.1.41::data",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delete"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  exclude"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ".*"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," },")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delay"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 1,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  rsync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    binary"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/usr/bin/rsync",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    archive"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    compress"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    verbose"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    password_file"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/etc/rsync.passwd",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    _extra"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' {"--bwlimit=200"}')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"监控2个目录",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@nfs "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# cat /etc/lsyncd.conf")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"settings"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  logfile"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/var/log/lsyncd/lsyncd.log",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  statusFile"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/var/log/lsyncd/lsyncd.status",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  inotifyMode"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "CloseWrite",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  maxProcesses"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 8,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  default.rsync,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/data",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "rsync_backup@172.16.1.41::data",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delete"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  exclude"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ".*"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," },")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delay"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 1,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  rsync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    binary"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/usr/bin/rsync",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    archive"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    compress"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    verbose"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    password_file"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/etc/rsync.passwd",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    _extra"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' {"--bwlimit=200"}')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  default.rsync,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/backup",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "rsync_backup@172.16.1.41::backup",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delete"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  exclude"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' ".*"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," },")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  delay"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 1,")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"  rsync"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    binary"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/usr/bin/rsync",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    archive"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    compress"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    verbose"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    password_file"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "/etc/rsync.passwd",')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    _extra"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ="),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' {"--bwlimit=200"}')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_5-配置文件解释",tabindex:"-1"},[s("5.配置文件解释 "),i("a",{class:"header-anchor",href:"#_5-配置文件解释","aria-label":'Permalink to "5.配置文件解释"'},"​")],-1),i("p",null,"参考网友博客",-1),i("div",{class:"language-ruby"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"ruby"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"https:"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"//"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"www."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"cnblogs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"com"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"zxci"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"p"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"6243574"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"html")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_6-启动命令",tabindex:"-1"},[s("6.启动命令 "),i("a",{class:"header-anchor",href:"#_6-启动命令","aria-label":'Permalink to "6.启动命令"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," start"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," lsyncd")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_7-检查测试",tabindex:"-1"},[s("7.检查测试 "),i("a",{class:"header-anchor",href:"#_7-检查测试","aria-label":'Permalink to "7.检查测试"'},"​")],-1),i("p",null,"backup测试",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"while"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ;"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ls "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wc"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -l"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sleep"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"NFS测试",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"cd"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /data")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"1..1000}"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"do"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," echo "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"${'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "${'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'}"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ${i}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".txt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sleep"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"done")])])]),i("button",{class:"code-block-unfold-btn"})],-1)])]),"main-header":a(()=>[l(h.$slots,"main-header")]),"main-header-after":a(()=>[l(h.$slots,"main-header-after")]),"main-nav":a(()=>[l(h.$slots,"main-nav")]),"main-content-before":a(()=>[l(h.$slots,"main-content-before")]),"main-content":a(()=>[l(h.$slots,"main-content")]),"main-content-after":a(()=>[l(h.$slots,"main-content-after")]),"main-nav-before":a(()=>[l(h.$slots,"main-nav-before")]),"main-nav-after":a(()=>[l(h.$slots,"main-nav-after")]),comment:a(()=>[l(h.$slots,"comment")]),footer:a(()=>[l(h.$slots,"footer")]),aside:a(()=>[l(h.$slots,"aside")]),"aside-custom":a(()=>[l(h.$slots,"aside-custom")]),default:a(()=>[l(h.$slots,"default")]),_:3},8,["frontmatter"])}}};export{M as default,u as usePageData};
