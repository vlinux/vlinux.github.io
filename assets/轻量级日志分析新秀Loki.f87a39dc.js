import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang.6c21d395.js";import{_ as r,c as p,w as l,o as d,r as e,g as s,R as a,p as h}from"./app.c8bb4d5f.js";import"./YunFooter.vue_vue_type_script_setup_true_lang.0be08ea8.js";import"./YunCard.vue_vue_type_style_index_0_lang.39e7a8b1.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.bb2ef676.js";const us=JSON.parse('{"title":"\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki","description":"","frontmatter":{"title":"\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki","categories":"ELK-stack","tags":["Loki"],"date":"2021-04-07T14:08:55.000Z"},"headers":[{"level":3,"title":"\u7B80\u4ECB\uFF1A","slug":"\u7B80\u4ECB\uFF1A","link":"#\u7B80\u4ECB\uFF1A","children":[]},{"level":3,"title":"\u7279\u70B9\uFF1A","slug":"\u7279\u70B9\uFF1A","link":"#\u7279\u70B9\uFF1A","children":[]},{"level":3,"title":"\u7F3A\u70B9\uFF1A","slug":"\u7F3A\u70B9\uFF1A","link":"#\u7F3A\u70B9\uFF1A","children":[]},{"level":3,"title":"\u7EC4\u6210","slug":"\u7EC4\u6210","link":"#\u7EC4\u6210","children":[]}],"relativePath":"pages/posts/\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki.md","lastUpdated":0}'),o=JSON.parse('{"title":"\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki","description":"","frontmatter":{"title":"\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki","categories":"ELK-stack","tags":["Loki"],"date":"2021-04-07T14:08:55.000Z"},"headers":[{"level":3,"title":"\u7B80\u4ECB\uFF1A","slug":"\u7B80\u4ECB\uFF1A","link":"#\u7B80\u4ECB\uFF1A","children":[]},{"level":3,"title":"\u7279\u70B9\uFF1A","slug":"\u7279\u70B9\uFF1A","link":"#\u7279\u70B9\uFF1A","children":[]},{"level":3,"title":"\u7F3A\u70B9\uFF1A","slug":"\u7F3A\u70B9\uFF1A","link":"#\u7F3A\u70B9\uFF1A","children":[]},{"level":3,"title":"\u7EC4\u6210","slug":"\u7EC4\u6210","link":"#\u7EC4\u6210","children":[]}],"relativePath":"pages/posts/\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki.md","lastUpdated":0}'),m={name:"pages/posts/\u8F7B\u91CF\u7EA7\u65E5\u5FD7\u5206\u6790\u65B0\u79C0Loki.md",data(){return{data:o,frontmatter:o.frontmatter}},setup(){h("pageData",o)}},C=s("h3",{id:"\u7B80\u4ECB\uFF1A",tabindex:"-1"},[a("\u7B80\u4ECB\uFF1A "),s("a",{class:"header-anchor",href:"#\u7B80\u4ECB\uFF1A","aria-hidden":"true"},"#")],-1),A=s("p",null,"Loki\u7684\u7B2C\u4E00\u4E2A\u7A33\u5B9A\u7248\u672C\u4E8E2019\u5E7411\u670819\u65E5\u53D1\u5E03\uFF0C\u662F Grafana Labs \u56E2\u961F\u6700\u65B0\u7684\u5F00\u6E90\u9879\u76EE\uFF0C\u662F\u4E00\u4E2A\u6C34\u5E73\u53EF\u6269\u5C55\uFF0C\u9AD8\u53EF\u7528\u6027\uFF0C\u591A\u79DF\u6237\u7684\u65E5\u5FD7\u805A\u5408\u7CFB\u7EDF\u3002Loki \u662F\u4E13\u95E8\u7528\u4E8E\u805A\u96C6\u65E5\u5FD7\u6570\u636E\uFF0C\u91CD\u70B9\u662F\u9AD8\u53EF\u7528\u6027\u548C\u53EF\u4F38\u7F29\u6027\u3002\u4E0E\u7ADE\u4E89\u5BF9\u624B\u4E0D\u540C\u7684\u662F\uFF0C\u5B83\u786E\u5B9E\u6613\u4E8E\u5B89\u88C5\u4E14\u8D44\u6E90\u6548\u7387\u6781\u9AD8\u3002",-1),_=s("h3",{id:"\u7279\u70B9\uFF1A",tabindex:"-1"},[a("\u7279\u70B9\uFF1A "),s("a",{class:"header-anchor",href:"#\u7279\u70B9\uFF1A","aria-hidden":"true"},"#")],-1),g=s("p",null,"\u4F18\u70B9\uFF1A",-1),u=s("p",null,"1\u3001Loki\u7684\u67B6\u6784\u975E\u5E38\u7B80\u5355\uFF0C\u4F7F\u7528\u4E86\u548Cprometheus\u4E00\u6837\u7684\u6807\u7B7E\u6765\u4F5C\u4E3A\u7D22\u5F15\uFF0C\u901A\u8FC7\u8FD9\u4E9B\u6807\u7B7E\u65E2\u53EF\u4EE5\u67E5\u8BE2\u65E5\u5FD7\u7684\u5185\u5BB9\u4E5F\u53EF\u4EE5\u67E5\u8BE2\u5230\u76D1\u63A7\u7684\u6570\u636E\uFF0C\u4E0D\u4F46\u51CF\u5C11\u4E86\u4E24\u79CD\u67E5\u8BE2\u4E4B\u95F4\u7684\u5207\u6362\u6210\u672C\uFF0C\u4E5F\u6781\u5927\u5730\u964D\u4F4E\u4E86\u65E5\u5FD7\u7D22\u5F15\u7684\u5B58\u50A8\u3002",-1),y=s("p",null,"2\u3001\u4E0EELK\u76F8\u6BD4\uFF0C\u6D88\u8017\u7684\u6210\u672C\u66F4\u4F4E\uFF0C\u5177\u6709\u6210\u672C\u6548\u76CA\u3002",-1),D=s("p",null,"3\u3001\u5728\u65E5\u5FD7\u7684\u6536\u96C6\u4EE5\u53CA\u53EF\u89C6\u5316\u4E0A\u53EF\u4EE5\u8FDE\u7528grafana\uFF0C\u5B9E\u73B0\u5728\u65E5\u5FD7\u4E0A\u7684\u7B5B\u9009\u4EE5\u53CA\u67E5\u770B\u4E0A\u4E0B\u884C\u7684\u529F\u80FD\u3002",-1),k=s("h3",{id:"\u7F3A\u70B9\uFF1A",tabindex:"-1"},[a("\u7F3A\u70B9\uFF1A "),s("a",{class:"header-anchor",href:"#\u7F3A\u70B9\uFF1A","aria-hidden":"true"},"#")],-1),f=s("p",null,"1\u3001\u6280\u672F\u6BD4\u8F83\u65B0\u9896\uFF0C\u76F8\u5BF9\u5E94\u7684\u8BBA\u575B\u4E0D\u662F\u975E\u5E38\u6D3B\u8DC3\u3002",-1),v=s("p",null,"2\u3001\u529F\u80FD\u5355\u4E00\uFF0C\u53EA\u9488\u5BF9\u65E5\u5FD7\u7684\u67E5\u770B\uFF0C\u7B5B\u9009\u6709\u597D\u7684\u8868\u73B0\uFF0C\u5BF9\u4E8E\u6570\u636E\u7684\u5904\u7406\u4EE5\u53CA\u6E05\u6D17\u6CA1\u6709ELK\u5F3A\u5927\uFF0C\u540C\u65F6\u4E0EELK\u76F8\u6BD4\uFF0C\u5BF9\u4E8E\u540E\u671F\uFF0CELK\u53EF\u4EE5\u8FDE\u7528\u5404\u79CD\u6280\u672F\u8FDB\u884C\u65E5\u5FD7\u7684\u5927\u6570\u636E\u5904\u7406\uFF0C\u4F46\u662Floki\u4E0D\u884C\u3002",-1),b=s("h3",{id:"\u7EC4\u6210",tabindex:"-1"},[a("\u7EC4\u6210 "),s("a",{class:"header-anchor",href:"#\u7EC4\u6210","aria-hidden":"true"},"#")],-1),x=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1.loki\u662F\u4E3B\u670D\u52A1\u5668\uFF0C\u8D1F\u8D23\u5B58\u50A8\u65E5\u5FD7\u548C\u5904\u7406\u67E5\u8BE2\u3002")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"2.promtail\u662F\u4EE3\u7406\uFF0C\u8D1F\u8D23\u6536\u96C6\u65E5\u5FD7\u5E76\u5C06\u5176\u53D1\u9001\u7ED9 loki \u3002")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3.Grafana\u7528\u4E8E UI \u5C55\u793A\u3002")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),w=s("p",null,"\u672C\u6B21\u5B89\u88C5\u4F7F\u7528docker\u90E8\u7F72",-1),L=s("h4",{id:"_1-0-\u5B89\u88C5-docker-compose",tabindex:"-1"},[a("1.0 \u5B89\u88C5 docker-compose "),s("a",{class:"header-anchor",href:"#_1-0-\u5B89\u88C5-docker-compose","aria-hidden":"true"},"#")],-1),$=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'curl -L "https://github.com/docker/compose/releases/download/1.28.3/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"chmod +x /usr/local/bin/docker-compose")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),q=s("h4",{id:"_2-0-\u4E0B\u8F7Dyaml\u6587\u4EF6",tabindex:"-1"},[a("2.0 \u4E0B\u8F7Dyaml\u6587\u4EF6 "),s("a",{class:"header-anchor",href:"#_2-0-\u4E0B\u8F7Dyaml\u6587\u4EF6","aria-hidden":"true"},"#")],-1),j=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"wget https://raw.githubusercontent.com/grafana/loki/v2.2.0/production/docker-compose.yaml -O docker-compose.yaml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'version: "3"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"networks:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  loki:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"services:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  loki:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: grafana/loki:2.0.0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    ports:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'      - "3100:3100"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    command: -config.file=/etc/loki/local-config.yaml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    networks:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - loki")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  promtail:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: grafana/promtail:2.0.0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    volumes:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - /var/log:/var/log")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    command: -config.file=/etc/promtail/config.yml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    networks:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - loki")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  grafana:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: grafana/grafana:latest")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    ports:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'      - "3000:3000"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    networks:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - loki")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),E=s("h4",{id:"_3-0-\u542F\u52A8\u670D\u52A1",tabindex:"-1"},[a("3.0 \u542F\u52A8\u670D\u52A1 "),s("a",{class:"header-anchor",href:"#_3-0-\u542F\u52A8\u670D\u52A1","aria-hidden":"true"},"#")],-1),K=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-compose -f docker-compose.yaml up")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),U=s("h4",{id:"_4-0-\u68C0\u67E5\u670D\u52A1",tabindex:"-1"},[a("4.0 \u68C0\u67E5\u670D\u52A1 "),s("a",{class:"header-anchor",href:"#_4-0-\u68C0\u67E5\u670D\u52A1","aria-hidden":"true"},"#")],-1),B=s("h4",{id:"_5-0-\u914D\u7F6E\u670D\u52A1",tabindex:"-1"},[a("5.0 \u914D\u7F6E\u670D\u52A1 "),s("a",{class:"header-anchor",href:"#_5-0-\u914D\u7F6E\u670D\u52A1","aria-hidden":"true"},"#")],-1),N=s("p",null,[s("a",{href:"http://192.168.106.202:3000/!%5B640%5D(https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140410.png)",target:"_blank",rel:"noreferrer"},"http://192.168.106.202:3000/![640](https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140410.png)")],-1),O=s("p",null,"\u9ED8\u8BA4granfna\u5BC6\u7801admin/admin",-1),S=s("h5",{id:"_5-1-\u914D\u7F6E\u6570\u636E\u6E90",tabindex:"-1"},[a("5.1 \u914D\u7F6E\u6570\u636E\u6E90 "),s("a",{class:"header-anchor",href:"#_5-1-\u914D\u7F6E\u6570\u636E\u6E90","aria-hidden":"true"},"#")],-1),T=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140449.png",alt:"640 (1)"})],-1),V=s("p",null,"\u914D\u7F6Eip\u548C\u9ED8\u8BA4\u6570\u636E\u6E90\uFF0C\u914D\u7F6E\u5B8C\u6210\u70B9\u51FB\u6D4B\u8BD5/\u4FDD\u5B58",-1),G=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140524.png",alt:"640 (2)"})],-1),J=s("h5",{id:"_5-2-\u914D\u7F6E\u6570\u636E\u6E90",tabindex:"-1"},[a("5.2 \u914D\u7F6E\u6570\u636E\u6E90 "),s("a",{class:"header-anchor",href:"#_5-2-\u914D\u7F6E\u6570\u636E\u6E90","aria-hidden":"true"},"#")],-1),P=s("p",null,"explore \u67E5\u8BE2\u6837\u4F8B",-1),Z=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140548.png",alt:"640 (3)"})],-1),I=s("h5",{id:"_5-3-\u8F93\u51FA\u5339\u914D\u65E5\u5FD7\u4FE1\u606F",tabindex:"-1"},[a("5.3 \u8F93\u51FA\u5339\u914D\u65E5\u5FD7\u4FE1\u606F "),s("a",{class:"header-anchor",href:"#_5-3-\u8F93\u51FA\u5339\u914D\u65E5\u5FD7\u4FE1\u606F","aria-hidden":"true"},"#")],-1),M=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140619.png",alt:"640 (4)"})],-1),R=s("p",null,"\u81F3\u6B64\u4E00\u6B21\u6837\u4F8B\u65E5\u5FD7\u67E5\u8BE2\u5B8C\u6210",-1),z=s("h4",{id:"_6-0-promtail\u914D\u7F6E\u8BE6\u89E3",tabindex:"-1"},[a("6.0 promtail\u914D\u7F6E\u8BE6\u89E3 "),s("a",{class:"header-anchor",href:"#_6-0-promtail\u914D\u7F6E\u8BE6\u89E3","aria-hidden":"true"},"#")],-1),F=s("p",null,"promtail\u5BB9\u5668\u4E3A\u65E5\u5FD7\u91C7\u96C6\u5BB9\u5668\uFF0C\u914D\u7F6E\u6587\u4EF6\u5728promtail\u5BB9\u5668/etc/promtail/config.yml\uFF0C\u5C06\u8BE5\u5BB9\u5668\u90E8\u7F72\u5728\u9700\u8981\u91C7\u96C6\u65E5\u5FD7\u7684\u670D\u52A1\u5668\u4E0A\u5C31\u80FD\u6B63\u5E38\u91C7\u96C6\u65E5\u5FD7\u4F20\u56DEloki\u670D\u52A1\u6536\u96C6\u6574\u7406",-1),H=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@2a0cc144dd58:/#  cat  /etc/promtail/config.yml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"server:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  http_listen_port: 9080")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  grpc_listen_port: 0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"positions:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  filename: /tmp/positions.yaml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"clients:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - url: http://loki:3100/loki/api/v1/push     #\u8FD9\u91CC\u914D\u7F6E\u7684\u5730\u5740\u4E3Aloki\u670D\u52A1\u5668\u65E5\u5FD7\u6536\u96C6\u7684\u4FE1\u606F")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scrape_configs:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- job_name: system")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  static_configs:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - targets:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - localhost")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    labels:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      job: varlogs                       #\u8FD9\u91CC\u4E3A\u521A\u624D\u9009\u62E9job\u4E0B\u5B50\u6807\u7B7E")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      __path__: /var/log/*log            #\u5C06\u91C7\u96C6\u7684\u65E5\u5FD7\u653E\u5728/var/log/*log\u4E0B\u81EA\u52A8\u53D1\u73B0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Q=s("h4",{id:"_7-0-\u589E\u52A0\u4E00\u53F0\u670D\u52A1\u5668\u65E5\u5FD7\u91C7\u96C6",tabindex:"-1"},[a("7.0 \u589E\u52A0\u4E00\u53F0\u670D\u52A1\u5668\u65E5\u5FD7\u91C7\u96C6 "),s("a",{class:"header-anchor",href:"#_7-0-\u589E\u52A0\u4E00\u53F0\u670D\u52A1\u5668\u65E5\u5FD7\u91C7\u96C6","aria-hidden":"true"},"#")],-1),W=s("h5",{id:"_7-1-\u7F16\u5199-promtail\u7684\u914D\u7F6E\u6587\u4EF6config-yml",tabindex:"-1"},[a("7.1 \u7F16\u5199 promtail\u7684\u914D\u7F6E\u6587\u4EF6config.yml "),s("a",{class:"header-anchor",href:"#_7-1-\u7F16\u5199-promtail\u7684\u914D\u7F6E\u6587\u4EF6config-yml","aria-hidden":"true"},"#")],-1),X=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mkdir  /root/promtail  &&cd  /root/promtail")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@node2 promtail]# cat config.yml ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"server:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  http_listen_port: 9080")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  grpc_listen_port: 0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"positions:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  filename: /tmp/positions.yaml")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"clients:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - url: http://192.168.106.202:3100/loki/api/v1/push     #\u8FD9\u91CC\u914D\u7F6E\u7684\u5730\u5740\u4E3Aloki\u670D\u52A1\u5668\u65E5\u5FD7\u6536\u96C6\u7684\u4FE1\u606F")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scrape_configs:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- job_name: mysql")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  static_configs:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - targets:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - localhost")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    labels:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      job: mysql                         #\u8FD9\u91CC\u4E3A\u521A\u624D\u9009\u62E9job\u4E0B\u5B50\u6807\u7B7E")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      __path__: /var/log/*log            #\u5C06\u91C7\u96C6\u7684\u65E5\u5FD7\u653E\u5728/var/log/*log\u4E0B\u81EA\u52A8\u53D1\u73B0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Y=s("h5",{id:"_7-2-\u7F16\u5199docker-compose-yaml\u914D\u7F6E\u6587\u4EF6",tabindex:"-1"},[a("7.2 \u7F16\u5199docker-compose.yaml\u914D\u7F6E\u6587\u4EF6 "),s("a",{class:"header-anchor",href:"#_7-2-\u7F16\u5199docker-compose-yaml\u914D\u7F6E\u6587\u4EF6","aria-hidden":"true"},"#")],-1),ss=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@node2 promtail]# cat  docker-compose.yaml ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'version: "v1"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"services:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  promtail:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: grafana/promtail:2.0.0               #\u62C9\u53BB\u955C\u50CF")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    container_name: promtail-node              #\u955C\u50CF\u540D\u79F0")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    volumes:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - /root/promtail/config.yml:/etc/promtail/config.yml    #\u6302\u8F7D\u76EE\u5F55")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - /var/log:/var/log           ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    network_mode: 'host'")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),as=s("h5",{id:"_7-3-\u542F\u52A8",tabindex:"-1"},[a("7.3 \u542F\u52A8 "),s("a",{class:"header-anchor",href:"#_7-3-\u542F\u52A8","aria-hidden":"true"},"#")],-1),ls=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-compose up -d ")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ns=s("h5",{id:"_8-0-\u53BBloki\u4E0A\u67E5\u770B\u68C0\u7D22",tabindex:"-1"},[a("8.0 \u53BBloki\u4E0A\u67E5\u770B\u68C0\u7D22 "),s("a",{class:"header-anchor",href:"#_8-0-\u53BBloki\u4E0A\u67E5\u770B\u68C0\u7D22","aria-hidden":"true"},"#")],-1),es=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140652.png",alt:"640 (5)"})],-1),os=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140730.png",alt:"640 (6)"})],-1),ts=s("p",null,[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/20210407140756.png",alt:"640 (7)"})],-1),is=s("p",null,"\u53EF\u4EE5\u6839\u636E\u6570\u636E\u67E5\u8BE2\u5230\u76F8\u5E94\u65E5\u5FD7\u4FE1\u606F",-1);function cs(n,rs,ps,ds,t,hs){const i=c;return d(),p(i,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":l(()=>[C,A,_,g,u,y,D,k,f,v,b,x,w,L,$,q,j,E,K,U,B,N,O,S,T,V,G,J,P,Z,I,M,R,z,F,H,Q,W,X,Y,ss,as,ls,ns,es,os,ts,is]),"main-header":l(()=>[e(n.$slots,"main-header")]),"main-header-after":l(()=>[e(n.$slots,"main-header-after")]),"main-nav":l(()=>[e(n.$slots,"main-nav")]),"main-content":l(()=>[e(n.$slots,"main-content")]),"main-content-after":l(()=>[e(n.$slots,"main-content-after")]),"main-nav-before":l(()=>[e(n.$slots,"main-nav-before")]),"main-nav-after":l(()=>[e(n.$slots,"main-nav-after")]),comment:l(()=>[e(n.$slots,"comment")]),footer:l(()=>[e(n.$slots,"footer")]),aside:l(()=>[e(n.$slots,"aside")]),"aside-custom":l(()=>[e(n.$slots,"aside-custom")]),default:l(()=>[e(n.$slots,"default")]),_:3},8,["frontmatter","data"])}const ys=r(m,[["render",cs]]);export{us as __pageData,ys as default};
