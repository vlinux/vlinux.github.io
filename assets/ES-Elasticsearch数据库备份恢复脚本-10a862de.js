import{_ as p}from"./ValaxyMain.vue_vue_type_style_index_0_lang-ff623c6a.js";import{_ as r,c as D,w as o,o as y,r as e,b as s,U as l,p as F}from"./app-4a4ffc33.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-8f14011c.js";import"./YunCard.vue_vue_type_style_index_0_lang-44a49504.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-4581fd4f.js";const j=JSON.parse('{"title":"ES-Elasticsearch数据库备份恢复脚本","description":"","frontmatter":{"title":"ES-Elasticsearch数据库备份恢复脚本","categories":"ES","tags":["Elasticsearch备份脚本"],"date":"2021-01-13T11:50:00.000Z"},"headers":[],"relativePath":"pages/posts/ES-Elasticsearch数据库备份恢复脚本.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/ES-Elasticsearch数据库备份恢复脚本.md","lastUpdated":1671090556000}'),n=JSON.parse('{"title":"ES-Elasticsearch数据库备份恢复脚本","description":"","frontmatter":{"title":"ES-Elasticsearch数据库备份恢复脚本","categories":"ES","tags":["Elasticsearch备份脚本"],"date":"2021-01-13T11:50:00.000Z"},"headers":[],"relativePath":"pages/posts/ES-Elasticsearch数据库备份恢复脚本.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/ES-Elasticsearch数据库备份恢复脚本.md","lastUpdated":1671090556000}'),C={name:"pages/posts/ES-Elasticsearch数据库备份恢复脚本.md",data(){return{data:n,frontmatter:n.frontmatter}},setup(){F("pageData",n)}},i=s("p",null,[s("strong",null,"1.备份数据"),l(" 1.1 创建备份仓库")],-1),A=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"$"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-u"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"elastic:"),s("span",{style:{color:"#F78C6C"}},"123456"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-XPOST"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"192.168.1.1:9200/_snapshot/hsbc_backup"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-H"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"Content-Type: application/json"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-d"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},'{ "type": "fs",  "settings": { "location": "/alidata1/admin/backup/elasticsearch", "compress": true, "chunk_size": "1g", "max_snapshot_bytes_per_sec": "50m", "max_restore_bytes_per_sec": "50m"}}'),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"1")]),l(`
`),s("span",{class:"line"})])])],-1),E=s("p",null,"1.2 备份脚本",-1),_=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"$"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"cat"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/alidata1/admin/scripts/elasticsearch/es_bak_del.sh")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#!/bin/bash")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"## define vars")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"http://192.168.1.1:9200"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"hsbc_backup"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"elastic"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"123456"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_bak_date"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"`"),s("span",{style:{color:"#FFCB6B"}},"date"),s("span",{style:{color:"#C3E88D"}}," +"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%Y-%m-%d-%H"),s("span",{style:{color:"#89DDFF"}},"'`")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"\\n =========== "),s("span",{style:{color:"#A6ACCD"}},"$es_bak_date"),s("span",{style:{color:"#C3E88D"}}," ============"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"## bak")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-u"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-XPUT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_snapshot/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/es_bak_"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_date"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"?wait_for_completion=true"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'""')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"##sleep")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"sleep"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"##del 最后的60: 定时任务 每4小时备份一次 一天备份6次  数据保留10天")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_del_snapshots"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"`"),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#C3E88D"}}," -u "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}}," -s -XGET "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_snapshot/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_all"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#FFCB6B"}},"python"),s("span",{style:{color:"#C3E88D"}}," -m json.tool"),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#FFCB6B"}},"python"),s("span",{style:{color:"#C3E88D"}}," -c "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},'import json; import sys; input = sys.stdin.read(); result = [x["snapshot"] for x in json.loads(input)["snapshots"]]; print("\\n".join(result[:-60]));'),s("span",{style:{color:"#89DDFF"}},"'`")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," es_del_snapshot "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_del_snapshots"),s("span",{style:{color:"#89DDFF"}},"};"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"==========="),s("span",{style:{color:"#A6ACCD"}},"$es_del_snapshot"),s("span",{style:{color:"#C3E88D"}}," del"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-u"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-s"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-XDELETE"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_snapshot/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_del_snapshot"),s("span",{style:{color:"#89DDFF"}},'}"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'""')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1),d=s("p",null,"1.3 创建定时任务",-1),h=s("div",{class:"language-sh"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"$"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"crontab"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}},"/"),s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"*"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"**"),s("span",{style:{color:"#A6ACCD"}}," /bin/bash /alidata1/admin/scripts/elasticsearch/es_bak_del.sh "),s("span",{style:{color:"#89DDFF"}},">>"),s("span",{style:{color:"#A6ACCD"}}," /alidata1/admin/logs/crontab/es_bak/crontab.log "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#89DDFF"}},">&1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"12")]),l(`
`),s("span",{class:"line"})])])],-1),u=s("p",null,[s("strong",null,"2.数据还原"),l(" 目的：将某一个备份的文件还原到192.168.1.1")],-1),f=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"$"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"cat"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"es_restore.sh")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#!/bin/bash")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"set"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"## define vars")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"http://192.168.1.1:9200"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"hsbc_backup"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_restore_snapshots"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"es_bak_20200811"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"elastic"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"123456"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"##(1)获取备份文件中存在的索引")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"es_get_snapshots_index"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"`"),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#C3E88D"}}," -u "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}}," -s -XGET "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_snapshot/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_restore_snapshots"),s("span",{style:{color:"#89DDFF"}},'}"'),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#FFCB6B"}},"python"),s("span",{style:{color:"#C3E88D"}}," -m json.tool"),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#FFCB6B"}},"python"),s("span",{style:{color:"#C3E88D"}}," -c "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},'import json; import sys; input = sys.stdin.read(); result=json.loads(input); indices = result["snapshots"][0]["indices"]; sys.stdout.write("  ".join([i for i in indices]));'),s("span",{style:{color:"#89DDFF"}},"'`")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"##(2)将备份文件中存在的索引删除  然后恢复")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," index "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_get_snapshots_index"),s("span",{style:{color:"#89DDFF"}},"};"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"index"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"=="),s("span",{style:{color:"#89DDFF"}},' "'),s("span",{style:{color:"#C3E88D"}},".security-6"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"];"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"then"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# 如果索引为 .security-6 则不能删除")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#FFCB6B"}},"continue")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"fi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#676E95","font-style":"italic"}},"# 判断索引是否存在")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    res"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"`"),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#C3E88D"}}," -s -u "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}}," -XGET "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"index"),s("span",{style:{color:"#89DDFF"}},'}"|'),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#FFCB6B"}},"grep"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"error"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#FFCB6B"}},"grep"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#F78C6C"}},"404"),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#FFCB6B"}},"awk"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"{print $1}"),s("span",{style:{color:"#89DDFF"}},"'`")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-z"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"res"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"then"),s("span",{style:{color:"#A6ACCD"}},"   "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#如果存在则删除索引")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-s"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-u"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-XDELETE"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"index"),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"\\ndelete index data : "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"index"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}}," "),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"fi")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#数据恢复")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"data restore : "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"index"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"\\n"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-s"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-u"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_user"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"es_pass"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-XPOST"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"es_url"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_snapshot/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_bak_repo"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#C3E88D"}},"es_restore_snapshots"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"/_restore"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-H"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"Content-Type: application/json"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-d"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},'{"indices": "'),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"index"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},'"}'),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1);function m(a,$,B,b,t,g){const c=p;return y(),D(c,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":o(()=>[i,A,E,_,d,h,u,f]),"main-header":o(()=>[e(a.$slots,"main-header")]),"main-header-after":o(()=>[e(a.$slots,"main-header-after")]),"main-nav":o(()=>[e(a.$slots,"main-nav")]),"main-content":o(()=>[e(a.$slots,"main-content")]),"main-content-after":o(()=>[e(a.$slots,"main-content-after")]),"main-nav-before":o(()=>[e(a.$slots,"main-nav-before")]),"main-nav-after":o(()=>[e(a.$slots,"main-nav-after")]),comment:o(()=>[e(a.$slots,"comment")]),footer:o(()=>[e(a.$slots,"footer")]),aside:o(()=>[e(a.$slots,"aside")]),"aside-custom":o(()=>[e(a.$slots,"aside-custom")]),default:o(()=>[e(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const X=r(C,[["render",m]]);export{j as __pageData,X as default};
