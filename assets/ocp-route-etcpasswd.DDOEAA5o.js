import{_ as o}from"./ValaxyMain.vue_vue_type_style_index_0_lang.CdMcCuLR.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as g,u as y,a as u}from"./chunks/vue-router.Cro35QNm.js";import{aa as F,ap as a,ag as n,af as i,ae as m,ai as s,P as f,ab as A,a1 as D}from"./framework.GHZxz7jq.js";import"./index.mH_NH_pU.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.BaL1KWr8.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.Dy68RlFi.js";const c=g("/posts/ocp-route-etcpasswd",async h=>JSON.parse('{"title":"OpenShift Route 敏感路径拦截实战笔记","description":"","frontmatter":{"title":"OpenShift Route 敏感路径拦截实战笔记","date":"2025-04-16 15:36:50","updated":"2025-04-16 15:36:50","tags":"OCP","categories":"Linux技术","end":false},"headers":[],"relativePath":"pages/posts/ocp-route-etcpasswd.md","lastUpdated":null}'),{lazy:(h,e)=>h.name===e.name}),T={__name:"ocp-route-etcpasswd",setup(h,{expose:e}){const{data:r}=c(),p=u(),E=y(),k=Object.assign(E.meta.frontmatter||{},r.value?.frontmatter||{});return p.currentRoute.value.data=r.value,D("valaxy:frontmatter",k),globalThis.$frontmatter=k,e({frontmatter:{title:"OpenShift Route 敏感路径拦截实战笔记",date:"2025-04-16 15:36:50",updated:"2025-04-16 15:36:50",tags:"OCP",categories:"Linux技术",end:!1}}),(t,l)=>{const d=o;return A(),F(d,{frontmatter:f(k)},{"main-content-md":a(()=>[l[0]||(l[0]=i("p",null,[s("在 OpenShift 环境中，我们遇到一个安全需求："),i("strong",null,[s("拦截 "),i("code",null,"/etc/passwd"),s(" 等敏感路径的访问请求")]),s("，防止路径遍历攻击。最初尝试直接在 Route 中配置正则表达式拦截，但发现 OpenShift Route 原生不支持类似 "),i("code",null,"haproxy.router.openshift.io/deny-regex"),s(" 的注解。经过多次探索，最终通过 "),i("strong",null,"多 Route 组合方案"),s(" 成功实现目标。")],-1)),m(" more "),l[1]||(l[1]=i("h1",{id:"openshift-route-敏感路径拦截实战笔记",tabindex:"-1"},[s("OpenShift Route 敏感路径拦截实战笔记 "),i("a",{class:"header-anchor",href:"#openshift-route-敏感路径拦截实战笔记","aria-label":'Permalink to "OpenShift Route 敏感路径拦截实战笔记"'},"​")],-1)),l[2]||(l[2]=i("h2",{id:"背景",tabindex:"-1"},[s("背景 "),i("a",{class:"header-anchor",href:"#背景","aria-label":'Permalink to "背景"'},"​")],-1)),l[3]||(l[3]=i("hr",null,null,-1)),l[4]||(l[4]=i("h2",{id:"问题分析",tabindex:"-1"},[s("问题分析 "),i("a",{class:"header-anchor",href:"#问题分析","aria-label":'Permalink to "问题分析"'},"​")],-1)),l[5]||(l[5]=i("ol",null,[i("li",null,[i("strong",null,"需求场景"),s("： "),i("ul",null,[i("li",null,[s("拦截直接访问 "),i("code",null,"/etc/passwd"),s(" 的请求。")]),i("li",null,[s("防御路径遍历攻击（如 "),i("code",null,"/foo/../etc/passwd"),s("）。")])])]),i("li",null,[i("strong",null,"技术限制"),s("： "),i("ul",null,[i("li",null,"OpenShift Route 不支持正则表达式拦截。"),i("li",null,"应用层（如 Nginx）未配置路径过滤，导致请求穿透到后端。")])])],-1)),l[6]||(l[6]=i("hr",null,null,-1)),l[7]||(l[7]=i("h2",{id:"探索历程",tabindex:"-1"},[s("探索历程 "),i("a",{class:"header-anchor",href:"#探索历程","aria-label":'Permalink to "探索历程"'},"​")],-1)),l[8]||(l[8]=i("h3",{id:"错误尝试-haproxy-注解拦截",tabindex:"-1"},[s("错误尝试：HAProxy 注解拦截 "),i("a",{class:"header-anchor",href:"#错误尝试-haproxy-注解拦截","aria-label":'Permalink to "错误尝试：HAProxy 注解拦截"'},"​")],-1)),l[9]||(l[9]=i("p",null,[s("最初误以为 OpenShift Route 支持 "),i("code",null,"haproxy.router.openshift.io/deny-regex"),s("，但该注解实际不存在。"),i("strong",null,"失败原因"),s("：")],-1)),l[10]||(l[10]=i("ul",null,[i("li",null,"OpenShift Route 基于 HAProxy，但其配置抽象层未开放复杂正则匹配。")],-1)),l[11]||(l[11]=i("p",null,[i("strong",null,"问题"),s("：需调整集群入口架构，与现有 Route 方案不兼容。")],-1)),l[12]||(l[12]=i("hr",null,null,-1)),l[13]||(l[13]=i("h2",{id:"最终方案-多-route-拦截",tabindex:"-1"},[s("最终方案：多 Route 拦截 "),i("a",{class:"header-anchor",href:"#最终方案-多-route-拦截","aria-label":'Permalink to "最终方案：多 Route 拦截"'},"​")],-1)),l[14]||(l[14]=i("p",null,[s("通过 "),i("strong",null,"精确匹配敏感路径"),s(" 并指向无效服务，实现请求拦截。")],-1)),l[15]||(l[15]=i("h3",{id:"配置步骤",tabindex:"-1"},[s("配置步骤 "),i("a",{class:"header-anchor",href:"#配置步骤","aria-label":'Permalink to "配置步骤"'},"​")],-1)),l[16]||(l[16]=i("h4",{id:"_1-主-route-处理正常请求",tabindex:"-1"},[s("1. 主 Route（处理正常请求） "),i("a",{class:"header-anchor",href:"#_1-主-route-处理正常请求","aria-label":'Permalink to "1. 主 Route（处理正常请求）"'},"​")],-1)),l[17]||(l[17]=i("div",{class:"language-yaml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"apiVersion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"route.openshift.io/v1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Route")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"metadata"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"**")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  host"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"**")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  path"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"**  "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 正常业务服务")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    weight"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[18]||(l[18]=i("h4",{id:"_2-拦截-route-精确匹配敏感路径",tabindex:"-1"},[s("2. 拦截 Route（精确匹配敏感路径） "),i("a",{class:"header-anchor",href:"#_2-拦截-route-精确匹配敏感路径","aria-label":'Permalink to "2. 拦截 Route（精确匹配敏感路径）"'},"​")],-1)),l[19]||(l[19]=i("div",{class:"language-yaml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"apiVersion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"route.openshift.io/v1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Route")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"metadata"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"**")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  host"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"**")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  path"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/etc/passwd"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        # 精确匹配路径")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  to"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"invalid-service"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 不存在或返回错误的服务")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    weight"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[20]||(l[20]=i("h4",{id:"_3-静态错误服务-可选",tabindex:"-1"},[s("3. 静态错误服务（可选） "),i("a",{class:"header-anchor",href:"#_3-静态错误服务-可选","aria-label":'Permalink to "3. 静态错误服务（可选）"'},"​")],-1)),l[21]||(l[21]=i("p",null,"若需返回 403，可部署专用服务：",-1)),l[22]||(l[22]=i("div",{class:"language-yaml"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"yaml"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"apiVersion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"apps/v1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Deployment")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"metadata"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"error-service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  template"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    spec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      containers"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nginx")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"        image"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"nginx")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"        volumeMounts"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        - "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"          mountPath"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/etc/nginx/conf.d")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"      volumes"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"      - "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"config")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"        configMap"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"          name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"error-config"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  # 包含返回 403 的 Nginx 配置")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"---")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"apiVersion"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"v1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"kind"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"Service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"metadata"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"error-service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"spec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"  ports"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  - "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"port"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"80")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"    targetPort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"80")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[23]||(l[23]=i("hr",null,null,-1)),l[24]||(l[24]=i("h2",{id:"验证方法",tabindex:"-1"},[s("验证方法 "),i("a",{class:"header-anchor",href:"#验证方法","aria-label":'Permalink to "验证方法"'},"​")],-1)),l[25]||(l[25]=i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 测试敏感路径")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -v"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"*******"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/etc/passwd")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 预期结果：HTTP 503（无效服务）或 403（静态错误服务）")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 查看 HAProxy 日志")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"oc"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," logs"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," openshift-ingress"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," <"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"router-po"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"d"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," grep"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "etc/passwd"')])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[26]||(l[26]=i("hr",null,null,-1)),l[27]||(l[27]=i("h2",{id:"总结与反思",tabindex:"-1"},[s("总结与反思 "),i("a",{class:"header-anchor",href:"#总结与反思","aria-label":'Permalink to "总结与反思"'},"​")],-1)),l[28]||(l[28]=i("ol",null,[i("li",null,[i("strong",null,"OpenShift Route 的限制"),s("： "),i("ul",null,[i("li",null,"不支持正则表达式拦截，需通过多 Route 组合实现。"),i("li",null,[s("复杂场景建议结合 "),i("strong",null,"Service Mesh"),s(" 或 "),i("strong",null,"应用层拦截"),s("。")])])]),i("li",null,[i("strong",null,"防御纵深"),s("： "),i("ul",null,[i("li",null,[i("strong",null,"入口层"),s("：Route 拦截已知攻击模式。")]),i("li",null,[i("strong",null,"应用层"),s("：Nginx 配置过滤敏感路径。")]),i("li",null,[i("strong",null,"容器层"),s("：非 root 用户 + 只读文件系统。")])])]),i("li",null,[i("strong",null,"经验教训"),s("： "),i("ul",null,[i("li",null,"验证技术方案时需严格依赖官方文档。"),i("li",null,"安全防护需多层互补，避免单点失效。")])])],-1))]),"main-header":a(()=>[n(t.$slots,"main-header")]),"main-header-after":a(()=>[n(t.$slots,"main-header-after")]),"main-nav":a(()=>[n(t.$slots,"main-nav")]),"main-content-before":a(()=>[n(t.$slots,"main-content-before")]),"main-content":a(()=>[n(t.$slots,"main-content")]),"main-content-after":a(()=>[n(t.$slots,"main-content-after")]),"main-nav-before":a(()=>[n(t.$slots,"main-nav-before")]),"main-nav-after":a(()=>[n(t.$slots,"main-nav-after")]),comment:a(()=>[n(t.$slots,"comment")]),footer:a(()=>[n(t.$slots,"footer")]),aside:a(()=>[n(t.$slots,"aside")]),"aside-custom":a(()=>[n(t.$slots,"aside-custom")]),default:a(()=>[n(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{T as default,c as usePageData};
