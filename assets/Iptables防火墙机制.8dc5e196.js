import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang.0d268722.js";import{_ as r,c as i,w as o,o as C,r as n,b as s,R as l,p as A}from"./app.7d008c65.js";import"./YunFooter.vue_vue_type_script_setup_true_lang.05401363.js";import"./YunCard.vue_vue_type_style_index_0_lang.4a8fe257.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.60c12e42.js";const Hl=JSON.parse('{"title":"Iptables\u9632\u706B\u5899\u673A\u5236","description":"","frontmatter":{"title":"Iptables\u9632\u706B\u5899\u673A\u5236","categories":"Linux\u6280\u672F","tags":["iptables"],"date":"2020-03-20T10:42:00.000Z"},"headers":[{"level":2,"title":"1.iptables\u662F\u4EC0\u4E48\uFF1F","slug":"_1-iptables\u662F\u4EC0\u4E48\uFF1F","link":"#_1-iptables\u662F\u4EC0\u4E48\uFF1F","children":[]},{"level":2,"title":"2.iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","slug":"_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","link":"#_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","children":[]},{"level":2,"title":"3.\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","slug":"_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","link":"#_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","children":[]},{"level":2,"title":"1.\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","slug":"_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","link":"#_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","children":[]},{"level":2,"title":"2.FILTER\u8868","slug":"_2-filter\u8868","link":"#_2-filter\u8868","children":[]},{"level":2,"title":"3.NAT\u8868","slug":"_3-nat\u8868","link":"#_3-nat\u8868","children":[]},{"level":2,"title":"1.\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","slug":"_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","link":"#_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","children":[]},{"level":2,"title":"2.\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","slug":"_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","link":"#_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","children":[]},{"level":2,"title":"3.\u542F\u52A8\u9632\u706B\u5899","slug":"_3-\u542F\u52A8\u9632\u706B\u5899","link":"#_3-\u542F\u52A8\u9632\u706B\u5899","children":[]},{"level":2,"title":"1.\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","slug":"_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","link":"#_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"2.\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","slug":"_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","link":"#_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"3.\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","slug":"_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","link":"#_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"4.\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","slug":"_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","link":"#_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","children":[]},{"level":2,"title":"4.\u5220\u9664\u67D0\u4E2A\u89C4\u5219","slug":"_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219","link":"#_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219","children":[]},{"level":2,"title":"1.\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","slug":"_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","link":"#_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","children":[]},{"level":2,"title":"2.\u7981\u6B62\u67D0\u4E2AIP\u8BBF\u95EE","slug":"_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE","link":"#_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE","children":[]},{"level":2,"title":"3.\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684IP\u8BBF\u95EE","slug":"_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE","link":"#_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE","children":[]},{"level":2,"title":"4.\u5339\u914D\u7AEF\u53E3\u8303\u56F4","slug":"_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4","link":"#_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4","children":[]},{"level":2,"title":"5.\u5339\u914DICMP\u7C7B\u578B","slug":"_5-\u5339\u914Dicmp\u7C7B\u578B","link":"#_5-\u5339\u914Dicmp\u7C7B\u578B","children":[]},{"level":2,"title":"6.\u7EC3\u4E60\u9898","slug":"_6-\u7EC3\u4E60\u9898","link":"#_6-\u7EC3\u4E60\u9898","children":[]},{"level":2,"title":"1.\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","slug":"_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","link":"#_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","children":[]},{"level":2,"title":"2.\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","slug":"_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","link":"#_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","children":[]},{"level":2,"title":"3.\u7AEF\u53E3\u6620\u5C04","slug":"_3-\u7AEF\u53E3\u6620\u5C04","link":"#_3-\u7AEF\u53E3\u6620\u5C04","children":[]},{"level":2,"title":"4.IP\u6620\u5C04","slug":"_4-ip\u6620\u5C04","link":"#_4-ip\u6620\u5C04","children":[]}],"relativePath":"pages/posts/Iptables\u9632\u706B\u5899\u673A\u5236.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/Iptables\u9632\u706B\u5899\u673A\u5236.md","lastUpdated":1671091756000}'),a=JSON.parse('{"title":"Iptables\u9632\u706B\u5899\u673A\u5236","description":"","frontmatter":{"title":"Iptables\u9632\u706B\u5899\u673A\u5236","categories":"Linux\u6280\u672F","tags":["iptables"],"date":"2020-03-20T10:42:00.000Z"},"headers":[{"level":2,"title":"1.iptables\u662F\u4EC0\u4E48\uFF1F","slug":"_1-iptables\u662F\u4EC0\u4E48\uFF1F","link":"#_1-iptables\u662F\u4EC0\u4E48\uFF1F","children":[]},{"level":2,"title":"2.iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","slug":"_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","link":"#_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","children":[]},{"level":2,"title":"3.\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","slug":"_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","link":"#_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","children":[]},{"level":2,"title":"1.\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","slug":"_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","link":"#_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","children":[]},{"level":2,"title":"2.FILTER\u8868","slug":"_2-filter\u8868","link":"#_2-filter\u8868","children":[]},{"level":2,"title":"3.NAT\u8868","slug":"_3-nat\u8868","link":"#_3-nat\u8868","children":[]},{"level":2,"title":"1.\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","slug":"_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","link":"#_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","children":[]},{"level":2,"title":"2.\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","slug":"_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","link":"#_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","children":[]},{"level":2,"title":"3.\u542F\u52A8\u9632\u706B\u5899","slug":"_3-\u542F\u52A8\u9632\u706B\u5899","link":"#_3-\u542F\u52A8\u9632\u706B\u5899","children":[]},{"level":2,"title":"1.\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","slug":"_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","link":"#_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"2.\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","slug":"_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","link":"#_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"3.\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","slug":"_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","link":"#_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","children":[]},{"level":2,"title":"4.\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","slug":"_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","link":"#_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","children":[]},{"level":2,"title":"4.\u5220\u9664\u67D0\u4E2A\u89C4\u5219","slug":"_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219","link":"#_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219","children":[]},{"level":2,"title":"1.\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","slug":"_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","link":"#_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","children":[]},{"level":2,"title":"2.\u7981\u6B62\u67D0\u4E2AIP\u8BBF\u95EE","slug":"_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE","link":"#_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE","children":[]},{"level":2,"title":"3.\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684IP\u8BBF\u95EE","slug":"_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE","link":"#_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE","children":[]},{"level":2,"title":"4.\u5339\u914D\u7AEF\u53E3\u8303\u56F4","slug":"_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4","link":"#_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4","children":[]},{"level":2,"title":"5.\u5339\u914DICMP\u7C7B\u578B","slug":"_5-\u5339\u914Dicmp\u7C7B\u578B","link":"#_5-\u5339\u914Dicmp\u7C7B\u578B","children":[]},{"level":2,"title":"6.\u7EC3\u4E60\u9898","slug":"_6-\u7EC3\u4E60\u9898","link":"#_6-\u7EC3\u4E60\u9898","children":[]},{"level":2,"title":"1.\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","slug":"_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","link":"#_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","children":[]},{"level":2,"title":"2.\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","slug":"_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","link":"#_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","children":[]},{"level":2,"title":"3.\u7AEF\u53E3\u6620\u5C04","slug":"_3-\u7AEF\u53E3\u6620\u5C04","link":"#_3-\u7AEF\u53E3\u6620\u5C04","children":[]},{"level":2,"title":"4.IP\u6620\u5C04","slug":"_4-ip\u6620\u5C04","link":"#_4-ip\u6620\u5C04","children":[]}],"relativePath":"pages/posts/Iptables\u9632\u706B\u5899\u673A\u5236.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/Iptables\u9632\u706B\u5899\u673A\u5236.md","lastUpdated":1671091756000}'),D={name:"pages/posts/Iptables\u9632\u706B\u5899\u673A\u5236.md",data(){return{data:a,frontmatter:a.frontmatter}},setup(){A("pageData",a)}},y=s("h1",{id:"\u7B2C1\u7AE0-iptables\u4ECB\u7ECD",tabindex:"-1"},[l("\u7B2C1\u7AE0 iptables\u4ECB\u7ECD "),s("a",{class:"header-anchor",href:"#\u7B2C1\u7AE0-iptables\u4ECB\u7ECD","aria-hidden":"true"},"#")],-1),F=s("h2",{id:"_1-iptables\u662F\u4EC0\u4E48\uFF1F",tabindex:"-1"},[l("1.iptables\u662F\u4EC0\u4E48\uFF1F "),s("a",{class:"header-anchor",href:"#_1-iptables\u662F\u4EC0\u4E48\uFF1F","aria-hidden":"true"},"#")],-1),d=s("p",null,"iptables\u662F\u5F00\u6E90\u7684\u57FA\u4E8E\u6570\u636E\u5305\u8FC7\u6EE4\u7684\u9632\u706B\u5899\u5DE5\u5177\u3002",-1),_=s("h2",{id:"_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F",tabindex:"-1"},[l("2.iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F "),s("a",{class:"header-anchor",href:"#_2-iptables\u4F01\u4E1A\u5E94\u7528\u573A\u666F","aria-hidden":"true"},"#")],-1),h=s("p",null,"1\u3001\u4E3B\u673A\u9632\u706B\u5899\uFF08filter\u8868\u7684INPUT\u94FE\uFF09\u3002 2\u3001\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51(nat\u8868\u7684POSTROUTING\u94FE)\u3002\u534A\u4E2A\u8DEF\u7531\u5668\uFF0CNAT\u529F\u80FD\u3002 3\u3001\u7AEF\u53E3\u53CAIP\u6620\u5C04(nat\u8868\u7684PREROUTING\u94FE)\uFF0C\u786C\u9632\u7684NAT\u529F\u80FD\u3002 4\u3001IP\u4E00\u5BF9\u4E00\u6620\u5C04\u3002",-1),u=s("h2",{id:"_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C",tabindex:"-1"},[l("3.\u5546\u7528\u9632\u706B\u5899\u54C1\u724C "),s("a",{class:"header-anchor",href:"#_3-\u5546\u7528\u9632\u706B\u5899\u54C1\u724C","aria-hidden":"true"},"#")],-1),b=s("p",null,"\u534E\u4E3A \u6DF1\u4FE1\u670D \u601D\u79D1 H3C Juniper \u5929\u878D\u4FE1 \u98DE\u5854 \u7F51\u5EB7 \u7EFF\u76DF\u79D1\u6280 \u91D1\u76FE",-1),P=s("h1",{id:"\u7B2C2\u7AE0-iptables\u5DE5\u4F5C\u6D41\u7A0B",tabindex:"-1"},[l("\u7B2C2\u7AE0 iptables\u5DE5\u4F5C\u6D41\u7A0B "),s("a",{class:"header-anchor",href:"#\u7B2C2\u7AE0-iptables\u5DE5\u4F5C\u6D41\u7A0B","aria-hidden":"true"},"#")],-1),T=s("p",null,"iptables\u662F\u91C7\u7528\u6570\u636E\u5305\u8FC7\u6EE4\u673A\u5236\u5DE5\u4F5C\u7684\uFF0C\u6240\u4EE5\u5B83\u4F1A\u5BF9\u8BF7\u6C42\u7684\u6570\u636E\u5305\u7684\u5305\u5934\u6570\u636E\u8FDB\u884C\u5206\u6790\uFF0C\u5E76\u6839\u636E\u6211\u4EEC\u9884\u5148\u8BBE\u5B9A\u7684\u89C4\u5219\u8FDB\u884C\u5339\u914D\u6765\u51B3\u5B9A\u662F\u5426\u53EF\u4EE5\u8FDB\u5165\u4E3B\u673A\u3002 1.\u9632\u706B\u5899\u662F\u4E00\u5C42\u5C42\u8FC7\u6EE4\u7684\u3002\u5B9E\u9645\u662F\u6309\u7167\u914D\u7F6E\u89C4\u5219\u7684\u987A\u5E8F\u4ECE\u4E0A\u5230\u4E0B\uFF0C\u4ECE\u524D\u5230\u540E\u8FDB\u884C\u8FC7\u6EE4\u7684\u3002 2.\u5982\u679C\u5339\u914D\u4E0A\u4E86\u89C4\u5219\uFF0C\u5373\u660E\u786E\u8868\u660E\u662F\u963B\u6B62\u8FD8\u662F\u901A\u8FC7\uFF0C\u6B64\u65F6\u6570\u636E\u5305\u5C31\u4E0D\u5728\u5411\u4E0B\u5339\u914D\u65B0\u89C4\u5219\u4E86\u3002 3.\u5982\u679C\u6240\u6709\u89C4\u5219\u4E2D\u6CA1\u6709\u660E\u786E\u8868\u660E\u662F\u963B\u6B62\u8FD8\u662F\u901A\u8FC7\u8FD9\u4E2A\u6570\u636E\u5305\uFF0C\u4E5F\u5C31\u662F\u6CA1\u6709\u5339\u914D\u4E0A\u89C4\u5219\uFF0C\u5411\u4E0B\u8FDB\u884C\u5339\u914D\uFF0C\u76F4\u5230\u5339\u914D\u9ED8\u8BA4\u89C4\u5219\u5F97\u5230\u660E\u786E\u7684\u963B\u6B62\u8FD8\u662F\u901A\u8FC7\u3002 4.\u9632\u706B\u5899\u7684\u9ED8\u8BA4\u89C4\u5219\u662F\u5BF9\u5E94\u94FE\u7684\u6240\u6709\u7684\u89C4\u5219\u6267\u884C\u5B8C\u4EE5\u540E\u624D\u4F1A\u6267\u884C\u7684\uFF08\u6700\u540E\u6267\u884C\u7684\u89C4\u5219\uFF09\u3002",-1),g=s("h1",{id:"\u7B2C3\u7AE0-iptables\u56DB\u8868\u4E94\u94FE",tabindex:"-1"},[l("\u7B2C3\u7AE0 iptables\u56DB\u8868\u4E94\u94FE "),s("a",{class:"header-anchor",href:"#\u7B2C3\u7AE0-iptables\u56DB\u8868\u4E94\u94FE","aria-hidden":"true"},"#")],-1),m=s("h2",{id:"_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB",tabindex:"-1"},[l("1.\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB "),s("a",{class:"header-anchor",href:"#_1-\u8868\u4E0E\u94FE\u5BF9\u5E94\u5173\u7CFB","aria-hidden":"true"},"#")],-1),B=s("p",null,"\u5B9E\u9645iptables\u5305\u542B4\u5F20\u8868\u548C\u4E94\u4E2A\u94FE\uFF0C\u4F46\u4E3B\u8981\u8BB0\u4F4F\u4E24\u5F20\u8868\u5373\u53EFfilter\u548Cnat\u8868\u5373\u53EF\u3002",-1),I=s("p",null,[s("img",{src:"http://upload-images.jianshu.io/upload_images/14248468-58da03a179b40672.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp",alt:"img"})],-1),f=s("h2",{id:"_2-filter\u8868",tabindex:"-1"},[l("2.FILTER\u8868 "),s("a",{class:"header-anchor",href:"#_2-filter\u8868","aria-hidden":"true"},"#")],-1),E=s("p",null,[s("img",{src:"http://upload-images.jianshu.io/upload_images/14248468-b418ec2a196015e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp",alt:"img"})],-1),N=s("h2",{id:"_3-nat\u8868",tabindex:"-1"},[l("3.NAT\u8868 "),s("a",{class:"header-anchor",href:"#_3-nat\u8868","aria-hidden":"true"},"#")],-1),v=s("p",null,[s("img",{src:"http://upload-images.jianshu.io/upload_images/14248468-1f52b22fab1683cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp",alt:"img"})],-1),R=s("h1",{id:"\u7B2C4\u7AE0-iptables\u5DE5\u4F5C\u539F\u7406\u793A\u610F\u56FE",tabindex:"-1"},[l("\u7B2C4\u7AE0 iptables\u5DE5\u4F5C\u539F\u7406\u793A\u610F\u56FE "),s("a",{class:"header-anchor",href:"#\u7B2C4\u7AE0-iptables\u5DE5\u4F5C\u539F\u7406\u793A\u610F\u56FE","aria-hidden":"true"},"#")],-1),O=s("p",null,[s("img",{src:"http://upload-images.jianshu.io/upload_images/14248468-432aae0a08179e38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/664/format/webp",alt:"img"})],-1),U=s("p",null,[s("img",{src:"http://upload-images.jianshu.io/upload_images/14248468-d6bea13f8f11f33a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp",alt:"img"})],-1),j=s("h1",{id:"\u7B2C5\u7AE0-iptables\u73AF\u5883\u51C6\u5907",tabindex:"-1"},[l("\u7B2C5\u7AE0 iptables\u73AF\u5883\u51C6\u5907 "),s("a",{class:"header-anchor",href:"#\u7B2C5\u7AE0-iptables\u73AF\u5883\u51C6\u5907","aria-hidden":"true"},"#")],-1),k=s("h2",{id:"_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4",tabindex:"-1"},[l("1.\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4 "),s("a",{class:"header-anchor",href:"#_1-\u5B89\u88C5iptables\u7BA1\u7406\u547D\u4EE4","aria-hidden":"true"},"#")],-1),w=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# yum install iptables"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"services "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"y")]),l(`
`),s("span",{class:"line"})])])],-1),x=s("h2",{id:"_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757",tabindex:"-1"},[l("2.\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757 "),s("a",{class:"header-anchor",href:"#_2-\u52A0\u8F7D\u9632\u706B\u5899\u7684\u5185\u6838\u6A21\u5757","aria-hidden":"true"},"#")],-1),W=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe ip_tables")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe iptable_filter")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe iptable_nat")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe ip_conntrack")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe ip_conntrack_ftp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe ip_nat_ftp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe ipt_state")]),l(`
`),s("span",{class:"line"})])])],-1),L=s("p",null,"\u67E5\u770B\u5DF2\u52A0\u8F7D\u7684\u6A21\u5757",-1),S=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# lsmod "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#A6ACCD"}},"egrep "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"filter|nat|ipt"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ipt_REJECT             "),s("span",{style:{color:"#F78C6C"}},"12541"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_nat_ftp             "),s("span",{style:{color:"#F78C6C"}},"12770"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_conntrack_ftp       "),s("span",{style:{color:"#F78C6C"}},"18638"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," nf_nat_ftp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptable_filter         "),s("span",{style:{color:"#F78C6C"}},"12810"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"xt_nat                 "),s("span",{style:{color:"#F78C6C"}},"12681"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptable_nat            "),s("span",{style:{color:"#F78C6C"}},"12875"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_nat_ipv4            "),s("span",{style:{color:"#F78C6C"}},"14115"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," iptable_nat")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_nat                 "),s("span",{style:{color:"#F78C6C"}},"26146"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#A6ACCD"}}," nf_nat_ftp,nf_nat_ipv4,xt_nat")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_conntrack          "),s("span",{style:{color:"#F78C6C"}},"105745"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"7"),s("span",{style:{color:"#A6ACCD"}}," nf_nat_ftp,nf_nat,xt_state,nf_nat_ipv4,xt_conntrack,nf_conntrack_ftp,nf_conntrack_ipv4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ip_tables              "),s("span",{style:{color:"#F78C6C"}},"27240"),s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#A6ACCD"}}," iptable_filter,iptable_nat")]),l(`
`),s("span",{class:"line"})])])],-1),G=s("h2",{id:"_3-\u542F\u52A8\u9632\u706B\u5899",tabindex:"-1"},[l("3.\u542F\u52A8\u9632\u706B\u5899 "),s("a",{class:"header-anchor",href:"#_3-\u542F\u52A8\u9632\u706B\u5899","aria-hidden":"true"},"#")],-1),$=s("p",null,"\u9996\u5148\u505C\u6B62firewalld",-1),M=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl stop firewalld")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl disable firewalld")]),l(`
`),s("span",{class:"line"})])])],-1),V=s("p",null,"\u5F00\u542Fiptables",-1),X=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl start iptables"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"service")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl enable iptables"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"service")]),l(`
`),s("span",{class:"line"})])])],-1),Z=s("h1",{id:"\u7B2C6\u7AE0-iptables\u57FA\u672C\u64CD\u4F5C\u547D\u4EE4",tabindex:"-1"},[l("\u7B2C6\u7AE0 iptables\u57FA\u672C\u64CD\u4F5C\u547D\u4EE4 "),s("a",{class:"header-anchor",href:"#\u7B2C6\u7AE0-iptables\u57FA\u672C\u64CD\u4F5C\u547D\u4EE4","aria-hidden":"true"},"#")],-1),J=s("h2",{id:"_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219",tabindex:"-1"},[l("1.\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219 "),s("a",{class:"header-anchor",href:"#_1-\u67E5\u770B\u9632\u706B\u5899\u89C4\u5219","aria-hidden":"true"},"#")],-1),z=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@m01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95"}},"# iptables -nL")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain INPUT "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain FORWARD "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain OUTPUT "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination ")]),l(`
`),s("span",{class:"line"})])])],-1),Y=s("h2",{id:"_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219",tabindex:"-1"},[l("2.\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219 "),s("a",{class:"header-anchor",href:"#_2-\u6E05\u9664\u9632\u706B\u5899\u89C4\u5219","aria-hidden":"true"},"#")],-1),H=s("p",null,"iptables -F <- \u6E05\u9664\u6240\u6709\u89C4\u5219\uFF0C\u4E0D\u4F1A\u5904\u7406\u9ED8\u8BA4\u7684\u89C4\u5219 iptables -X <- \u5220\u9664\u7528\u6237\u81EA\u5B9A\u4E49\u7684\u94FE iptables -Z <- \u94FE\u7684\u8BA1\u6570\u5668\u6E05\u96F6\uFF08\u6570\u636E\u5305\u8BA1\u6570\u5668\u4E0E\u6570\u636E\u5305\u5B57\u8282\u8BA1\u6570\u5668\uFF09",-1),q=s("h2",{id:"_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219",tabindex:"-1"},[l("3.\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219 "),s("a",{class:"header-anchor",href:"#_3-\u6DFB\u52A0\u9632\u706B\u5899\u89C4\u5219","aria-hidden":"true"},"#")],-1),K=s("p",null,"iptables -t <-\u6307\u5B9A\u8868d(efault: `filter') iptables -A <-\u628A\u89C4\u5219\u6DFB\u52A0\u5230\u6307\u5B9A\u7684\u94FE\u4E0A\uFF0C\u9ED8\u8BA4\u6DFB\u52A0\u5230\u6700\u540E\u4E00\u884C\u3002 iptables -I <-\u63D2\u5165\u89C4\u5219\uFF0C\u9ED8\u8BA4\u63D2\u5165\u5230\u7B2C\u4E00\u884C(\u5C01IP)\u3002 iptables -D <-\u5220\u9664\u94FE\u4E0A\u7684\u89C4\u5219",-1),Q=s("h2",{id:"_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001",tabindex:"-1"},[l("4.\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001 "),s("a",{class:"header-anchor",href:"#_4-\u7F51\u7EDC\u8FDE\u63A5\u72B6\u6001","aria-hidden":"true"},"#")],-1),ss=s("p",null,"NEW\uFF1A\u5DF2\u7ECF\u6216\u5C06\u542F\u52A8\u65B0\u7684\u8FDE\u63A5 ESTABLISHED\uFF1A\u5DF2\u5EFA\u7ACB\u7684\u8FDE\u63A5 RELATED\uFF1A\u6B63\u5728\u542F\u52A8\u7684\u65B0\u8FDE\u63A5 INVALID\uFF1A\u975E\u6CD5\u6216\u65E0\u6CD5\u8BC6\u522B\u7684",-1),ls=s("h2",{id:"_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219",tabindex:"-1"},[l("4.\u5220\u9664\u67D0\u4E2A\u89C4\u5219 "),s("a",{class:"header-anchor",href:"#_4-\u5220\u9664\u67D0\u4E2A\u89C4\u5219","aria-hidden":"true"},"#")],-1),os=s("p",null,"iptables -nL --line-numbers \u67E5\u770B\u89C4\u5219\u53F7\u7801 iptables -D INPUT 1 \u5220\u9664\u6307\u5B9A\u94FE\u4E0A\u7684\u6307\u5B9A\u5E8F\u53F7",-1),es=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables A INPUT -p tcp -m state --dport 22 -j DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -nL")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -nL --line-numbers")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -D INPUT 1")]),l(`
`),s("span",{class:"line"})])])],-1),ns=s("h1",{id:"\u7B2C7\u7AE0-iptables\u5B9E\u6218",tabindex:"-1"},[l("\u7B2C7\u7AE0 iptables\u5B9E\u6218 "),s("a",{class:"header-anchor",href:"#\u7B2C7\u7AE0-iptables\u5B9E\u6218","aria-hidden":"true"},"#")],-1),as=s("h2",{id:"_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE",tabindex:"-1"},[l("1.\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#_1-\u7981\u6B62\u67D0\u4E2A\u7AEF\u53E3\u8BBF\u95EE","aria-hidden":"true"},"#")],-1),ts=s("div",{class:"language-swift"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"t filter "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p tcp "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"dport "),s("span",{style:{color:"#F78C6C"}},"22"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),ps=s("p",null,"\u89C4\u5219\u89E3\u91CA\uFF1A",-1),cs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-p       "),s("span",{style:{color:"#676E95"}},"#<==\u6307\u5B9A\u8FC7\u6EE4\u7684\u534F\u8BAE-p\uFF08tcp,udp,icmp,all\uFF09")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--dport  "),s("span",{style:{color:"#676E95"}},"#<==\u6307\u5B9A\u76EE\u6807\u7AEF\u53E3\uFF08\u7528\u6237\u8BF7\u6C42\u7684\u7AEF\u53E3\uFF09\u3002")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-j       "),s("span",{style:{color:"#676E95"}},"#<==\u5BF9\u89C4\u5219\u7684\u5177\u4F53\u5904\u7406\u65B9\u6CD5\uFF08ACCEPT,DROP,REJECT,SNAT/DNAT)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--sport  "),s("span",{style:{color:"#676E95"}},"#<==\u6307\u5B9A\u6E90\u7AEF\u53E3\u3002")]),l(`
`),s("span",{class:"line"})])])],-1),rs=s("h2",{id:"_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE",tabindex:"-1"},[l("2.\u7981\u6B62\u67D0\u4E2AIP\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#_2-\u7981\u6B62\u67D0\u4E2Aip\u8BBF\u95EE","aria-hidden":"true"},"#")],-1),is=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I INPUT -p tcp -s 10.0.0.253 -i eth0 -j DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp "),s("span",{style:{color:"#89DDFF"}},"!"),s("span",{style:{color:"#A6ACCD"}}," -s 10.0.0.1 -i eth0 -j DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp "),s("span",{style:{color:"#89DDFF"}},"!"),s("span",{style:{color:"#A6ACCD"}}," -s 10.0.0.0/24 -i eth0 -j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),Cs=s("p",null,"\u89C4\u5219\u89E3\u91CA\uFF1A",-1),As=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-s       "),s("span",{style:{color:"#676E95"}},"#<==\u6307\u5B9A\u6E90\u5730\u5740\u6216\u7F51\u6BB5\uFF08192.168.1.0/24\uFF09\u3002 ! \u53D6\u53CD\u3002")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-d       "),s("span",{style:{color:"#676E95"}},"#<==\u6307\u5B9A\u76EE\u7684\u5730\u5740\uFF08nat\u8868prerouting\uFF09\u3002")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-i       "),s("span",{style:{color:"#676E95"}},"#<==\u8FDB\u5165\u7684\u7F51\u7EDC\u63A5\u53E3\uFF08eth0,eth1\uFF09\u3002")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-o       "),s("span",{style:{color:"#676E95"}},"#<==\u51FA\u53BB\u7684\u7F51\u7EDC\u63A5\u53E3\uFF08eth0,eth1\uFF09\u3002")]),l(`
`),s("span",{class:"line"})])])],-1),Ds=s("h2",{id:"_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE",tabindex:"-1"},[l("3.\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684IP\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#_3-\u7981\u6B62\u9664\u8DF3\u677F\u673A\u4EE5\u5916\u7684ip\u8BBF\u95EE","aria-hidden":"true"},"#")],-1),ys=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I "),s("span",{style:{color:"#FFCB6B"}},"INPUT"),s("span",{style:{color:"#A6ACCD"}}," -p tcp ! -s 10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#A6ACCD"}}," -j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),Fs=s("h2",{id:"_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4",tabindex:"-1"},[l("4.\u5339\u914D\u7AEF\u53E3\u8303\u56F4 "),s("a",{class:"header-anchor",href:"#_4-\u5339\u914D\u7AEF\u53E3\u8303\u56F4","aria-hidden":"true"},"#")],-1),ds=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I INPUT -p tcp -m multiport --dport 21,22,23,24 -j DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I INPUT -p tcp --dport 3306:8809 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I INPUT -p tcp --dport 18:80 -j DROP  "),s("span",{style:{color:"#676E95"}},"#<==\u6700\u4F73")]),l(`
`),s("span",{class:"line"})])])],-1),_s=s("h2",{id:"_5-\u5339\u914Dicmp\u7C7B\u578B",tabindex:"-1"},[l("5.\u5339\u914DICMP\u7C7B\u578B "),s("a",{class:"header-anchor",href:"#_5-\u5339\u914Dicmp\u7C7B\u578B","aria-hidden":"true"},"#")],-1),hs=s("div",{class:"language-tsx"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p icmp "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"icmp"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"type "),s("span",{style:{color:"#F78C6C"}},"8")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u4F8B\uFF1Aiptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p icmp "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"icmp"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"type "),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p icmp "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"m icmp "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"icmp"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#C792EA"}},"type"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"any"),s("span",{style:{color:"#A6ACCD"}}," -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A FORWARD -s 192.168.1.0/24 -p icmp -m icmp --icmp-type any -j ACCEPT")]),l(`
`),s("span",{class:"line"})])])],-1),us=s("h2",{id:"_6-\u7EC3\u4E60\u9898",tabindex:"-1"},[l("6.\u7EC3\u4E60\u9898 "),s("a",{class:"header-anchor",href:"#_6-\u7EC3\u4E60\u9898","aria-hidden":"true"},"#")],-1),bs=s("p",null,"1\u3001\u5C01\u638910.0.0.7",-1),Ps=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I "),s("span",{style:{color:"#FFCB6B"}},"INPUT"),s("span",{style:{color:"#A6ACCD"}}," -s 10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"7"),s("span",{style:{color:"#A6ACCD"}}," -j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),Ts=s("p",null,"2\u3001\u8BA910.0.0.7\u548CSSH\u5BA2\u6237\u7AEF\uFF0810.0.0.1\uFF09\u670D\u52A1\u5668\u53EF\u4EE5Ping\uFF0C\u5176\u5B83\u7684\u4E0D\u80FDPing",-1),gs=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I "),s("span",{style:{color:"#FFCB6B"}},"INPUT"),s("span",{style:{color:"#A6ACCD"}}," -p icmp --icmp-type 8 -s 10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"7"),s("span",{style:{color:"#A6ACCD"}}," -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I "),s("span",{style:{color:"#FFCB6B"}},"INPUT"),s("span",{style:{color:"#A6ACCD"}}," 2 -p icmp ! -s 10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#A6ACCD"}}," --icmp-type 8 -j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),ms=s("p",null,"3\u3001\u5C01\u63893306\u7AEF\u53E3",-1),Bs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -I INPUT -p tcp --dport 3306 -j DROP")]),l(`
`),s("span",{class:"line"})])])],-1),Is=s("h1",{id:"\u7B2C8\u7AE0-iptables\u4F01\u4E1A\u6848\u4F8B",tabindex:"-1"},[l("\u7B2C8\u7AE0 iptables\u4F01\u4E1A\u6848\u4F8B "),s("a",{class:"header-anchor",href:"#\u7B2C8\u7AE0-iptables\u4F01\u4E1A\u6848\u4F8B","aria-hidden":"true"},"#")],-1),fs=s("h2",{id:"_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899",tabindex:"-1"},[l("1.\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899 "),s("a",{class:"header-anchor",href:"#_1-\u90E8\u7F72\u4E00\u4E2A\u5B89\u5168\u7684\u9632\u706B\u5899","aria-hidden":"true"},"#")],-1),Es=s("p",null,"\u4E24\u79CD\u601D\u60F3\uFF1A\u9488\u5BF9\u9ED8\u8BA4\u89C4\u5219\u800C\u8A00\u3002 \u901B\u516C\u56ED\uFF1A\u9ED1\u540D\u5355 1\u3001\u9ED8\u8BA4\u89C4\u5219\u9ED8\u8BA4\u662F\u5141\u8BB8\u7684\u72B6\u6001\u3002 \u770B\u7535\u5F71\uFF1A\u767D\u540D\u5355 2\u3001\u9ED8\u8BA4\u89C4\u5219\u9ED8\u8BA4\u662F\u4E0D\u5141\u8BB8\u7684\u72B6\u6001\u3002\u66F4\u5B89\u5168\u3002 \u770B\u7535\u5F71\u7684\u601D\u60F3\u66F4\u5B89\u5168\u3002 \u5B9E\u6218\u90E8\u7F72\uFF1A",-1),Ns=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"F")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"X")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"Z")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p tcp "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"m multiport "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"dport "),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#F78C6C"}},"443"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p tcp "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"dport "),s("span",{style:{color:"#F78C6C"}},"22"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"s 10.0.0.0"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#F78C6C"}},"24"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"s 172.16.1.0"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#F78C6C"}},"24"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"A INPUT "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"i lo "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"P INPUT DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"P FORWARD DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"P OUTPUT ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@m01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# iptables "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"nL")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"Chain"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"INPUT"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"policy"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DROP"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt source               destination         ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            multiport dports 80,443")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:22")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ACCEPT     all  --  10.0.0.0/24          0.0.0.0/0           ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ACCEPT     all  --  172.16.1.0/24        0.0.0.0/0           ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain FORWARD "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"policy"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"DROP"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt source               destination         ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain OUTPUT "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"policy"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt source               destination  ")]),l(`
`),s("span",{class:"line"})])])],-1),vs=s("p",null,"\u547D\u4EE4\u96C6\u5408\uFF1A",-1),Rs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -F")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -X")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -Z")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp -m multiport --dport 80,443 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp --dport 22 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -s 10.0.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -s 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -i lo -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P INPUT DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P FORWARD DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P OUTPUT ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -nL")]),l(`
`),s("span",{class:"line"})])])],-1),Os=s("h2",{id:"_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51",tabindex:"-1"},[l("2.\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51 "),s("a",{class:"header-anchor",href:"#_2-\u5C40\u57DF\u7F51\u5171\u4EAB\u4E0A\u7F51","aria-hidden":"true"},"#")],-1),Us=s("p",null,"\u5B9E\u9A8C\u73AF\u5883\uFF1A m01: \u5171\u4EAB\u4E0A\u7F51\u7F51\u5173\u51FA\u53E3 web01: \u53EA\u6709\u5185\u7F51\u5730\u5740\uFF0C\u7F51\u5173\u6307\u5411m01 \u5B9E\u9A8C\u6B65\u9AA4\uFF1A m01\u64CD\u4F5C",-1),js=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -t nat -A POSTROUTING -s 172.16.1.0/24 -j SNAT --to-source 10.0.0.61")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"net.ipv4.ip_forward = 1"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">>"),s("span",{style:{color:"#A6ACCD"}}," /etc/sysctl.conf")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sysctl -p")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -F")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -X")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -Z")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp -m multiport --dport 80,443 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -p tcp --dport 22 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -s 10.0.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -s 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A INPUT -i lo -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P INPUT DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P FORWARD DROP")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -P OUTPUT ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A FORWARD -i eth1 -s 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A FORWARD -o eth0 -s 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A FORWARD -i eth0 -d 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -A FORWARD -o eth1 -d 172.16.1.0/24 -j ACCEPT")]),l(`
`),s("span",{class:"line"})])])],-1),ks=s("p",null,"web01\u64CD\u4F5C\uFF1A",-1),ws=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# cat "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"etc"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"sysconfig"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"network"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"scripts"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"ifcfg"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"eth0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"TYPE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"Ethernet")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"BOOTPROTO"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"none")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DEFROUTE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"yes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"eth0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DEVICE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"eth0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ONBOOT"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"no")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IPADDR"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"10.0.0.7")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"PREFIX"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"24")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"GATEWAY"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"10.0.0.2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DNS1"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"10.0.0.2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# cat "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"etc"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"sysconfig"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"network"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"scripts"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"ifcfg"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"eth1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"TYPE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"Ethernet")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"BOOTPROTO"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"none")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DEFROUTE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"yes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"eth1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DEVICE"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"eth1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ONBOOT"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"yes")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IPADDR"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"172.16.1.7")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"GATEWAY"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"172.16.1.61")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"PREFIX"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"24")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DNS1"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}},"10.0.0.2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# systemctl restart network ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# ip r")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"default via 172.16.1.61 dev eth1  proto "),s("span",{style:{color:"#C792EA"}},"static"),s("span",{style:{color:"#A6ACCD"}},"  metric "),s("span",{style:{color:"#F78C6C"}},"100"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"172.16.1.0"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#F78C6C"}},"24"),s("span",{style:{color:"#A6ACCD"}}," dev eth1  proto kernel  scope link  src 172.16.1.7  metric "),s("span",{style:{color:"#F78C6C"}},"100"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# cat "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"etc"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"resolv"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"conf    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nameserver 10.0.1.2")]),l(`
`),s("span",{class:"line"})])])],-1),xs=s("p",null,"web01\u6D4B\u8BD5\u8BBF\u95EE\u5916\u7F51\uFF1A",-1),Ws=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# ping www"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"baidu"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"com")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"PING"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"www"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"a"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"shifen"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"com"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"14.215.177.39"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," 56"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"84"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}}," bytes of data.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"64 bytes from 14.215.177.39: icmp_seq=1 ttl=127 time=7.70 ms")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"64 bytes from 14.215.177.39: icmp_seq=2 ttl=127 time=8.92 ms")]),l(`
`),s("span",{class:"line"})])])],-1),Ls=s("h2",{id:"_3-\u7AEF\u53E3\u6620\u5C04",tabindex:"-1"},[l("3.\u7AEF\u53E3\u6620\u5C04 "),s("a",{class:"header-anchor",href:"#_3-\u7AEF\u53E3\u6620\u5C04","aria-hidden":"true"},"#")],-1),Ss=s("p",null,"m01\u64CD\u4F5C\uFF1A",-1),Gs=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"iptables -t nat -A PREROUTING -d 10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"61"),s("span",{style:{color:"#A6ACCD"}}," -p tcp --dport 9000 -j DNAT --to-destination 172"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"16"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"7"),s("span",{style:{color:"#A6ACCD"}},":22")]),l(`
`),s("span",{class:"line"})])])],-1),$s=s("p",null,"\u547D\u4EE4\u62C6\u89E3\uFF1A",-1),Ms=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u8868\uFF1Anat")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u94FE\uFF1APREROUTING")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u76EE\u6807IP\uFF1A10"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"61")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u76EE\u6807\u7AEF\u53E3\uFF1A9000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u534F\u8BAE\uFF1Atcp")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u52A8\u4F5C\uFF1ADNAT")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u76EE\u6807IP\uFF1A172"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"16"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"7")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u76EE\u6807\u7AEF\u53E3\uFF1A22")]),l(`
`),s("span",{class:"line"})])])],-1),Vs=s("p",null,"\u8BBF\u95EE\u6D4B\u8BD5:",-1),Xs=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"zhangyadeMacBook"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#FFCB6B"}},"Pro"),s("span",{style:{color:"#89DDFF"}},":~"),s("span",{style:{color:"#A6ACCD"}}," zhangya$ ssh root@10.0.1.61 "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"p "),s("span",{style:{color:"#F78C6C"}},"9000")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@10.0.1.61"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"s password:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Last "),s("span",{style:{color:"#FFCB6B"}},"login"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," Tue Aug "),s("span",{style:{color:"#F78C6C"}},"20"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"09"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"38"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"42"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2019"),s("span",{style:{color:"#A6ACCD"}}," from 172.16.1.51")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"#")]),l(`
`),s("span",{class:"line"})])])],-1),Zs=s("h2",{id:"_4-ip\u6620\u5C04",tabindex:"-1"},[l("4.IP\u6620\u5C04 "),s("a",{class:"header-anchor",href:"#_4-ip\u6620\u5C04","aria-hidden":"true"},"#")],-1),Js=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@m01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95"}},"# ip a add 10.0.1.62/24 dev eth0 label eth0:0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@m01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95"}},"# iptables -t nat -A PREROUTING -d 10.0.1.62 -j DNAT --to-destination 172.16.1.7")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@m01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95"}},"# iptables -nL -t nat")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain PREROUTING "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DNAT       tcp  --  0.0.0.0/0            10.0.1.61            tcp dpt:9000 to:172.16.1.7:22")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"DNAT       all  --  0.0.0.0/0            10.0.1.62            to:172.16.1.7")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain INPUT "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain OUTPUT "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Chain POSTROUTING "),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"policy ACCEPT"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"target     prot opt "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}},"               destination         ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"SNAT       all  --  172.16.1.0/24        0.0.0.0/0            to:10.0.1.61")]),l(`
`),s("span",{class:"line"})])])],-1),zs=s("p",null,"\u6D4B\u8BD5\u8BBF\u95EE\uFF1A",-1),Ys=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"zhangyadeMacBook"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#FFCB6B"}},"Pro"),s("span",{style:{color:"#89DDFF"}},":~"),s("span",{style:{color:"#A6ACCD"}}," zhangya$ ssh root@10.0.1.62")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"root@10.0.1.62"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"s password:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Last "),s("span",{style:{color:"#FFCB6B"}},"login"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," Wed Aug "),s("span",{style:{color:"#F78C6C"}},"21"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"13"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"30"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"04"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"2019"),s("span",{style:{color:"#A6ACCD"}}," from 10.0.1.1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# hostname")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"web01")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@web01"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"#")]),l(`
`),s("span",{class:"line"})])])],-1),Hs=s("h1",{id:"\u7B2C9\u7AE0-iptables\u89C4\u5219\u4FDD\u5B58",tabindex:"-1"},[l("\u7B2C9\u7AE0 iptables\u89C4\u5219\u4FDD\u5B58 "),s("a",{class:"header-anchor",href:"#\u7B2C9\u7AE0-iptables\u89C4\u5219\u4FDD\u5B58","aria-hidden":"true"},"#")],-1),qs=s("p",null,"iptables-save > 20190821 #\u5C06\u9632\u706B\u5899\u89C4\u5219\u4FDD\u5B58\u5230\u6587\u4EF6\u4E2D iptables-save #\u5C06\u9632\u706B\u5899\u89C4\u5219\u4FDD\u5B58\u5230\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u9632\u6B62\u91CD\u542F\u540E\u5931\u6548 iptables-restore < 20190821 #\u4ECE\u914D\u7F6E\u6587\u4EF6\u91CC\u8F7D\u5165\u9632\u706B\u5899\u914D\u7F6E",-1),Ks=s("h1",{id:"\u7B2C10\u7AE0-iptables\u9632\u5751\u6307\u5357",tabindex:"-1"},[l("\u7B2C10\u7AE0 iptables\u9632\u5751\u6307\u5357 "),s("a",{class:"header-anchor",href:"#\u7B2C10\u7AE0-iptables\u9632\u5751\u6307\u5357","aria-hidden":"true"},"#")],-1),Qs=s("p",null,"1.\u4FEE\u6539\u4E4B\u524D\u5148\u5BFC\u51FA\u5907\u4EFD\u4E00\u4EFD 2.\u4FEE\u6539\u7684\u65F6\u5019\u5C0F\u5FC3\u522B\u628A\u81EA\u5DF1\u5173\u5728\u5916\u9762 3.\u53EF\u4EE5\u73B0\u5728\u5B9A\u65F6\u4EFB\u52A1\u91CC\u6DFB\u52A0\u4E00\u6761\u5B9A\u65F6\u6E05\u7A7A\u7684\u89C4\u5219\uFF0C\u7B49\u6D4B\u8BD5\u6CA1\u95EE\u9898\u518D\u53D6\u6D88\u5B9A\u65F6\u4EFB\u52A1",-1),sl=s("h1",{id:"\u7B2C11\u7AE0-\u8BFE\u5802\u7B14\u8BB0",tabindex:"-1"},[l("\u7B2C11\u7AE0 \u8BFE\u5802\u7B14\u8BB0 "),s("a",{class:"header-anchor",href:"#\u7B2C11\u7AE0-\u8BFE\u5802\u7B14\u8BB0","aria-hidden":"true"},"#")],-1),ll=s("p",null,"1.\u4ECE\u4E0A\u5F80\u4E0B\u4F9D\u6B21\u5339\u914D 2.\u4E00\u4F46\u5339\u914D\u4E0A,\u5C31\u4E0D\u5728\u5F80\u4E0B\u5339\u914D\u4E86 3.\u9ED8\u8BA4\u89C4\u5219,\u9ED8\u8BA4\u7684\u60C5\u51B5,\u9ED8\u8BA4\u89C4\u5219\u662F\u653E\u884C\u6240\u6709",-1),ol=s("p",null,"-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT",-1),el=s("p",null,"-A INPUT :\u628A\u8FD9\u6761\u89C4\u5219\u6DFB\u52A0\u5230INPUT\u94FE\u7684\u6700\u540E\u4E00\u884C -p tcp :\u6307\u5B9A\u534F\u8BAE\u4E3Atcp -m state --state NEW :\u5339\u914DTCP\u7684\u8FDE\u63A5\u72B6\u6001 -m tcp --dport 22 :\u5339\u914DTCP\u534F\u8BAE\u7684\u76EE\u6807\u7AEF\u53E3 -j ACCEPT :\u6267\u884C\u52A8\u4F5C \u653E\u884C",-1),nl=s("p",null,"iptables A INPUT -p tcp -m state --dport 22 -j DROP \u7981\u6B62\u4E00\u4E2A\u6570\u636E\u5305: tcp\u534F\u8BAE \u8BBF\u95EE\u7684\u7AEF\u53E3\u662F22",-1),al=s("p",null,"iptables -A INPUT -p tcp --dport 22 -j DROP iptables -nL iptables -nL --line-numbers iptables -D INPUT 1",-1),tl=s("p",null,"\u7981\u6B62\u6E90\u5730\u5740\u662F10.0.0.7\u7684\u4E3B\u673A\u8BBF\u95EE22\u7AEF\u53E3 iptables -A INPUT -p tcp -s 10.0.0.7 --dport 22 -j DROP",-1),pl=s("p",null,"\u7981\u6B62\u6E90\u5730\u5740\u662F10.0.0.7\u7684\u4E3B\u673A\u8BBF\u95EE\u4EFB\u4F55\u7AEF\u53E3 iptables -A INPUT -p tcp -s 10.0.0.7 -j DROP",-1),cl=s("p",null,"\u7981\u6B62\u6E90\u5730\u5740\u662F10.0.0.8\u7684\u4E3B\u673A\u8BBF\u95EE80\u7AEF\u53E3 iptables -A INPUT -p tcp -s 10.0.0.8 --dport 80 -j DROP",-1),rl=s("p",null,"\u7981\u6B62\u9664\u4E8610.0.0.7\u4EE5\u5916\u7684\u5730\u5740\u8BBF\u95EE80\u7AEF\u53E3 iptables -A INPUT -p tcp ! -s 10.0.0.7 --dport 80 -j DROP",-1),il=s("p",null,"2\u6761\u89C4\u5219\u51B2\u7A81,\u4F1A\u4EE5\u8C01\u5148\u8C01\u4E3A\u51C6 iptables -I INPUT -p tcp -s 10.0.0.7 --dport 22 -j ACCEPT iptables -I INPUT -p tcp -s 10.0.0.7 --dport 22 -j DROP",-1),Cl=s("p",null,"\u7981\u6B6210.0.0.7\u8BBF\u95EE22\u548C80\u7AEF\u53E3 iptables -I INPUT -p tcp -s 10.0.0.7 -m multiport --dport 22,80 -j DROP",-1),Al=s("p",null,"\u7981\u6B6210.0.0.7\u8BBF\u95EE22\u5230100\u4E4B\u95F4\u7684\u6240\u6709\u7AEF\u53E3 iptables -A INPUT -p tcp -s 10.0.0.7 --dport 22:100 -j DROP",-1),Dl=s("p",null,"\u7981\u6B62\u6240\u6709\u4E3B\u673Aping iptables -A INPUT -p icmp --icmp-type 8 -j DROP",-1),yl=s("p",null,"\u653E\u884C10.0.0.7\u53EF\u4EE5ping iptables -I INPUT 2 -p icmp --icmp-type 8 -s 10.0.0.7 -j ACCEPT",-1),Fl=s("p",null,"\u53EA\u5141\u8BB810.0.0.7\u53EF\u4EE5ping ACCEPT icmp -- 10.0.0.7 0.0.0.0/0 icmptype 8 DROP icmp -- 0.0.0.0/0 0.0.0.0/0 icmptype 8",-1),dl=s("p",null,"\u7B49\u540C\u4E8E\u4E0A\u4E00\u6761,\u4F18\u5316\u7248,\u53EA\u8981\u4E0D\u662F10.0.0.7\u5C31\u4E0D\u5141\u8BB8ping iptables -I INPUT -p icmp --icmp-type 8 ! -s 10.0.0.7 -j DROP",-1),_l=s("p",null,"\u4F18\u5148\u7EA7: \u5339\u914D\u9891\u6B21\u6700\u9AD8\u7684\u6761\u4EF6\u653E\u524D\u9762",-1),hl=s("p",null,"100\u6B21 80 90 22 10",-1),ul=s("p",null,"\u5B89\u5168\u7B56\u7565: \u4E00\u79CD\u662F\u5E7F\u573A\u4E0A\u5DE1\u903B\u7684\u4EBA,\u9ED8\u8BA4\u8BA4\u4E3A\u5927\u5BB6\u90FD\u662F\u5B89\u5168\u7684,\u53EA\u6709\u901A\u7F09\u4EE4\u4E0A\u7684\u4EBA\u9700\u8981\u5173\u6CE8 \u4E00\u79CD\u662F\u706B\u8F66\u8FDB\u7AD9\u5B89\u68C0,\u9ED8\u8BA4\u6240\u6709\u4EBA\u90FD\u662F\u4E0D\u5B89\u5168\u7684,\u53EA\u6709\u6709\u7968\u7684\u4EBA\u624D\u653E\u884C",-1),bl=s("p",null,"iptables -F iptables -X iptables -Z iptables -A INPUT -p tcp -m multiport --dport 80,443 -j ACCEPT iptables -A INPUT -p tcp --dport 22 -j ACCEPT iptables -A INPUT -s 10.0.0.0/24 -j ACCEPT iptables -A INPUT -s 172.16.1.0/24 -j ACCEPT iptables -A INPUT -i lo -j ACCEPT iptables -P INPUT DROP iptables -P FORWARD DROP iptables -P OUTPUT ACCEPT iptables -nL",-1),Pl=s("p",null,"\u5171\u4EAB\u4E0A\u7F51 iptables -t nat -A POSTROUTING -s 172.16.1.0/24 -j SNAT --to-source 10.0.0.61",-1),Tl=s("p",null,"-t nat :NAT\u8868 -A POSTROUTING :POSTROUTING\u94FE -s 172.16.1.0/24 :\u6E90\u5730\u5740172.16.1.0/24 -j SNAT :SNAT \u6539\u5199\u6E90\u5730\u5740 --to-source 10.0.0.61 :\u5C06\u6E90\u5730\u5740\u6539\u5199\u621010.0.0.61",-1),gl=s("p",null,"172.16.1.7\u53D1\u7ED9\u767E\u5EA6\u7684\u6570\u636E\u5305\u683C\u5F0F \u6E90\u7AEF\u53E3: 80 \u76EE\u7684\u7AEF\u53E3: 80 \u6E90IP: 172.16.1.7 \u76EE\u7684IP: \u767E\u5EA6\u7684IP \u7F51\u5173: 172.16.1.61",-1),ml=s("p",null,"\u5982\u679C172.16.1.7\u60F3\u4E0A\u7F51,\u9700\u8981\u6539\u6210\u5982\u4E0B\u7684\u5305\u683C\u5F0F",-1),Bl=s("p",null,"10.0.0.61\u8BBF\u95EE\u767E\u5EA6 \u6E90\u7AEF\u53E3: 80 \u76EE\u7684\u7AEF\u53E3: 80 \u6E90IP: 10.0.0.61 \u76EE\u7684IP: \u767E\u5EA6\u7684IP \u7F51\u5173: 10.0.0.2",-1),Il=s("p",null,"\u5929\u5751 \u5982\u679C\u4F60\u7684\u9ED8\u8BA4\u89C4\u5219\u8BBE\u7F6E\u4E86\u62D2\u7EDD\u6240\u6709\uFF0C\u53C8\u6267\u884C\u4E86\u6E05\u9664\u89C4\u5219\u7684\u8BED\u53E5-F \u90A3\u5C31\u610F\u5473\u7740\uFF0C\u6240\u6709\u7684\u8BF7\u6C42\u5168\u90E8\u90FD\u62D2\u7EDD\u4E86 \u539F\u56E0\u662F-F\u4E0D\u4F1A\u6539\u53D8\u9ED8\u8BA4\u89C4\u5219",-1),fl=s("p",null,"[root@web01 ~]# iptables -nL Chain INPUT (policy DROP) target prot opt source destination",-1),El=s("p",null,"Chain FORWARD (policy DROP) target prot opt source destination",-1),Nl=s("p",null,"Chain OUTPUT (policy ACCEPT) target prot opt source destination",-1),vl=s("p",null,"\u89E3\u51B3\uFF1A \u7269\u7406\u673A\uFF1A 1.\u53BB\u673A\u623F\u81EA\u5DF1\u6E05\u7A7A 2.\u8BA9\u673A\u623F\u7684\u4EBA\u91CD\u542F\u670D\u52A1\u5668\uFF0C\u524D\u63D0\u6761\u4EF6\u662F\u89C4\u5219\u6CA1\u6709\u5199\u5165\u914D\u7F6E\u91CC \u4E91\u670D\u52A1\u5668\uFF1A \u76F4\u63A5\u901A\u8FC7\u63A7\u5236\u53F0\u6062\u590D",-1),Rl=s("p",null,"\u5982\u4F55\u907F\u514D\uFF1A 1.\u6D4B\u8BD5\u89C4\u5219\u4E4B\u524D\uFF0C\u5148\u5199\u4E2A\u5B9A\u65F6\u4EFB\u52A1\uFF0C\u6BCF\u96945\u5206\u949F\u91CD\u542F\u4E00\u6B21iptables",-1),Ol=s("p",null,"FORWARD\u94FE\u9ED8\u8BA4\u4E3ADROP\u7684\u65F6\u5019\u5171\u4EAB\u4E0A\u7F51\u5931\u6548 \u89E3\u51B3\u65B9\u6CD5\uFF1A \u7B2C\u4E00\u79CD\uFF0C\u6DFB\u52A02\u6761\u89C4\u5219 iptables -A FORWARD -s 172.16.1.0/24 -j ACCEPT iptables -A FORWARD -d 172.16.1.0/24 -j ACCEPT \u7B2C\u4E8C\u79CD\uFF1A\u4FEE\u6539FORWARD\u94FE\u9ED8\u8BA4\u89C4\u5219\u4E3AACCEPT iptables -P FORWARD ACCEPT",-1),Ul=s("p",null,"\u7AEF\u53E3\u6620\u5C04\uFF1A \u8BBF\u95EE10.0.0.61\u76849000\u7AEF\u53E3\uFF0C\u8DF3\u8F6C\u5230172.16.1.7\u768422\u7AEF\u53E3",-1),jl=s("p",null,"\u8BBF\u95EE10.0.0.61\u76849000\u7AEF\u53E3\u7684\u6570\u636E\u5305\u683C\u5F0F \u6E90\u7AEF\u53E3: 9000 \u76EE\u7684\u7AEF\u53E3: 9000 \u6E90IP: 10.0.0.1 \u76EE\u7684IP: 10.0.0.61",-1),kl=s("p",null,"\u6E90\u7AEF\u53E3: 22 \u76EE\u7684\u7AEF\u53E3: 22 \u6E90IP: 10.0.0.1 \u76EE\u7684IP: 172.16.1.7:22",-1),wl=s("p",null,"iptables -t nat -A PREROUTING -d 10.0.0.61 -p tcp --dport 9000 -j DNAT --to-destination 172.16.1.7:22 \u6CE8\u610F\uFF1A \u6539\u5199\u6570\u636E\u5305\u7684\u76EE\u6807IP\u548C\u7AEF\u53E3 \u7528\u5230\u7684\u662FPREROUTING\u94FE",-1),xl=s("p",null,"IP\u6620\u5C04\uFF1A ip a add 10.0.1.62/24 dev eth0 label eth0:0 iptables -t nat -A PREROUTING -d 10.0.1.62 -j DNAT --to-destination 172.16.1.7",-1),Wl=s("p",null,"\u4FDD\u5B58\u547D\u4EE4\uFF1A iptables-save iptables-save > iptables_m01 iptables-restore < iptables_m01 iptables-save > /etc/sysconfig/iptables",-1),Ll=s("p",null,"\u6458\u5F55\u81EA\u5F20\u5BFC\u7B80\u4E66",-1);function Sl(e,Gl,$l,Ml,t,Vl){const p=c;return C(),i(p,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":o(()=>[y,F,d,_,h,u,b,P,T,g,m,B,I,f,E,N,v,R,O,U,j,k,w,x,W,L,S,G,$,M,V,X,Z,J,z,Y,H,q,K,Q,ss,ls,os,es,ns,as,ts,ps,cs,rs,is,Cs,As,Ds,ys,Fs,ds,_s,hs,us,bs,Ps,Ts,gs,ms,Bs,Is,fs,Es,Ns,vs,Rs,Os,Us,js,ks,ws,xs,Ws,Ls,Ss,Gs,$s,Ms,Vs,Xs,Zs,Js,zs,Ys,Hs,qs,Ks,Qs,sl,ll,ol,el,nl,al,tl,pl,cl,rl,il,Cl,Al,Dl,yl,Fl,dl,_l,hl,ul,bl,Pl,Tl,gl,ml,Bl,Il,fl,El,Nl,vl,Rl,Ol,Ul,jl,kl,wl,xl,Wl,Ll]),"main-header":o(()=>[n(e.$slots,"main-header")]),"main-header-after":o(()=>[n(e.$slots,"main-header-after")]),"main-nav":o(()=>[n(e.$slots,"main-nav")]),"main-content":o(()=>[n(e.$slots,"main-content")]),"main-content-after":o(()=>[n(e.$slots,"main-content-after")]),"main-nav-before":o(()=>[n(e.$slots,"main-nav-before")]),"main-nav-after":o(()=>[n(e.$slots,"main-nav-after")]),comment:o(()=>[n(e.$slots,"comment")]),footer:o(()=>[n(e.$slots,"footer")]),aside:o(()=>[n(e.$slots,"aside")]),"aside-custom":o(()=>[n(e.$slots,"aside-custom")]),default:o(()=>[n(e.$slots,"default")]),_:3},8,["frontmatter","data"])}const ql=r(D,[["render",Sl]]);export{Hl as __pageData,ql as default};
