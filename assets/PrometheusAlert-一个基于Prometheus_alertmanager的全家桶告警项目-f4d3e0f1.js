import{_ as D}from"./ValaxyMain.vue_vue_type_style_index_0_lang-32fe0dc4.js";import{_ as y,c as F,w as o,o as i,b as s,U as l,q as e,r as t,W as C,p as A}from"./app-7a2d4758.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-f3ded1dd.js";import"./YunCard.vue_vue_type_style_index_0_lang-395ab441.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-b27293b7.js";const Gs=JSON.parse('{"title":"PrometheusAlert 一个基于Prometheus_alertmanager的全家桶告警项目","description":"","frontmatter":{"title":"PrometheusAlert 一个基于Prometheus_alertmanager的全家桶告警项目","categories":"Prometheus","tags":["PrometheusAlert"],"date":"2021-01-13T14:30:00.000Z"},"headers":[{"level":2,"title":"部署","slug":"部署","link":"#部署","children":[{"level":3,"title":"安装部署PrometheusAlert","slug":"安装部署prometheusalert","link":"#安装部署prometheusalert","children":[]},{"level":3,"title":"配置","slug":"配置","link":"#配置","children":[]},{"level":3,"title":"告警规则编写","slug":"告警规则编写","link":"#告警规则编写","children":[]}]},{"level":2,"title":"扩展功能 PrometheusAlert高级自定义消息模版","slug":"扩展功能-prometheusalert高级自定义消息模版","link":"#扩展功能-prometheusalert高级自定义消息模版","children":[{"level":3,"title":"部署配置","slug":"部署配置","link":"#部署配置","children":[]},{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}]}],"relativePath":"pages/posts/PrometheusAlert-一个基于Prometheus_alertmanager的全家桶告警项目.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/PrometheusAlert-一个基于Prometheus_alertmanager的全家桶告警项目.md","lastUpdated":1673338869000}'),c=JSON.parse('{"title":"PrometheusAlert 一个基于Prometheus_alertmanager的全家桶告警项目","description":"","frontmatter":{"title":"PrometheusAlert 一个基于Prometheus_alertmanager的全家桶告警项目","categories":"Prometheus","tags":["PrometheusAlert"],"date":"2021-01-13T14:30:00.000Z"},"headers":[{"level":2,"title":"部署","slug":"部署","link":"#部署","children":[{"level":3,"title":"安装部署PrometheusAlert","slug":"安装部署prometheusalert","link":"#安装部署prometheusalert","children":[]},{"level":3,"title":"配置","slug":"配置","link":"#配置","children":[]},{"level":3,"title":"告警规则编写","slug":"告警规则编写","link":"#告警规则编写","children":[]}]},{"level":2,"title":"扩展功能 PrometheusAlert高级自定义消息模版","slug":"扩展功能-prometheusalert高级自定义消息模版","link":"#扩展功能-prometheusalert高级自定义消息模版","children":[{"level":3,"title":"部署配置","slug":"部署配置","link":"#部署配置","children":[]},{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}]}],"relativePath":"pages/posts/PrometheusAlert-一个基于Prometheus_alertmanager的全家桶告警项目.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/PrometheusAlert-一个基于Prometheus_alertmanager的全家桶告警项目.md","lastUpdated":1673338869000}'),h={name:"pages/posts/PrometheusAlert-一个基于Prometheus_alertmanager的全家桶告警项目.md",data(){return{data:c,frontmatter:c.frontmatter}},setup(){A("pageData",c)}},E={id:"prometheusalert-一个基于prometheus-alertmanager的全家桶告警项目",tabindex:"-1"},x=s("p",null,"Prometheus Alert是开源的运维告警中心消息转发系统,支持主流的监控系统Prometheus,Zabbix,日志系统Graylog和数据可视化系统Grafana发出的预警消息,支持钉钉,微信,华为云短信,腾讯云短信,腾讯云电话,阿里云短信,阿里云电话等",-1),u=s("p",null,[s("em",null,"PrometheusAlert可以部署在本地和云平台上，支持windows、linux、公有云、私有云、混合云、容器和kubernetes。你可以根据实际场景或需求，选择相应的方式来部署PrometheusAlert")],-1),d=s("p",null,[s("strong",null,"在这里优先采用Docker容器化部署.没有安装Docker的小伙伴,可以采取下面的方式一键安装Docker")],-1),m=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"curl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-fsSL"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"https://get.docker.com"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"bash"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-s"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--mirror"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"Al")]),l(`
`),s("span",{class:"line"})])])],-1),g={id:"部署",tabindex:"-1"},_=s("p",null,[s("em",null,"告警固然离不开数据的支撑,所以需提前部署好Prometheus以及alertmanager组件并且已经有相应的指标")],-1),f={id:"安装部署prometheusalert",tabindex:"-1"},v=s("p",null,[s("strong",null,"Clone项目源代码")],-1),b=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"git"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"clone"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"https://github.com/feiyu563/PrometheusAlert.git")]),l(`
`),s("span",{class:"line"})])])],-1),k=s("p",null,[s("strong",null,"创建项目配置文件")],-1),$=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"mkdir"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/etc/prometheusalert-center/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"cp"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"PrometheusAlert/conf/app.conf"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/etc/prometheusalert-center/")]),l(`
`),s("span",{class:"line"})])])],-1),w=s("p",null,[s("strong",null,"启动PrometheusAlert并挂载配置文件")],-1),P=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"run"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-d"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-p"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"8080"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#F78C6C"}},"8080"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-v"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/etc/prometheusalert-center:/app/conf"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--name"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"PrometheusAlert"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"feiyu563/prometheus-alert:latest")]),l(`
`),s("span",{class:"line"})])])],-1),B=s("p",null,[s("strong",null,"启动后可使用浏览器打开以下地址查看")],-1),T=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"http://127.0.0.1:8080")]),l(`
`),s("span",{class:"line"})])])],-1),R={id:"配置",tabindex:"-1"},L=s("p",null,[s("em",null,"这里贴出测试环境所使用配置文件,我使用的是企业微信机器人进行告警通知")],-1),S=s("p",null,[s("code",null,"机器人地址需在企业微信群内新建机器人才可得到地址,复制在默认配置项wxurl里就可以")],-1),I=s("p",null,'[collapse title="Prometheus-Alert-app.conf"]',-1),U=s("div",{class:"language-yaml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓全局配置-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"appname = PrometheusAlert")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#监听端口")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"httpport = 8080")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"runmode = dev")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#设置代理 proxy = http://123.123.123.123:8080")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"proxy =")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#开启JSON请求")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"copyrequestbody = true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#告警消息标题")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"title=PrometheusAlert")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#链接到告警平台地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"GraylogAlerturl=http://www.kococ.cn")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#钉钉告警 告警logo图标地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"logourl=https://raw.githubusercontent.com/feiyu563/PrometheusAlert/master/doc/alert-center.png")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#钉钉告警 恢复logo图标地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"rlogourl=https://raw.githubusercontent.com/feiyu563/PrometheusAlert/master/doc/alert-center.png")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#短信告警级别(等于3就进行短信告警) 告警级别定义 0 信息,1 警告,2 一般严重,3 严重,4 灾难")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"messagelevel=3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#电话告警级别(等于4就进行语音告警) 告警级别定义 0 信息,1 警告,2 一般严重,3 严重,4 灾难")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"phonecalllevel=4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#默认拨打号码(页面测试短信和电话功能需要配置此项)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"defaultphone=xxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#故障恢复是否启用电话通知0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"phonecallresolved=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#自动告警抑制(自动告警抑制是默认同一个告警源的告警信息只发送告警级别最高的第一条告警信息,其他消息默认屏蔽,这么做的目的是为了减少相同告警来源的消息数量,防止告警炸弹,0为关闭,1为开启)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"silent=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否前台输出file or console")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"logtype=file")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#日志文件路径")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"logpath=logs/prometheusalertcenter.log")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#转换Prometheus,graylog告警消息的时区为CST时区(如默认已经是CST时区，请勿开启)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"prometheus_cst_time=1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#数据库驱动，支持sqlite3，mysql,如使用mysql，请开启db_host,db_user,db_password,db_name的注释")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"db_driver=sqlite3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#db_host=127.0.0.1:3306")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#db_user=root")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#db_password=root")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#db_name=prometheusalert")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓webhook-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启钉钉告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-dingding=1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#默认钉钉机器人地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ddurl=https://oapi.dingtalk.com/robot/send?access_token=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启 @所有人(0为关闭,1为开启)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"dd_isatall=1")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启微信告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-weixin=1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#默认企业微信机器人地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"wxurl=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=e5f4************")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启飞书告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-feishu=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#默认飞书机器人地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"fsurl=https://open.feishu.cn/open-apis/bot/hook/xxxxxxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓腾讯云接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启腾讯云短信告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-txdx=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云短信接口key")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DX_appkey=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云短信模版ID 腾讯云短信模版配置可参考 prometheus告警:{1}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DX_tpl_id=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云短信sdk app id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DX_sdkappid=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云短信签名 根据自己审核通过的签名来填写")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DX_sign=腾讯云")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启腾讯云电话告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-txdh=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云电话接口key")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DH_phonecallappkey=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云电话模版ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DH_phonecalltpl_id=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#腾讯云电话sdk app id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TXY_DH_phonecallsdkappid=xxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓华为云接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启华为云短信告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-hwdx=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云短信接口key")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_APP_Key=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云短信接口Secret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_APP_Secret=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云APP接入地址(端口接口地址)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_APP_Url=https://rtcsms.cn-north-1.myhuaweicloud.com:10743")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云短信模板ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_Templateid=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云签名名称，必须是已审核通过的，与模板类型一致的签名名称,按照自己的实际签名填写")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_Signature=华为云")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#华为云签名通道号")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"HWY_DX_Sender=xxxxxxxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓阿里云接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启阿里云短信告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-alydx=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云短信主账号AccessKey的ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DX_AccessKeyId=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云短信接口密钥")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DX_AccessSecret=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云短信签名名称")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DX_SignName=阿里云")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云短信模板ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DX_Template=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启阿里云电话告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-alydh=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云电话主账号AccessKey的ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DH_AccessKeyId=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云电话接口密钥")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DH_AccessSecret=xxxxxxxxxxxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云电话被叫显号，必须是已购买的号码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DX_CalledShowNumber=xxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#阿里云电话文本转语音（TTS）模板ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"ALY_DH_TtsCode=xxxxxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓容联云接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启容联云电话告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"RLY_DH_open-rlydh=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#容联云基础接口地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"RLY_URL=https://app.cloopen.com:8883/2013-12-26/Accounts/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#容联云后台SID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"RLY_ACCOUNT_SID=xxxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#容联云api-token")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"RLY_ACCOUNT_TOKEN=xxxxxxxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#容联云app_id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"RLY_APP_ID=xxxxxxxxxxxxx")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓邮件配置-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启邮件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-email=1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#邮件发件服务器")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Email_host=smtp.88.com")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#邮件发件服务器端口")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Email_port=25")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#邮件帐号")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Email_user=ilinux@88.com")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#邮件密码")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Email_password=wunurj******")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#邮件标题")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Email_title=运维告警")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#默认发送邮箱")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"Default_emails=ilinux@111.com")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓七陌云接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启七陌短信告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-7moordx=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#七陌账户ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"7MOOR_ACCOUNT_ID=Nxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#七陌账户APISecret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"7MOOR_ACCOUNT_APISECRET=xxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#七陌账户短信模板编号")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"7MOOR_DX_TEMPLATENUM=n")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#注意：七陌短信变量这里只用一个var1，在代码里写死了。")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#-----------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启七陌webcall语音通知告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-7moordh=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#请在七陌平台添加虚拟服务号、文本节点")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#七陌账户webcall的虚拟服务号")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"7MOOR_WEBCALL_SERVICENO=xxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 文本节点里被替换的变量，我配置的是text。如果被替换的变量不是text，请修改此配置")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"7MOOR_WEBCALL_VOICE_VAR=text")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓telegram接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启telegram告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-tg=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#tg机器人token")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TG_TOKEN=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#tg消息模式 个人消息或者频道消息 0为关闭(推送给个人)，1为开启(推送给频道)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TG_MODE_CHAN=0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#tg用户ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TG_USERID=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#tg频道name")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"TG_CHANNAME=xxxxx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#tg api地址, 可以配置为代理地址")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},'#TG_API_PROXY="https://api.telegram.org/bot%s/%s"')]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#---------------------↓workwechat接口-----------------------")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#是否开启workwechat告警通道,可同时开始多个通道0为关闭,1为开启")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"open-workwechat=1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 企业ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"WorkWechat_CropID=wwbc6f*****")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 应用ID")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"WorkWechat_AgentID=1000****")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 应用secret")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"WorkWechat_AgentSecret=wlTGz8T9ETPCyxxtSHRs*****")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 接受用户")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},'WorkWechat_ToUser="liu***|Ze***"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 接受部门")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},'WorkWechat_ToParty="An***"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 接受标签")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},'WorkWechat_ToTag=""')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"# 消息类型, 暂时只支持markdown")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},'WorkWechat_Msgtype = "markdown"')]),l(`
`),s("span",{class:"line"})])])],-1),Y=s("p",null,"[/collapse]",-1),O={id:"更新alertmanager配置文件",tabindex:"-1"},X=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"cat"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/etc/alertmanager/config.yml"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"})])])],-1),W=s("p",null,'[collapse title="config.conf"]',-1),G=s("div",{class:"language-yaml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"global"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"resolve_timeout"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"5m")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"route"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"group_by"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"alertname"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"group_wait"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"30s")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"group_interval"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"10s")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"repeat_interval"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"30m"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"receiver"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"web.hook.prometheusalert"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"routes"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"receiver"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"prometheusalert-weixin"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"group_wait"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"10s")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"match"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"level"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"3"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"receiver"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"prometheusalert-weixinyingyong"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"group_wait"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"10s")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"match"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"level"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"4"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"receivers"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"web.hook.prometheusalert"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"webhook_configs"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"url"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"http://192.168.0.212:8080/prometheusalert?type=email&tpl=prometheus-email&email=ilinux@111.com"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"prometheusalert-weixin"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"webhook_configs"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"url"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"http://192.168.0.212:8080/prometheusalert?type=wx&tpl=prometheus-wx&wxurl=https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=e5f4c03c-9***********"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"prometheusalert-weixinyingyong"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"webhook_configs"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"url"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"http://192.168.0.212:8080/prometheusalert?type=workwechat&tpl=prometheus-wechatapp&wxuser=liuyongheng&wxparty=Andu"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"})])])],-1),q=s("p",null,"[/collapse]",-1),N={id:"告警规则编写",tabindex:"-1"},H=s("p",null,"例: 主机节点丢失",-1),M=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"cat"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/etc/prometheus/rules/node.yml"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"})])])],-1),z=s("div",{class:"language-yaml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"groups"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"exports.rules"),s("span",{style:{color:"#A6ACCD"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#F07178"}},"rules"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F07178"}},"alert"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"实例信息告警")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"expr"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"up == 0"),s("span",{style:{color:"#A6ACCD"}},"      ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"for"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"1m"),s("span",{style:{color:"#A6ACCD"}},"           ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"labels"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"          ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"severity"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"ERROR")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"level"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"4")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#F07178"}},"annotations"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"summary"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 {{ $labels.instance }} 信息丢失,疑似服务器失联或者关机"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      "),s("span",{style:{color:"#F07178"}},"description"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 {{ $labels.instance }} job 名为 {{ $labels.job }} 已经失联长达一分钟,请运维人员排查故障"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"})])])],-1),K=s("blockquote",null,[s("p",null,"这里提供一些已经适配的Prometheus告警规则，别谢我，往下滑有打赏按钮谢谢")],-1),V=s("blockquote",null,[s("p",null,"告警规则中serverity默认不被调用,PrometheusAlert默认使用的是level.含义为告警等级,是为了不同的告警等级分发给不同的告警平台准备的，算是抑制把，我也不知道 但是我们直接不使用全家桶的默认配置，我们直接使用自定义模板进行发送服务，上去直接整高级，奥里给 虽然这样我们已经可以使用了，但是为更高的定制化，我们还需要去设置全家桶告警模板。包括我们用到的企业微信机器人模板，企业微信应用模板，邮件模板")],-1),j={id:"告警通知模板",tabindex:"-1"},J=s("p",null,[s("strong",null,"企业微信机器人robot")],-1),Z=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," $var "),s("span",{style:{color:"#C3E88D"}},":="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},".externalURL}}{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"range"),s("span",{style:{color:"#A6ACCD"}}," $k"),s("span",{style:{color:"#C3E88D"}},","),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},":=.alerts"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"if eq $v.status"),s("span",{style:{color:"#89DDFF"}},' "'),s("span",{style:{color:"#C3E88D"}},"resolved"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"Prometheus恢复信息"),s("span",{style:{color:"#89DDFF"}},"]("),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">**["),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"]({{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"开始时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"结束时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".endsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"恢复主机IP:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},".labels.instance}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"**{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.recoverymessage"),s("span",{style:{color:"#89DDFF"}},"}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"else"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"Prometheus告警信息"),s("span",{style:{color:"#89DDFF"}},"]("),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">**["),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"]({{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警级别: "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.severity"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"开始时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"故障主机IP:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},".labels.instance}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"**{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.description"),s("span",{style:{color:"#89DDFF"}},"}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"end"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," end "),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"})])])],-1),Q=s("p",null,[s("strong",null,"企业微信应用")],-1),ss=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," $var "),s("span",{style:{color:"#C3E88D"}},":="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},".externalURL}}{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"range"),s("span",{style:{color:"#A6ACCD"}}," $k"),s("span",{style:{color:"#C3E88D"}},","),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},":=.alerts"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"if eq $v.status"),s("span",{style:{color:"#89DDFF"}},' "'),s("span",{style:{color:"#C3E88D"}},"resolved"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"Prometheus恢复信息"),s("span",{style:{color:"#89DDFF"}},"]("),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">**["),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"]({{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"开始时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"结束时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".endsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"恢复主机:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},".labels.instance}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"**{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.recoverymessage"),s("span",{style:{color:"#89DDFF"}},"}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"else"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"Prometheus告警信息"),s("span",{style:{color:"#89DDFF"}},"]("),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">**["),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"]({{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警级别: "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.severity"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"开始时间:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"故障主机:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},".labels.instance}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"**{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.description"),s("span",{style:{color:"#89DDFF"}},"}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"end"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," end "),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"})])])],-1),ls=s("p",null,[s("strong",null,"邮件正儿八经模板")],-1),os=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," $var "),s("span",{style:{color:"#C3E88D"}},":="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},".externalURL}}{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"range"),s("span",{style:{color:"#A6ACCD"}}," $k"),s("span",{style:{color:"#C3E88D"}},","),s("span",{style:{color:"#A6ACCD"}},"$v"),s("span",{style:{color:"#C3E88D"}},":=.alerts"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"if eq $v.status"),s("span",{style:{color:"#89DDFF"}},' "'),s("span",{style:{color:"#C3E88D"}},"resolved"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h1><a href ="),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL"),s("span",{style:{color:"#89DDFF"}},"}}>"),s("span",{style:{color:"#A6ACCD"}},"海外卡片怪兽监控告警"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"/a></h"),s("span",{style:{color:"#89DDFF"}},"1>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h2><a href ="),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}}>{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.alertname"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/a></h"),s("span",{style:{color:"#89DDFF"}},"2>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"告警级别："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.level"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"告警程度："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.severity"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"开始时间："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#FFCB6B"}},"GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C3E88D"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"结束时间："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#FFCB6B"}},"GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".endsAt}}"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C3E88D"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"故障主机IP："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.instance"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"3>{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.recoverymessage"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"3>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"else"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h1><a href ="),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.generatorURL"),s("span",{style:{color:"#89DDFF"}},"}}>"),s("span",{style:{color:"#A6ACCD"}},"海外卡片怪兽监控告警"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"/a></h"),s("span",{style:{color:"#89DDFF"}},"1>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h2><a href ="),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$var"),s("span",{style:{color:"#89DDFF"}},"}}>{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.alertname"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/a></h"),s("span",{style:{color:"#89DDFF"}},"2>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"告警级别："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.level"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"告警程度："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.severity"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"开始时间："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#FFCB6B"}},"GetCSTtime"),s("span",{style:{color:"#A6ACCD"}}," $v"),s("span",{style:{color:"#C3E88D"}},".startsAt}}"),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#C3E88D"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"5>"),s("span",{style:{color:"#A6ACCD"}},"故障主机IP："),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"$v.labels.instance"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"5>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#A6ACCD"}},"h"),s("span",{style:{color:"#89DDFF"}},"3>{{"),s("span",{style:{color:"#A6ACCD"}},"$v.annotations.description"),s("span",{style:{color:"#89DDFF"}},"}}<"),s("span",{style:{color:"#A6ACCD"}},"/h"),s("span",{style:{color:"#89DDFF"}},"3>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}},"end"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," end "),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"})])])],-1),ns=s("p",null,[s("strong",null,"邮件花里胡哨模板")],-1),es=s("div",{class:"language-html"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"html"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"meta"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"charset"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"utf-8"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"position:relative;width:450px;height:auto;margin:0 auto;padding-bottom:5px;border:rgb(224, 221, 224) solid 1px;border-radius:10px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"background-image:url(https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/gitee-backup/img-master/image/1-1.jpg);width:100%;height:300px;background-size:cover;background-repeat:no-repeat;border-radius:10px 10px 0px 0px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"width:40%;height:40px;background-color:rgb(231, 145, 145);margin-top:-20px;margin-left:20px;color:#fff;text-align:center;line-height:40px;border-radius:30px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        亲爱的：运维同学！")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"line-height:180%;padding:0 15px 12px;width:90%;margin:auto;margin-bottom:0px;font-size:12px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"border-bottom:1px solid rgb(216, 213, 213);font-size:13px;margin:10px 0px;padding:10px 0px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"span"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"color:#12ADDB;font-weight:bold"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"&gt;&nbsp;"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"span"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"span"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"您有一条新的告警信息！"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"span"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"            "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"text-decoration:none;color:#12ADDB;font-weight:bold;"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"{$comment->permalink}"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"target"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"_blank"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"{{ $var := .externalURL}}{{ range $k,$v:=.alerts }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'{{if eq $v.status "resolved"}}')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h1"),s("span",{style:{color:"#89DDFF"}},"><"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}}," ="),s("span",{style:{color:"#C3E88D"}},"{{$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"北青服务器告警信息"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#F07178"}},"h1"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h2"),s("span",{style:{color:"#89DDFF"}},"><"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}}," ="),s("span",{style:{color:"#C3E88D"}},"{{$var}}"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#F07178"}},"h2"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警级别：{{$v.labels.level}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警程度：{{$v.labels.severity}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"开始时间：{{GetCSTtime $v.startsAt}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"结束时间：{{GetCSTtime $v.endsAt}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"故障主机IP：{{$v.labels.instance}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h3"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"{{$v.annotations.recoverymessage}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h3"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{{else}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h1"),s("span",{style:{color:"#89DDFF"}},"><"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}}," ="),s("span",{style:{color:"#C3E88D"}},"{{$v.generatorURL}}"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"北青服务器告警信息"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#F07178"}},"h1"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h2"),s("span",{style:{color:"#89DDFF"}},"><"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}}," ="),s("span",{style:{color:"#C3E88D"}},"{{$var}}"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"{{$v.labels.alertname}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},"></"),s("span",{style:{color:"#F07178"}},"h2"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警级别：{{$v.labels.level}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警程度：{{$v.labels.severity}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"开始时间：{{GetCSTtime $v.startsAt}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"故障主机IP：{{$v.labels.instance}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h5"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"h3"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"{{$v.annotations.description}}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"h3"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{{end}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{{ end }}"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"        "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"color:#8c8c8c;font-size:8px;width:93%;margin:auto;margin-top:-30px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"padding:20px;"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"                                 对生产环境要有一颗敬畏之心！"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"text-decoration:none;background-color:rgb(155, 151, 221);color:#FFF;width:40%;text-align:center;height:40px;line-height:40px;box-shadow:5px 5px 5px rgba(0,0,0,0.2);margin:-10px auto;display:block;border-radius:30px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"href"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"http://uc.kococ.cn:9090/"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"target"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"_blank"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"查看完整回复内容"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"a"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"color:#8c8c8c;font-size:8px;width:100%;text-align:center;margin-top:30px"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"本邮件为系统自动发送，请勿直接回复哦！"),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"style"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"color:#8c8c8c;font-size:8px;width:100%;text-align:center"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"Copyright © 北青永恒. All Rights Reserved."),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"p"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"div"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"html"),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"})])])],-1),as=s("blockquote",null,[s("p",null,"请注意如果您按照我的配置的话，请从头到尾都按照我的配置来，我这三个模板需要您打开并配置全家桶的三个告警模板,这些扩展功能我先用，至于设置我放在下面，请务必举一反三")],-1),ts=s("hr",null,null,-1),cs=s("p",null,[s("strong",null,'更新完以上配置后,默认就可以"开箱即用了",记得重启这三个服务')],-1),rs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"restart"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"prometheus"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"alertmanager"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"PrometheusAlert")]),l(`
`),s("span",{class:"line"})])])],-1),ps=s("p",null,[s("em",null,"更改后,alertmanager默认不再承担告警角色,它会转发到PrometheusAlert程序中")],-1),Ds=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"receiver"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"prometheusalert-weixinyingyong"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"status"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"resolved"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"alerts"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"status"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"resolved"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"labels"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"alertname"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"Agent状态"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"instance"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"192.168.0.212:8001"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"job"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"容器指标"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"level"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"4"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"severity"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"ERROR"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"},"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"annotations"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"description"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 Job 名为 容器指标 已经丢失信息长达一分钟,请相关运维介入"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"recoverymessage"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 已恢复正常监控"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"summary"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 监控信息告警"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"},"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"startsAt"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"2021-01-27T07:20:52.83520515Z"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"endsAt"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"2021-01-27T07:34:22.83520515Z"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"generatorURL"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"http://uc.kococ.cn:9090/graph?g0.expr=up+%3D%3D+0\\u0026g0.tab=1"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"fingerprint"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"3d737b721cd900a3"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},"}"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"groupLabels"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"alertname"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"Agent状态"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"commonLabels"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"alertname"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"Agent状态"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"instance"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"192.168.0.212:8001"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"job"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"容器指标"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"level"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"4"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"severity"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"ERROR"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"commonAnnotations"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"description"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 Job 名为 容器指标 已经丢失信息长达一分钟,请相关运维介入"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"recoverymessage"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 已恢复正常监控"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"summary"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"实例 192.168.0.212:8001 监控信息告警"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"externalURL"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"http://uc.kococ.cn:9090"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"version"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"4"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"groupKey"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"{}/{level="),s("span",{style:{color:"#A6ACCD"}},'\\"'),s("span",{style:{color:"#C3E88D"}},"4"),s("span",{style:{color:"#A6ACCD"}},'\\"'),s("span",{style:{color:"#C3E88D"}},"}:{alertname="),s("span",{style:{color:"#A6ACCD"}},'\\"'),s("span",{style:{color:"#C3E88D"}},"Agent状态"),s("span",{style:{color:"#A6ACCD"}},'\\"'),s("span",{style:{color:"#C3E88D"}},"}"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},","),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"truncatedAlerts"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"})])])],-1),ys={id:"扩展功能-prometheusalert高级自定义消息模版",tabindex:"-1"},Fs=s("p",null,[s("em",null,"在我的理解下,其实并不算是扩展功能.但凡你想使用自己的发信模板,哪怕你只想更改一丢丢默认的模板,那么你也需要学一下这个扩展功能.")],-1),is=s("p",null,[s("strong",null,"环境中使用企业微信机器人进行故障告警及故障恢复测试")],-1),Cs={id:"部署配置",tabindex:"-1"},As=s("p",null,[s("strong",null,"PrometheusAlert 配置")],-1),hs=s("p",null,[s("em",null,"点击模板编辑-")],-1),Es=s("p",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/image/image-20201130180052868.png",alt:"image-20201130180052868"})],-1),xs=s("p",null,"温馨提示: 企业微信告警分两种,一种是企业微信应用告警,一种是企业微信机器人告警.这里采用的是企业微信机器人告警.如需使用企业微信应用告警请自行摸索配置文件app.conf",-1),us=s("p",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/image/image-20201130180349108.png",alt:"image-20201130180349108"})],-1),ds=s("div",{class:"language-yaml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"$var := .externalURL"),s("span",{style:{color:"#89DDFF"}},"}}{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"range $k"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#C3E88D"}},"$v:=.alerts"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},'if eq $v.status "resolved"'),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#C3E88D"}},"Prometheus恢复信息"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#C3E88D"}},"($v.generatorURL}})")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},">"),s("span",{style:{color:"#A6ACCD"}},"**[{{$v.labels.alertname}}]({{$var}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"开始时间"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"$v.startsAt"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"结束时间"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"$v.endsAt"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"恢复主机IP"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"$v.labels.instance"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"*"),s("span",{style:{color:"#A6ACCD"}},"*{{$v.annotations.recoverymessage}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"else"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#C3E88D"}},"Prometheus告警信息"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#C3E88D"}},"($v.generatorURL}})")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},">"),s("span",{style:{color:"#A6ACCD"}},"**[{{$v.labels.alertname}}]({{$var}})**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},">"),s("span",{style:{color:"#A6ACCD"}},"告警级别: {{$v.labels.severity}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"开始时间"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"$v.startsAt"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"故障主机IP"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"$v.labels.instance"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"*"),s("span",{style:{color:"#A6ACCD"}},"*{{$v.annotations.description}}**")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#C3E88D"}},"end"),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"{{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"end"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"}}")]),l(`
`),s("span",{class:"line"})])])],-1),ms=s("p",null,"往下滑",-1),gs=s("p",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/image/image-20201130180530253.png",alt:"image-20201130180530253"})],-1),_s=s("p",null,[l("这里填入你在企业微信中新建的"),s("strong",null,"机器人地址"),l(",填写后点击"),s("strong",null,"保存模板")],-1),fs=s("p",null,"回到刚刚的界面复制路径",-1),vs=s("p",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/image/image-20201130180809297.png",alt:"image-20201130180809297"})],-1),bs=s("p",null,[l("将你复制的路径地址填写在config.yml文件中."),s("strong",null,"记得更换其中企业微信的地址")],-1),ks=s("p",null,[s("strong",null,"更新完以上配置后,重启这两个服务"),l("👎")],-1),$s=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"restart"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"alertmanager"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"PrometheusAlert")]),l(`
`),s("span",{class:"line"})])])],-1),ws=s("p",null,"关闭您的Job或者采集器,测试是否正常告警.",-1),Ps=s("p",null,"如果有错,请分析PrometheusAlert程序日志.或者直接百度.谢谢您的阅读",-1),Bs={id:"参考",tabindex:"-1"};function Ts(a,Rs,Ls,Ss,r,Is){const n=C,p=D;return i(),F(p,{frontmatter:r.frontmatter,data:r.data},{"main-content-md":o(()=>[s("h1",E,[l("PrometheusAlert 一个基于Prometheus_alertmanager的全家桶告警项目 "),e(n,{class:"header-anchor",href:"#prometheusalert-一个基于prometheus-alertmanager的全家桶告警项目","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),x,u,d,m,s("h2",g,[l("部署 "),e(n,{class:"header-anchor",href:"#部署","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),_,s("p",null,[l('**Prometheus监控设计部署可采纳==>> [button href="'),e(n,{href:"https://www.kococ.cn/20200830/cid=612.html",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://www.kococ.cn/20200830/cid=612.html")]),_:1}),l('"]Prometheus+Grafana 全方位监控系统[/button]')]),s("h3",f,[l("安装部署PrometheusAlert "),e(n,{class:"header-anchor",href:"#安装部署prometheusalert","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),v,b,k,$,w,P,B,T,s("h3",R,[l("配置 "),e(n,{class:"header-anchor",href:"#配置","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),L,S,I,U,Y,s("h4",O,[l("更新alertmanager配置文件 "),e(n,{class:"header-anchor",href:"#更新alertmanager配置文件","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),X,W,G,q,s("h3",N,[l("告警规则编写 "),e(n,{class:"header-anchor",href:"#告警规则编写","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),H,M,z,K,s("p",null,[l('[file href="'),e(n,{href:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/code/rules.tar.gz",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://cos.vlinux.cn/www-vlinux-cn-blog-img/gitee-backup/img-master/code/rules.tar.gz")]),_:1}),l('"]常用告警规则下载[/file]')]),s("p",null,[l('[button href="'),e(n,{href:"https://awesome-prometheus-alerts.grep.to/rules",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://awesome-prometheus-alerts.grep.to/rules")]),_:1}),l('"]告警规则全家桶[/button]')]),V,s("h4",j,[l("告警通知模板 "),e(n,{class:"header-anchor",href:"#告警通知模板","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),J,Z,Q,ss,ls,os,ns,es,as,ts,cs,rs,ps,s("p",null,[l("同时可以访问"),e(n,{href:"http://192.168.1.101:8080/test%E7%95%8C%E9%9D%A2%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95%E5%8F%91%E4%BF%A1",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("http://192.168.1.101:8080/test界面进行测试发信")]),_:1}),l(" 这里提供一个可以测试发信的日志信息，你会用到的")]),Ds,s("h2",ys,[l("扩展功能 PrometheusAlert高级自定义消息模版 "),e(n,{class:"header-anchor",href:"#扩展功能-prometheusalert高级自定义消息模版","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Fs,is,s("h3",Cs,[l("部署配置 "),e(n,{class:"header-anchor",href:"#部署配置","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),As,s("p",null,[l("访问网页地址"),e(n,{href:"http://192.168.1.101:8080/template",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("http://192.168.1.101:8080/template")]),_:1})]),hs,Es,xs,us,ds,ms,gs,_s,fs,vs,bs,ks,$s,ws,Ps,s("h3",Bs,[l("参考 "),e(n,{class:"header-anchor",href:"#参考","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("p",null,[e(n,{href:"https://gitee.com/feiyu563/PrometheusAlert",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://gitee.com/feiyu563/PrometheusAlert")]),_:1}),e(n,{href:"https://feiyu563.gitbook.io/prometheusalert/",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("https://feiyu563.gitbook.io/prometheusalert/")]),_:1})])]),"main-header":o(()=>[t(a.$slots,"main-header")]),"main-header-after":o(()=>[t(a.$slots,"main-header-after")]),"main-nav":o(()=>[t(a.$slots,"main-nav")]),"main-content":o(()=>[t(a.$slots,"main-content")]),"main-content-after":o(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":o(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":o(()=>[t(a.$slots,"main-nav-after")]),comment:o(()=>[t(a.$slots,"comment")]),footer:o(()=>[t(a.$slots,"footer")]),aside:o(()=>[t(a.$slots,"aside")]),"aside-custom":o(()=>[t(a.$slots,"aside-custom")]),default:o(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const qs=y(h,[["render",Ts]]);export{Gs as __pageData,qs as default};
