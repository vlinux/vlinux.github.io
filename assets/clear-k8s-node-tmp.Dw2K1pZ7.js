import{_ as b}from"./ValaxyMain.vue_vue_type_style_index_0_lang.DBuGQqdy.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as k,u as h,a as f}from"./chunks/vue-router.BxaDuBsg.js";import{aa as g,ap as t,ag as l,ae as c,af as a,ai as s,P,ab as v,a1 as y}from"./framework.GHZxz7jq.js";import"./index.DpUV-Spk.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.MEbNDp3K.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.CjbzLuOT.js";const F=k("/posts/clear-k8s-node-tmp",async o=>JSON.parse('{"title":"清理k8s节点空间","description":"","frontmatter":{"title":"清理k8s节点空间","date":"2025-07-08 16:49:11","updated":"2025-07-08 16:49:11","tags":null,"categories":null,"end":false},"headers":[],"relativePath":"pages/posts/clear-k8s-node-tmp.md","lastUpdated":null}'),{lazy:(o,i)=>o.name===i.name}),S={__name:"clear-k8s-node-tmp",setup(o,{expose:i}){const{data:r}=F(),p=f(),u=h(),d=Object.assign(u.meta.frontmatter||{},r.value?.frontmatter||{});return p.currentRoute.value.data=r.value,y("valaxy:frontmatter",d),globalThis.$frontmatter=d,i({frontmatter:{title:"清理k8s节点空间",date:"2025-07-08 16:49:11",updated:"2025-07-08 16:49:11",tags:null,categories:null,end:!1}}),(n,e)=>{const m=b;return v(),g(m,{frontmatter:P(d)},{"main-content-md":t(()=>[c(" more "),e[0]||(e[0]=a("h1",{id:"kubernetes-pod-数据清理笔记",tabindex:"-1"},[s("Kubernetes Pod 数据清理笔记 "),a("a",{class:"header-anchor",href:"#kubernetes-pod-数据清理笔记","aria-label":'Permalink to "Kubernetes Pod 数据清理笔记"'},"​")],-1)),e[1]||(e[1]=a("h2",{id:"背景",tabindex:"-1"},[s("背景 "),a("a",{class:"header-anchor",href:"#背景","aria-label":'Permalink to "背景"'},"​")],-1)),e[2]||(e[2]=a("p",null,[s("在 Kubernetes 集群中，节点的磁盘空间不足，触发了磁盘告警。为了清理不必要的数据，我需要找出 "),a("code",null,"/var/lib/kubelet/pods/44be8a3d-d1dc-4b41-8d16-1ecb80d216f5/volumes/kubernetes.io~empty-dir/tmpdata/persistent-queue/"),s(" 目录下的数据是由哪个 Pod 或容器生成的。")],-1)),e[3]||(e[3]=a("h2",{id:"步骤",tabindex:"-1"},[s("步骤 "),a("a",{class:"header-anchor",href:"#步骤","aria-label":'Permalink to "步骤"'},"​")],-1)),e[4]||(e[4]=a("h3",{id:"_1-确认-pod-的-uid",tabindex:"-1"},[s("1. 确认 Pod 的 UID "),a("a",{class:"header-anchor",href:"#_1-确认-pod-的-uid","aria-label":'Permalink to "1. 确认 Pod 的 UID"'},"​")],-1)),e[5]||(e[5]=a("p",null,[s("首先，我确认了该路径中的 UID，即 "),a("code",null,"44be8a3d-d1dc-4b41-8d16-1ecb80d216f5"),s("，这是目标 Pod 在 Kubernetes 中的唯一标识符。")],-1)),e[6]||(e[6]=a("h3",{id:"_2-查找-pod-的名称",tabindex:"-1"},[s("2. 查找 Pod 的名称 "),a("a",{class:"header-anchor",href:"#_2-查找-pod-的名称","aria-label":'Permalink to "2. 查找 Pod 的名称"'},"​")],-1)),e[7]||(e[7]=a("p",null,"使用以下命令列出当前命名空间下的所有 Pods，以找到与该 UID 相对应的 Pod 名称：",-1)),e[8]||(e[8]=a("div",{class:"language-bash"},[a("button",{title:"Copy code",class:"copy"}),a("span",{class:"lang"},"bash"),a("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[a("code",{"v-pre":""},[a("span",{class:"line"},[a("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"kubectl"),a("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," get"),a("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pods"),a("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --all-namespaces"),a("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),a("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," json"),a("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),a("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," jq"),a("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},` '.items[] | select(.metadata.uid=="44be8a3d-d1dc-4b41-8d16-1ecb80d216f5") | .metadata.name'`)])])]),a("button",{class:"code-block-unfold-btn"})],-1)),e[9]||(e[9]=a("p",null,[s("如果您没有安装 "),a("code",null,"jq"),s("，可以手动逐个检查 Pods，确认 UID。")],-1)),e[10]||(e[10]=a("h3",{id:"_3-确认-pod-所在的命名空间",tabindex:"-1"},[s("3. 确认 Pod 所在的命名空间 "),a("a",{class:"header-anchor",href:"#_3-确认-pod-所在的命名空间","aria-label":'Permalink to "3. 确认 Pod 所在的命名空间"'},"​")],-1)),e[11]||(e[11]=a("p",null,"在查找 Pod 名称的同时，确认该 Pod 所在的命名空间，之后使用下述命令确认 Pod 的详细信息：",-1)),e[12]||(e[12]=a("div",{class:"language-"},[a("button",{title:"Copy code",class:"copy"}),a("span",{class:"lang"}),a("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[a("code",{"v-pre":""},[a("span",{class:"line"},[a("span",null,"kubectl describe pod <pod-name> -n <namespace>")])])]),a("button",{class:"code-block-unfold-btn"})],-1)),e[13]||(e[13]=a("h3",{id:"_4-进入-pod-检查数据",tabindex:"-1"},[s("4. 进入 Pod 检查数据 "),a("a",{class:"header-anchor",href:"#_4-进入-pod-检查数据","aria-label":'Permalink to "4. 进入 Pod 检查数据"'},"​")],-1)),e[14]||(e[14]=a("p",null,"确认 Pod 和容器信息后，我可以进入该 Pod 的终端，以查看具体存储在指定路径下的数据：",-1)),e[15]||(e[15]=a("div",{class:"language-"},[a("button",{title:"Copy code",class:"copy"}),a("span",{class:"lang"}),a("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[a("code",{"v-pre":""},[a("span",{class:"line"},[a("span",null,"kubectl exec -it <pod-name> -n <namespace> -- /bin/sh")])])]),a("button",{class:"code-block-unfold-btn"})],-1)),e[16]||(e[16]=a("p",null,"或者",-1)),e[17]||(e[17]=a("div",{class:"language-"},[a("button",{title:"Copy code",class:"copy"}),a("span",{class:"lang"}),a("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[a("code",{"v-pre":""},[a("span",{class:"line"},[a("span",null,"kubectl exec -it <pod-name> -n <namespace> -- /bin/bash")])])]),a("button",{class:"code-block-unfold-btn"})],-1)),e[18]||(e[18]=a("p",null,"进入之后，检查该目录：",-1)),e[19]||(e[19]=a("div",{class:"language-"},[a("button",{title:"Copy code",class:"copy"}),a("span",{class:"lang"}),a("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[a("code",{"v-pre":""},[a("span",{class:"line"},[a("span",null,"cd /tmpdata/persistent-queue/")]),s(`
`),a("span",{class:"line"},[a("span",null,"ls -la")])])]),a("button",{class:"code-block-unfold-btn"})],-1)),e[20]||(e[20]=a("h3",{id:"_5-评估和清理数据",tabindex:"-1"},[s("5. 评估和清理数据 "),a("a",{class:"header-anchor",href:"#_5-评估和清理数据","aria-label":'Permalink to "5. 评估和清理数据"'},"​")],-1)),e[21]||(e[21]=a("p",null,"通过检查该目录中的文件和数据，评估哪些数据可以安全地删除，以释放磁盘空间。",-1))]),"main-header":t(()=>[l(n.$slots,"main-header")]),"main-header-after":t(()=>[l(n.$slots,"main-header-after")]),"main-nav":t(()=>[l(n.$slots,"main-nav")]),"main-content-before":t(()=>[l(n.$slots,"main-content-before")]),"main-content":t(()=>[l(n.$slots,"main-content")]),"main-content-after":t(()=>[l(n.$slots,"main-content-after")]),"main-nav-before":t(()=>[l(n.$slots,"main-nav-before")]),"main-nav-after":t(()=>[l(n.$slots,"main-nav-after")]),comment:t(()=>[l(n.$slots,"comment")]),footer:t(()=>[l(n.$slots,"footer")]),aside:t(()=>[l(n.$slots,"aside")]),"aside-custom":t(()=>[l(n.$slots,"aside-custom")]),default:t(()=>[l(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{S as default,F as usePageData};
