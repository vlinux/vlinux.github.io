import{_ as c}from"./ValaxyMain-f02151dd.js";import{_ as i,p,c as d,w as t,o as h,r as a,b as s,R as e}from"./app-b8a6f45d.js";import"./YunFooter-17369ec4.js";import"./YunCard-b0df9910.js";import"./YunPageHeader-95685dde.js";const ws=JSON.parse('{"title":"使用 Docker 自建 Bitwarden 密码管理服务器","description":"","frontmatter":{"title":"使用 Docker 自建 Bitwarden 密码管理服务器","categories":"Linux技术","tags":["Bitwarden"],"date":"2022-03-16T15:54:00.000Z"},"headers":[],"relativePath":"pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md","lastUpdated":1671090556000}'),o=JSON.parse('{"title":"使用 Docker 自建 Bitwarden 密码管理服务器","description":"","frontmatter":{"title":"使用 Docker 自建 Bitwarden 密码管理服务器","categories":"Linux技术","tags":["Bitwarden"],"date":"2022-03-16T15:54:00.000Z"},"headers":[],"relativePath":"pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md","lastUpdated":1671090556000}'),u={name:"pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md",data(){return{data:o,frontmatter:o.frontmatter}},setup(){p("pageData",o)}},_=s("p",null,[s("a",{href:"https://bitwarden.com/",target:"_blank",rel:"noreferrer"},"Bitwarden"),e("是一款优秀的跨平台密码管理软件，类似于 1Password、EnPass、LastPass 等。Bitwarden 是免费开源的，可以将服务端部署在自己的服务器上，比如群晖，并且支持 Docker 部署。但官方的镜像要求至少 2G 以上内存，要求比较高。有人用 Rust 实现了 Bitwarden 服务器，项目叫 "),s("s",null,"bitwarden_rs"),s("a",{href:"https://github.com/dani-garcia/vaultwarden",target:"_blank",rel:"noreferrer"},"vaultwarden")],-1),g=s("p",null,"，并且提供了 Docker 镜像，这个实现更进一步降低了对机器配置的要求，并且 Docker 镜像体积很小，部署非常方便。",-1),m=s("h1",{id:"_01-使用-docker-镜像部署并开启反向代理",tabindex:"-1"},[e("01 使用 Docker 镜像部署并开启反向代理 "),s("a",{class:"header-anchor",href:"#_01-使用-docker-镜像部署并开启反向代理","aria-hidden":"true"},"#")],-1),C=s("p",null,"在安装 Docker 后，通过 SSH 连接服务器，键入以下命令：",-1),w=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"run"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-d"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--name"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"Bitwarden"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--restart=always"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"SIGNUPS_ALLOWED="),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-v"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/www/wwwroot/bitwarden.angustar.com/:/data/"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-p"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"6666"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"vaultwarden/server:latest")]),e(`
`),s("span",{class:"line"})])])],-1),y=s("p",null,"Shell",-1),D=s("p",null,[e("其中，"),s("code",null,"SIGNUPS_ALLOWED=true"),e("代表允许注册，首次部署必须允许注册（用于创建第一个用户），"),s("code",null,"/www/wwwroot/bitwarden.angustar.com"),e("为数据实际存储目录，用于保存密码的 SQLite 数据库也存储于此，"),s("code",null,"6666"),e("为服务端口。")],-1),A=s("p",null,[e("之后添加一个站点，站点目录设置为上面的"),s("code",null,"/www/wwwroot/bitwarden.angustar.com"),e("，FTP、数据库均不需要创建，PHP 版本选择纯静态，建议同时为网站配置 SSL 证书。")],-1),f=s("p",null,[e("添加反向代理，目标URL为"),s("code",null,"http://127.0.0.1:6666"),e("，端口号与上面创建容器时的服务端口保持一致。")],-1),b=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/01/3405439263.jpg",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/3405439263-20220316155158798.jpg#mirages-width=748&mirages-height=704&mirages-cdn-type=5",alt:"在宝塔面板中可以很便捷地创建反向代理"})])],-1),v=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/01/3405439263.jpg",target:"_blank",rel:"noreferrer"},"在宝塔面板中可以很便捷地创建反向代理")],-1),k=s("p",null,[e("请提前在防火墙中放行"),s("code",null,"6666"),e("端口。")],-1),E=s("p",null,"请提前在 DNS 服务提供商处做好域名解析。",-1),B=s("p",null,[e("全部完成后，不出意外的话访问"),s("code",null,"https://bitwarden.angustar.com"),e("就能看到界面啦~ 之后创建账号并登录，如需更改语言，可以进入"),s("code",null,"设置"),e("-"),s("code",null,"选项"),e("-"),s("code",null,"语言"),e("中更改。")],-1),x=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/3724638843.png",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/3724638843.png#mirages-width=797&mirages-height=727&mirages-cdn-type=5",alt:"首次登陆前需要先创建账号"})])],-1),S=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/3724638843.png",target:"_blank",rel:"noreferrer"},"首次登陆前需要先创建账号")],-1),F=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/1355640409.png",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/1355640409.png#mirages-width=902&mirages-height=772&mirages-cdn-type=5",alt:"更改默认语言"})])],-1),$=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/1355640409.png",target:"_blank",rel:"noreferrer"},"更改默认语言")],-1),L=s("h1",{id:"_02-禁止注册-启用管理页面",tabindex:"-1"},[e("02 禁止注册 & 启用管理页面 "),s("a",{class:"header-anchor",href:"#_02-禁止注册-启用管理页面","aria-hidden":"true"},"#")],-1),N=s("p",null,"若 Bitwarden 不对外提供服务，则可以禁止注册。",-1),P=s("p",null,"首先需要停止运行容器并删除容器，若已安装宝塔面板，则可以直接在 Docker 管理器中操作。",-1),U=s("p",null,"删除容器不会影响已有数据。",-1),O=s("p",null,"之后通过 SSH 连接服务器，键入以下命令：",-1),j=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"docker"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"run"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-d"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--name"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"Bitwarden"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--restart=always"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"ADMIN_TOKEN=some_random_token_as_per_above_explanation"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"SIGNUPS_ALLOWED="),s("span",{style:{color:"#89DDFF"}},"false"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-v"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/www/wwwroot/bitwarden.angustar.com/:/data/"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"-p"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"6666"),s("span",{style:{color:"#C3E88D"}},":"),s("span",{style:{color:"#F78C6C"}},"80"),s("span",{style:{color:"#A6ACCD"}}," \\")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#C3E88D"}},"vaultwarden/server")]),e(`
`),s("span",{class:"line"})])])],-1),q=s("p",null,"Shell",-1),G=s("p",null,[e("其中，"),s("code",null,"ADMIN_TOKEN="),e("后面的部分为管理密码，在登陆管理页面"),s("code",null,"https://bitwarden.angustar.com/admin"),e("时使用，请尽量设置高强度密码，可以使用以下命令生成高强度密码：")],-1),T=s("div",{class:"language-shell"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"openssl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"rand"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-base64"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"48")]),e(`
`),s("span",{class:"line"})])])],-1),I=s("p",null,"Shell",-1),R=s("p",null,[e("之后如果忘记管理密码的话可以查看"),s("code",null,"/www/wwwroot/bitwarden.angustar.com/config.json"),e("（在管理页面第一次保存设置后会自动生成此文件）。")],-1),W=s("p",null,"容器创建完成后，再创建账号就会出现错误提示：",-1),H=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/4245330164.png",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/4245330164.png#mirages-width=1296&mirages-height=810&mirages-cdn-type=5",alt:"禁止注册"})])],-1),M=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/4245330164.png",target:"_blank",rel:"noreferrer"},"禁止注册")],-1),V=s("p",null,[e("在管理页面"),s("code",null,"https://bitwarden.angustar.com/admin"),e("中可以配置发信邮箱、邀请新用户注册（即使系统已经禁止注册）、删除用户等，其中，配置的发信邮箱可以用于确认用户的邮箱地址是否正确、发送包含主密码提示的邮件以及通过邮件的形式发送两步登陆验证码等，值得注意的是，出于安全考虑，**Bitwarden 不支持找回主密码，哪怕你是管理员也不行！！！**所以，请一定一定设置一个“有用的”主密码提示，可以在你忘记密码时帮你回忆起来，而不是花费个把小时去几十个网站上一个一个地找回密码。")],-1),J=s("p",null,"关于其它的配置项请参考项目的 Wiki：",-1),K=s("p",null,[s("a",{href:"https://github.com/dani-garcia/vaultwarden/wiki",target:"_blank",rel:"noreferrer"},"https://github.com/dani-garcia/vaultwarden/wiki")],-1),Z=s("p",null,[s("a",{href:"https://rs.bitwarden.in",target:"_blank",rel:"noreferrer"},"https://rs.bitwarden.in")],-1),Q=s("h1",{id:"_03-软件-浏览器插件下载",tabindex:"-1"},[e("03 软件 & 浏览器插件下载 "),s("a",{class:"header-anchor",href:"#_03-软件-浏览器插件下载","aria-hidden":"true"},"#")],-1),z=s("p",null,[e("软件和浏览器插件可以到 Bitwarden 官网下载："),s("a",{href:"https://bitwarden.com/download/",target:"_blank",rel:"noreferrer"},"https://bitwarden.com/download/")],-1),X=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/2291328307.png",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/2291328307.png#mirages-width=1260&mirages-height=737&mirages-cdn-type=5",alt:"软件 & 浏览器插件下载"})])],-1),Y=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/2291328307.png",target:"_blank",rel:"noreferrer"},"软件 & 浏览器插件下载")],-1),ss=s("p",null,[e("软件/浏览器插件安装完成后，需要连接自建的服务器（默认连接的是 Bitwarden 官方的服务器）才能正常使用，以 Chrome 插件为例，点击左上角齿轮状的设置图标，在"),s("code",null,"自托管环境"),e("处填写自建服务器的 URL 后保存即可。")],-1),es=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/1639469236.jpg",target:"_blank",rel:"noreferrer"},[s("img",{src:"https://vlinux-1259060227.cos.ap-shanghai.myqcloud.com/www-vlinux-cn-blog-img/1639469236.jpg#mirages-width=538&mirages-height=244&mirages-cdn-type=5",alt:"连接自建的服务器"})])],-1),ts=s("p",null,[s("a",{href:"https://cdn.angustar.com/usr/uploads/2021/08/1639469236.jpg",target:"_blank",rel:"noreferrer"},"连接自建的服务器")],-1),ns=s("h1",{id:"_04-定时备份",tabindex:"-1"},[e("04 定时备份 "),s("a",{class:"header-anchor",href:"#_04-定时备份","aria-hidden":"true"},"#")],-1),as=s("p",null,[s("strong",null,"定时备份很简单却很重要。")],-1),os=s("p",null,[e("备份时将目录"),s("code",null,"/www/wwwroot/bitwarden.angustar.com"),e("下的内容全部备份即可，可以用宝塔面板设置一个计划任务，定时备份至服务器磁盘或腾讯云 COS 等地，异地备份最好，不然服务器突然挂了就 GG 啦~")],-1),ls=s("h1",{id:"_05-结语",tabindex:"-1"},[e("05 结语 "),s("a",{class:"header-anchor",href:"#_05-结语","aria-hidden":"true"},"#")],-1),rs=s("p",null,"现在就可以在浏览器和手机上愉快的使用l啦~顺便说句，Bitwarden 除了可以记录密码外，也可以记录身份证、银行卡等隐私信息，随时复制，还有它的 Send 功能很好用，可以安全地分享文本和文件，到期后自动销毁，不留后患。",-1);function cs(n,is,ps,ds,l,hs){const r=c;return h(),d(r,{frontmatter:l.frontmatter,data:l.data},{"main-content-md":t(()=>[_,g,m,C,w,y,D,A,f,b,v,k,E,B,x,S,F,$,L,N,P,U,O,j,q,G,T,I,R,W,H,M,V,J,K,Z,Q,z,X,Y,ss,es,ts,ns,as,os,ls,rs]),"main-header":t(()=>[a(n.$slots,"main-header")]),"main-header-after":t(()=>[a(n.$slots,"main-header-after")]),"main-nav":t(()=>[a(n.$slots,"main-nav")]),"main-content":t(()=>[a(n.$slots,"main-content")]),"main-content-after":t(()=>[a(n.$slots,"main-content-after")]),"main-nav-before":t(()=>[a(n.$slots,"main-nav-before")]),"main-nav-after":t(()=>[a(n.$slots,"main-nav-after")]),comment:t(()=>[a(n.$slots,"comment")]),footer:t(()=>[a(n.$slots,"footer")]),aside:t(()=>[a(n.$slots,"aside")]),"aside-custom":t(()=>[a(n.$slots,"aside-custom")]),default:t(()=>[a(n.$slots,"default")]),_:3},8,["frontmatter","data"])}const ys=i(u,[["render",cs],["__file","/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/使用-Docker-自建-Bitwarden-密码管理服务器.md"]]);export{ws as __pageData,ys as default};
