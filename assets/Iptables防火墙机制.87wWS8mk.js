import{_ as F}from"./ValaxyMain.vue_vue_type_style_index_0_lang.Bv-Ltzoo.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as g,u as y,a as c}from"./chunks/vue-router.ClANm_mH.js";import{aa as C,ap as a,ag as h,af as i,ai as s,P as o,ab as B,a1 as b}from"./framework.GHZxz7jq.js";import"./index.Dp3W9g7b.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.C3MeNfs5.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.G7lgMgan.js";const A=g("/posts/Iptables防火墙机制",async t=>JSON.parse('{"title":"Iptables防火墙机制","description":"","frontmatter":{"title":"Iptables防火墙机制","categories":"Linux技术","tags":["iptables"],"date":"2023-03-20 10:42:00"},"headers":[],"relativePath":"pages/posts/Iptables防火墙机制.md","lastUpdated":null}'),{lazy:(t,k)=>t.name===k.name}),x={__name:"Iptables防火墙机制",setup(t,{expose:k}){const{data:n}=A(),r=c(),E=y(),e=Object.assign(E.meta.frontmatter||{},n.value?.frontmatter||{});return r.currentRoute.value.data=n.value,b("valaxy:frontmatter",e),globalThis.$frontmatter=e,k({frontmatter:{title:"Iptables防火墙机制",categories:"Linux技术",tags:["iptables"],date:"2023-03-20 10:42:00"}}),(l,p)=>{const d=F;return B(),C(d,{frontmatter:o(e)},{"main-content-md":a(()=>[...p[0]||(p[0]=[i("h1",{id:"第1章-iptables介绍",tabindex:"-1"},[s("第1章 iptables介绍 "),i("a",{class:"header-anchor",href:"#第1章-iptables介绍","aria-label":'Permalink to "第1章 iptables介绍"'},"​")],-1),i("h2",{id:"_1-iptables是什么",tabindex:"-1"},[s("1.iptables是什么？ "),i("a",{class:"header-anchor",href:"#_1-iptables是什么","aria-label":'Permalink to "1.iptables是什么？"'},"​")],-1),i("p",null,"iptables是开源的基于数据包过滤的防火墙工具。",-1),i("h2",{id:"_2-iptables企业应用场景",tabindex:"-1"},[s("2.iptables企业应用场景 "),i("a",{class:"header-anchor",href:"#_2-iptables企业应用场景","aria-label":'Permalink to "2.iptables企业应用场景"'},"​")],-1),i("p",null,"1、主机防火墙（filter表的INPUT链）。 2、局域网共享上网(nat表的POSTROUTING链)。半个路由器，NAT功能。 3、端口及IP映射(nat表的PREROUTING链)，硬防的NAT功能。 4、IP一对一映射。",-1),i("h2",{id:"_3-商用防火墙品牌",tabindex:"-1"},[s("3.商用防火墙品牌 "),i("a",{class:"header-anchor",href:"#_3-商用防火墙品牌","aria-label":'Permalink to "3.商用防火墙品牌"'},"​")],-1),i("p",null,"华为 深信服 思科 H3C Juniper 天融信 飞塔 网康 绿盟科技 金盾",-1),i("h1",{id:"第2章-iptables工作流程",tabindex:"-1"},[s("第2章 iptables工作流程 "),i("a",{class:"header-anchor",href:"#第2章-iptables工作流程","aria-label":'Permalink to "第2章 iptables工作流程"'},"​")],-1),i("p",null,"iptables是采用数据包过滤机制工作的，所以它会对请求的数据包的包头数据进行分析，并根据我们预先设定的规则进行匹配来决定是否可以进入主机。 1.防火墙是一层层过滤的。实际是按照配置规则的顺序从上到下，从前到后进行过滤的。 2.如果匹配上了规则，即明确表明是阻止还是通过，此时数据包就不在向下匹配新规则了。 3.如果所有规则中没有明确表明是阻止还是通过这个数据包，也就是没有匹配上规则，向下进行匹配，直到匹配默认规则得到明确的阻止还是通过。 4.防火墙的默认规则是对应链的所有的规则执行完以后才会执行的（最后执行的规则）。",-1),i("h1",{id:"第3章-iptables四表五链",tabindex:"-1"},[s("第3章 iptables四表五链 "),i("a",{class:"header-anchor",href:"#第3章-iptables四表五链","aria-label":'Permalink to "第3章 iptables四表五链"'},"​")],-1),i("h2",{id:"_1-表与链对应关系",tabindex:"-1"},[s("1.表与链对应关系 "),i("a",{class:"header-anchor",href:"#_1-表与链对应关系","aria-label":'Permalink to "1.表与链对应关系"'},"​")],-1),i("p",null,"实际iptables包含4张表和五个链，但主要记住两张表即可filter和nat表即可。",-1),i("figure",null,[i("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/14248468-58da03a179b40672.png",alt:"img",loading:"lazy",decoding:"async"})],-1),i("h2",{id:"_2-filter表",tabindex:"-1"},[s("2.FILTER表 "),i("a",{class:"header-anchor",href:"#_2-filter表","aria-label":'Permalink to "2.FILTER表"'},"​")],-1),i("figure",null,[i("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/14248468-b418ec2a196015e8-20230327153700601.png",alt:"img",loading:"lazy",decoding:"async"})],-1),i("h2",{id:"_3-nat表",tabindex:"-1"},[s("3.NAT表 "),i("a",{class:"header-anchor",href:"#_3-nat表","aria-label":'Permalink to "3.NAT表"'},"​")],-1),i("figure",null,[i("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/14248468-1f52b22fab1683cd-20230327153805334.png",alt:"img",loading:"lazy",decoding:"async"})],-1),i("h1",{id:"第4章-iptables工作原理示意图",tabindex:"-1"},[s("第4章 iptables工作原理示意图 "),i("a",{class:"header-anchor",href:"#第4章-iptables工作原理示意图","aria-label":'Permalink to "第4章 iptables工作原理示意图"'},"​")],-1),i("figure",null,[i("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/14248468-432aae0a08179e38-20230327153822388.png",alt:"img",loading:"lazy",decoding:"async"})],-1),i("figure",null,[i("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/14248468-d6bea13f8f11f33a-20230327153837198.png",alt:"img",loading:"lazy",decoding:"async"})],-1),i("h1",{id:"第5章-iptables环境准备",tabindex:"-1"},[s("第5章 iptables环境准备 "),i("a",{class:"header-anchor",href:"#第5章-iptables环境准备","aria-label":'Permalink to "第5章 iptables环境准备"'},"​")],-1),i("h2",{id:"_1-安装iptables管理命令",tabindex:"-1"},[s("1.安装iptables管理命令 "),i("a",{class:"header-anchor",href:"#_1-安装iptables管理命令","aria-label":'Permalink to "1.安装iptables管理命令"'},"​")],-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# yum install iptables"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"services "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"y")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-加载防火墙的内核模块",tabindex:"-1"},[s("2.加载防火墙的内核模块 "),i("a",{class:"header-anchor",href:"#_2-加载防火墙的内核模块","aria-label":'Permalink to "2.加载防火墙的内核模块"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ip_tables")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," iptable_filter")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," iptable_nat")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ip_conntrack")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ip_conntrack_ftp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ip_nat_ftp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"modprobe"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ipt_state")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"查看已加载的模块",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# lsmod "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"egrep "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'filter|nat|ipt'")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ipt_REJECT             "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12541"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nf_nat_ftp             "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12770"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nf_conntrack_ftp       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"18638"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nf_nat_ftp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptable_filter         "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12810"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"xt_nat                 "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12681"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptable_nat            "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"12875"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nf_nat_ipv4            "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"14115"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," iptable_nat")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nf_nat                 "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"26146"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nf_nat_ftp,nf_nat_ipv4,xt_nat")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nf_conntrack          "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"105745"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nf_nat_ftp,nf_nat,xt_state,nf_nat_ipv4,xt_conntrack,nf_conntrack_ftp,nf_conntrack_ipv4")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ip_tables              "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"27240"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," iptable_filter,iptable_nat")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-启动防火墙",tabindex:"-1"},[s("3.启动防火墙 "),i("a",{class:"header-anchor",href:"#_3-启动防火墙","aria-label":'Permalink to "3.启动防火墙"'},"​")],-1),i("p",null,"首先停止firewalld",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," stop"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"systemctl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," disable"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," firewalld")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"开启iptables",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"systemctl start iptables"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".service")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"systemctl enable iptables"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".service")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第6章-iptables基本操作命令",tabindex:"-1"},[s("第6章 iptables基本操作命令 "),i("a",{class:"header-anchor",href:"#第6章-iptables基本操作命令","aria-label":'Permalink to "第6章 iptables基本操作命令"'},"​")],-1),i("h2",{id:"_1-查看防火墙规则",tabindex:"-1"},[s("1.查看防火墙规则 "),i("a",{class:"header-anchor",href:"#_1-查看防火墙规则","aria-label":'Permalink to "1.查看防火墙规则"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@m01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# iptables -nL")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," OUTPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-清除防火墙规则",tabindex:"-1"},[s("2.清除防火墙规则 "),i("a",{class:"header-anchor",href:"#_2-清除防火墙规则","aria-label":'Permalink to "2.清除防火墙规则"'},"​")],-1),i("p",null,"iptables -F <- 清除所有规则，不会处理默认的规则 iptables -X <- 删除用户自定义的链 iptables -Z <- 链的计数器清零（数据包计数器与数据包字节计数器）",-1),i("h2",{id:"_3-添加防火墙规则",tabindex:"-1"},[s("3.添加防火墙规则 "),i("a",{class:"header-anchor",href:"#_3-添加防火墙规则","aria-label":'Permalink to "3.添加防火墙规则"'},"​")],-1),i("p",null,"iptables -t <-指定表d(efault: `filter’) iptables -A <-把规则添加到指定的链上，默认添加到最后一行。 iptables -I <-插入规则，默认插入到第一行(封IP)。 iptables -D <-删除链上的规则",-1),i("h2",{id:"_4-网络连接状态",tabindex:"-1"},[s("4.网络连接状态 "),i("a",{class:"header-anchor",href:"#_4-网络连接状态","aria-label":'Permalink to "4.网络连接状态"'},"​")],-1),i("p",null,"NEW：已经或将启动新的连接 ESTABLISHED：已建立的连接 RELATED：正在启动的新连接 INVALID：非法或无法识别的",-1),i("h2",{id:"_4-删除某个规则",tabindex:"-1"},[s("4.删除某个规则 "),i("a",{class:"header-anchor",href:"#_4-删除某个规则","aria-label":'Permalink to "4.删除某个规则"'},"​")],-1),i("p",null,"iptables -nL --line-numbers 查看规则号码 iptables -D INPUT 1 删除指定链上的指定序号",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," state"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 22"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -nL")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -nL"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --line-numbers")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -D"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第7章-iptables实战",tabindex:"-1"},[s("第7章 iptables实战 "),i("a",{class:"header-anchor",href:"#第7章-iptables实战","aria-label":'Permalink to "第7章 iptables实战"'},"​")],-1),i("h2",{id:"_1-禁止某个端口访问",tabindex:"-1"},[s("1.禁止某个端口访问 "),i("a",{class:"header-anchor",href:"#_1-禁止某个端口访问","aria-label":'Permalink to "1.禁止某个端口访问"'},"​")],-1),i("div",{class:"language-swift"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"swift"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"t filter "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p tcp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"dport "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"22"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"规则解释：",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-p"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==指定过滤的协议-p（tcp,udp,icmp,all）")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"--dport"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  #<==指定目标端口（用户请求的端口）。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-j"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==对规则的具体处理方法（ACCEPT,DROP,REJECT,SNAT/DNAT)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"--sport"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  #<==指定源端口。")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-禁止某个ip访问",tabindex:"-1"},[s("2.禁止某个IP访问 "),i("a",{class:"header-anchor",href:"#_2-禁止某个ip访问","aria-label":'Permalink to "2.禁止某个IP访问"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10.0.0.253"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," !"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10.0.0.1"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," !"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 10.0.0.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"规则解释：",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-s"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==指定源地址或网段（192.168.1.0/24）。 ! 取反。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-d"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==指定目的地址（nat表prerouting）。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-i"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==进入的网络接口（eth0,eth1）。")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-o"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"       #<==出去的网络接口（eth0,eth1）。")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-禁止除跳板机以外的ip访问",tabindex:"-1"},[s("3.禁止除跳板机以外的IP访问 "),i("a",{class:"header-anchor",href:"#_3-禁止除跳板机以外的ip访问","aria-label":'Permalink to "3.禁止除跳板机以外的IP访问"'},"​")],-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -I "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -p tcp ! -s 10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -j DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_4-匹配端口范围",tabindex:"-1"},[s("4.匹配端口范围 "),i("a",{class:"header-anchor",href:"#_4-匹配端口范围","aria-label":'Permalink to "4.匹配端口范围"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," multiport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 21,22,23,24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 3306:8809"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 18:80"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  #<==最佳")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_5-匹配icmp类型",tabindex:"-1"},[s("5.匹配ICMP类型 "),i("a",{class:"header-anchor",href:"#_5-匹配icmp类型","aria-label":'Permalink to "5.匹配ICMP类型"'},"​")],-1),i("div",{class:"language-tsx"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"tsx"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"A"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," INPUT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p icmp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"icmp"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"type "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"例：iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"A"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," INPUT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p icmp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"icmp"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"type "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"A"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," INPUT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p icmp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"m icmp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"icmp"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-type"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," any"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -A FORWARD -s 192.168.1.0/24 -p icmp -m icmp --icmp-type any -j ACCEPT")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_6-练习题",tabindex:"-1"},[s("6.练习题 "),i("a",{class:"header-anchor",href:"#_6-练习题","aria-label":'Permalink to "6.练习题"'},"​")],-1),i("p",null,"1、封掉10.0.0.7",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -I "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -s 10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.0.7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -j DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"2、让10.0.0.7和SSH客户端（10.0.0.1）服务器可以Ping，其它的不能Ping",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -I "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -p icmp --icmp-type 8 -s 10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.0.7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -I "),i("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 2 -p icmp ! -s 10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.0.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," --icmp-type 8 -j DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"3、封掉3306端口",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3306"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第8章-iptables企业案例",tabindex:"-1"},[s("第8章 iptables企业案例 "),i("a",{class:"header-anchor",href:"#第8章-iptables企业案例","aria-label":'Permalink to "第8章 iptables企业案例"'},"​")],-1),i("h2",{id:"_1-部署一个安全的防火墙",tabindex:"-1"},[s("1.部署一个安全的防火墙 "),i("a",{class:"header-anchor",href:"#_1-部署一个安全的防火墙","aria-label":'Permalink to "1.部署一个安全的防火墙"'},"​")],-1),i("p",null,"两种思想：针对默认规则而言。 逛公园：黑名单 1、默认规则默认是允许的状态。 看电影：白名单 2、默认规则默认是不允许的状态。更安全。 看电影的思想更安全。 实战部署：",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"F")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"X")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Z")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p tcp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"m multiport "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"dport "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"80"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"443"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p tcp "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"--"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"dport "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"22"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"s "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.0.0"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"24"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"s "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.0"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"24"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"A INPUT "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i lo "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"j ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"P INPUT DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"P FORWARD DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"P OUTPUT ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@m01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# iptables "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nL")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"policy"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DROP"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"target     prot opt source               destination         ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            multiport dports 80,443")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:22")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ACCEPT     all  --  10.0.0.0/24          0.0.0.0/0           ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ACCEPT     all  --  172.16.1.0/24        0.0.0.0/0           ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Chain FORWARD ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"policy"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," DROP"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"target     prot opt source               destination         ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Chain OUTPUT ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"policy"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"target     prot opt source               destination")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"命令集合：",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -F")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Z")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," multiport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80,443"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 22"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 10.0.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," lo"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," OUTPUT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -nL")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_2-局域网共享上网",tabindex:"-1"},[s("2.局域网共享上网 "),i("a",{class:"header-anchor",href:"#_2-局域网共享上网","aria-label":'Permalink to "2.局域网共享上网"'},"​")],-1),i("p",null,"实验环境： m01: 共享上网网关出口 web01: 只有内网地址，网关指向m01 实验步骤： m01操作",-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -t"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nat"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POSTROUTING"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," SNAT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --to-source"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10.0.0.61")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'net.ipv4.ip_forward = 1'"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," >>"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /etc/sysctl.conf")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sysctl"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -F")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Z")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -m"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," multiport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 80,443"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --dport"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 22"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 10.0.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," lo"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," DROP")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," OUTPUT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth1"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"iptables"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," FORWARD"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -o"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," eth1"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 172.16.1.0/24"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -j"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ACCEPT")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"web01操作：",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@web01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# cat "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"etc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sysconfig"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"network"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"scripts"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ifcfg"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"TYPE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Ethernet")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"BOOTPROTO"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"none")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DEFROUTE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"yes")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"NAME"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DEVICE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ONBOOT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"no")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"IPADDR"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.0.7")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PREFIX"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"24")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GATEWAY"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.0.2")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DNS1"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.0.2")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@web01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# cat "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"etc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sysconfig"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"network"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"scripts"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ifcfg"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"TYPE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Ethernet")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"BOOTPROTO"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"none")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DEFROUTE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"yes")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"NAME"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DEVICE"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"eth1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ONBOOT"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"yes")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"IPADDR"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.7")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GATEWAY"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.61")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PREFIX"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"24")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DNS1"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.0.2")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@web01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# systemctl restart network ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@web01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# ip r")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," via "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.61"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," dev eth1  proto static  metric "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.0"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"24"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," dev eth1  proto kernel  scope link  src "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  metric "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"100"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@web01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# cat "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"etc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"resolv.conf    ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nameserver "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.2")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"web01测试访问外网：",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@web01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# ping www.baidu.com")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PING www.a.shifen."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"com"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"14.215.177.39"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"56"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"84"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") bytes of data.")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"64"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bytes from "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"14.215.177.39"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," icmp_seq"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ttl"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"127"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," time"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"7.70"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ms")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"64"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," bytes from "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"14.215.177.39"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," icmp_seq"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ttl"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"127"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," time"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"8.92"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ms")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_3-端口映射",tabindex:"-1"},[s("3.端口映射 "),i("a",{class:"header-anchor",href:"#_3-端口映射","aria-label":'Permalink to "3.端口映射"'},"​")],-1),i("p",null,"m01操作：",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iptables -t nat -A PREROUTING -d 10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.1.61"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -p tcp --dport 9000 -j DNAT --to-destination 172"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".16.1.7"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":22")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"命令拆解：",-1),i("div",{class:"language-css"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"css"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"表：nat")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"链：PREROUTING")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"目标IP：10"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".0.1.61")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"目标端口：9000")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"协议：tcp")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"动作：DNAT")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"目标IP：172"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".16.1.7")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"目标端口：22")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"访问测试:",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"zhangyadeMacBook"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pro"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," zhangya$ ssh root@"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.61"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"p "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9000")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"root@"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.61"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'s password"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Last "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"login"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": Tue Aug "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"20"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 09"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"38"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"42"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 2019"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," from "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"172.16.1.51")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@web01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]#")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h2",{id:"_4-ip映射",tabindex:"-1"},[s("4.IP映射 "),i("a",{class:"header-anchor",href:"#_4-ip映射","aria-label":'Permalink to "4.IP映射"'},"​")],-1),i("div",{class:"language-bash"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@m01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# ip a add 10.0.1.62/24 dev eth0 label eth0:0")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@m01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# iptables -t nat -A PREROUTING -d 10.0.1.62 -j DNAT --to-destination 172.16.1.7")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[root@m01 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"]# iptables -nL -t nat")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," PREROUTING"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"DNAT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"       tcp"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  --"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  0.0.0.0/0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            10.0.1.61"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"            tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dpt:9000"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," to:172.16.1.7:22")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"DNAT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"       all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  --"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  0.0.0.0/0"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            10.0.1.62"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"            to:172.16.1.7")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," INPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," OUTPUT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Chain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POSTROUTING"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (policy "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ACCEPT"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     prot"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," opt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," source"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"               destination"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"SNAT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"       all"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  --"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  172.16.1.0/24"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"        0.0.0.0/0"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"            to:10.0.1.61")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("p",null,"测试访问：",-1),i("div",{class:"language-csharp"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"csharp"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"zhangyadeMacBook"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pro"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"~"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," zhangya$ ssh root@"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.62")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"root@"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.62"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'s password"),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Last "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"login"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": Wed Aug "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 13"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"30"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"04"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 2019"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," from "),i("span",{style:{"--shiki-light":"#B31D28","--shiki-light-font-style":"italic","--shiki-dark":"#FDAEB7","--shiki-dark-font-style":"italic"}},"10.0.1.1")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@web01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]# hostname")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"web01")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"["),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"root@web01"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ~]#")])])]),i("button",{class:"code-block-unfold-btn"})],-1),i("h1",{id:"第9章-iptables规则保存",tabindex:"-1"},[s("第9章 iptables规则保存 "),i("a",{class:"header-anchor",href:"#第9章-iptables规则保存","aria-label":'Permalink to "第9章 iptables规则保存"'},"​")],-1),i("p",null,"iptables-save > 20190821 #将防火墙规则保存到文件中 iptables-save #将防火墙规则保存到配置文件中，防止重启后失效 iptables-restore < 20190821 #从配置文件里载入防火墙配置",-1),i("h1",{id:"第10章-iptables防坑指南",tabindex:"-1"},[s("第10章 iptables防坑指南 "),i("a",{class:"header-anchor",href:"#第10章-iptables防坑指南","aria-label":'Permalink to "第10章 iptables防坑指南"'},"​")],-1),i("p",null,"1.修改之前先导出备份一份 2.修改的时候小心别把自己关在外面 3.可以现在定时任务里添加一条定时清空的规则，等测试没问题再取消定时任务",-1),i("h1",{id:"第11章-课堂笔记",tabindex:"-1"},[s("第11章 课堂笔记 "),i("a",{class:"header-anchor",href:"#第11章-课堂笔记","aria-label":'Permalink to "第11章 课堂笔记"'},"​")],-1),i("p",null,"1.从上往下依次匹配 2.一但匹配上,就不在往下匹配了 3.默认规则,默认的情况,默认规则是放行所有",-1),i("p",null,"-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT",-1),i("p",null,"-A INPUT :把这条规则添加到INPUT链的最后一行 -p tcp :指定协议为tcp -m state --state NEW :匹配TCP的连接状态 -m tcp --dport 22 :匹配TCP协议的目标端口 -j ACCEPT :执行动作 放行",-1),i("p",null,"iptables A INPUT -p tcp -m state --dport 22 -j DROP 禁止一个数据包: tcp协议 访问的端口是22",-1),i("p",null,"iptables -A INPUT -p tcp --dport 22 -j DROP iptables -nL iptables -nL --line-numbers iptables -D INPUT 1",-1),i("p",null,"禁止源地址是10.0.0.7的主机访问22端口 iptables -A INPUT -p tcp -s 10.0.0.7 --dport 22 -j DROP",-1),i("p",null,"禁止源地址是10.0.0.7的主机访问任何端口 iptables -A INPUT -p tcp -s 10.0.0.7 -j DROP",-1),i("p",null,"禁止源地址是10.0.0.8的主机访问80端口 iptables -A INPUT -p tcp -s 10.0.0.8 --dport 80 -j DROP",-1),i("p",null,"禁止除了10.0.0.7以外的地址访问80端口 iptables -A INPUT -p tcp ! -s 10.0.0.7 --dport 80 -j DROP",-1),i("p",null,"2条规则冲突,会以谁先谁为准 iptables -I INPUT -p tcp -s 10.0.0.7 --dport 22 -j ACCEPT iptables -I INPUT -p tcp -s 10.0.0.7 --dport 22 -j DROP",-1),i("p",null,"禁止10.0.0.7访问22和80端口 iptables -I INPUT -p tcp -s 10.0.0.7 -m multiport --dport 22,80 -j DROP",-1),i("p",null,"禁止10.0.0.7访问22到100之间的所有端口 iptables -A INPUT -p tcp -s 10.0.0.7 --dport 22:100 -j DROP",-1),i("p",null,"禁止所有主机ping iptables -A INPUT -p icmp --icmp-type 8 -j DROP",-1),i("p",null,"放行10.0.0.7可以ping iptables -I INPUT 2 -p icmp --icmp-type 8 -s 10.0.0.7 -j ACCEPT",-1),i("p",null,"只允许10.0.0.7可以ping ACCEPT icmp – 10.0.0.7 0.0.0.0/0 icmptype 8 DROP icmp – 0.0.0.0/0 0.0.0.0/0 icmptype 8",-1),i("p",null,"等同于上一条,优化版,只要不是10.0.0.7就不允许ping iptables -I INPUT -p icmp --icmp-type 8 ! -s 10.0.0.7 -j DROP",-1),i("p",null,"优先级: 匹配频次最高的条件放前面",-1),i("p",null,"100次 80 90 22 10",-1),i("p",null,"安全策略: 一种是广场上巡逻的人,默认认为大家都是安全的,只有通缉令上的人需要关注 一种是火车进站安检,默认所有人都是不安全的,只有有票的人才放行",-1),i("p",null,"iptables -F iptables -X iptables -Z iptables -A INPUT -p tcp -m multiport --dport 80,443 -j ACCEPT iptables -A INPUT -p tcp --dport 22 -j ACCEPT iptables -A INPUT -s 10.0.0.0/24 -j ACCEPT iptables -A INPUT -s 172.16.1.0/24 -j ACCEPT iptables -A INPUT -i lo -j ACCEPT iptables -P INPUT DROP iptables -P FORWARD DROP iptables -P OUTPUT ACCEPT iptables -nL",-1),i("p",null,"共享上网 iptables -t nat -A POSTROUTING -s 172.16.1.0/24 -j SNAT --to-source 10.0.0.61",-1),i("p",null,"-t nat :NAT表 -A POSTROUTING :POSTROUTING链 -s 172.16.1.0/24 :源地址172.16.1.0/24 -j SNAT :SNAT 改写源地址 –to-source 10.0.0.61 :将源地址改写成10.0.0.61",-1),i("p",null,"172.16.1.7发给百度的数据包格式 源端口: 80 目的端口: 80 源IP: 172.16.1.7 目的IP: 百度的IP 网关: 172.16.1.61",-1),i("p",null,"如果172.16.1.7想上网,需要改成如下的包格式",-1),i("p",null,"10.0.0.61访问百度 源端口: 80 目的端口: 80 源IP: 10.0.0.61 目的IP: 百度的IP 网关: 10.0.0.2",-1),i("p",null,"天坑 如果你的默认规则设置了拒绝所有，又执行了清除规则的语句-F 那就意味着，所有的请求全部都拒绝了 原因是-F不会改变默认规则",-1),i("p",null,"[root@web01 ~]# iptables -nL Chain INPUT (policy DROP) target prot opt source destination",-1),i("p",null,"Chain FORWARD (policy DROP) target prot opt source destination",-1),i("p",null,"Chain OUTPUT (policy ACCEPT) target prot opt source destination",-1),i("p",null,"解决： 物理机： 1.去机房自己清空 2.让机房的人重启服务器，前提条件是规则没有写入配置里 云服务器： 直接通过控制台恢复",-1),i("p",null,"如何避免： 1.测试规则之前，先写个定时任务，每隔5分钟重启一次iptables",-1),i("p",null,"FORWARD链默认为DROP的时候共享上网失效 解决方法： 第一种，添加2条规则 iptables -A FORWARD -s 172.16.1.0/24 -j ACCEPT iptables -A FORWARD -d 172.16.1.0/24 -j ACCEPT 第二种：修改FORWARD链默认规则为ACCEPT iptables -P FORWARD ACCEPT",-1),i("p",null,"端口映射： 访问10.0.0.61的9000端口，跳转到172.16.1.7的22端口",-1),i("p",null,"访问10.0.0.61的9000端口的数据包格式 源端口: 9000 目的端口: 9000 源IP: 10.0.0.1 目的IP: 10.0.0.61",-1),i("p",null,"源端口: 22 目的端口: 22 源IP: 10.0.0.1 目的IP: 172.16.1.7:22",-1),i("p",null,"iptables -t nat -A PREROUTING -d 10.0.0.61 -p tcp --dport 9000 -j DNAT --to-destination 172.16.1.7:22 注意： 改写数据包的目标IP和端口 用到的是PREROUTING链",-1),i("p",null,"IP映射： ip a add 10.0.1.62/24 dev eth0 label eth0:0 iptables -t nat -A PREROUTING -d 10.0.1.62 -j DNAT --to-destination 172.16.1.7",-1),i("p",null,"保存命令： iptables-save iptables-save > iptables_m01 iptables-restore < iptables_m01 iptables-save > /etc/sysconfig/iptables",-1),i("p",null,"摘录自张导简书",-1)])]),"main-header":a(()=>[h(l.$slots,"main-header")]),"main-header-after":a(()=>[h(l.$slots,"main-header-after")]),"main-nav":a(()=>[h(l.$slots,"main-nav")]),"main-content-before":a(()=>[h(l.$slots,"main-content-before")]),"main-content":a(()=>[h(l.$slots,"main-content")]),"main-content-after":a(()=>[h(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[h(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[h(l.$slots,"main-nav-after")]),comment:a(()=>[h(l.$slots,"comment")]),footer:a(()=>[h(l.$slots,"footer")]),aside:a(()=>[h(l.$slots,"aside")]),"aside-custom":a(()=>[h(l.$slots,"aside-custom")]),default:a(()=>[h(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{x as default,A as usePageData};
