import{_ as r}from"./ValaxyMain.vue_vue_type_style_index_0_lang.437d393b.js";import{_ as c,c as p,w as n,o as u,r as a,g as s,R as e,p as d}from"./app.902f16e8.js";import"./YunFooter.vue_vue_type_script_setup_true_lang.d07e2c3f.js";import"./YunCard.vue_vue_type_style_index_0_lang.8b0ee1ff.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.6f9bc592.js";const E=JSON.parse('{"title":"Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09","description":"","frontmatter":{"title":"Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09","categories":"Kubernetes","tags":["NFS-client"],"date":"2021-01-19T11:30:00.000Z"},"headers":[{"level":2,"title":"\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","slug":"\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","link":"#\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","children":[]},{"level":2,"title":"\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","slug":"\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","link":"#\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","children":[]},{"level":2,"title":"\u4E09\u3001\u90E8\u7F72NFS\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFAPV\u63D2\u4EF6\uFF1A","slug":"\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A","link":"#\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A","children":[]}],"relativePath":"pages/posts/Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09.md","lastUpdated":0}'),t=JSON.parse('{"title":"Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09","description":"","frontmatter":{"title":"Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09","categories":"Kubernetes","tags":["NFS-client"],"date":"2021-01-19T11:30:00.000Z"},"headers":[{"level":2,"title":"\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","slug":"\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","link":"#\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","children":[]},{"level":2,"title":"\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","slug":"\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","link":"#\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","children":[]},{"level":2,"title":"\u4E09\u3001\u90E8\u7F72NFS\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFAPV\u63D2\u4EF6\uFF1A","slug":"\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A","link":"#\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A","children":[]}],"relativePath":"pages/posts/Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09.md","lastUpdated":0}'),f={name:"pages/posts/Kubernetes\u4F7F\u7528NFS\u4F5C\u4E3A\u52A8\u6001\u5B58\u50A8\uFF08\u63D0\u4F9B\u4E0B\u8F7DYAML\uFF09.md",data(){return{data:t,frontmatter:t.frontmatter}},setup(){d("pageData",t)}},A=s("blockquote",null,[s("p",null,"\u8BB0\u5F55\u4E00\u4E0B\u5C0F\u5B9E\u9A8C\uFF0C\u4EE5\u514D\u4EE5\u540E\u5FD8\u8BB0")],-1),m=s("h2",{id:"\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E",tabindex:"-1"},[e("\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E "),s("a",{class:"header-anchor",href:"#\u4E00\u3001nfs\u670D\u52A1\u5668\u5B89\u88C5nfs\u4E0E\u914D\u7F6E","aria-hidden":"true"},"#")],-1),y=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"yum -y install nfs-utils rpcbind")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl  start rpcbind.service ")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"systemctl  start nfs")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#\u914D\u7F6E")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mkdir /data/nfs -p")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"chow nfsnobody.nfsnobody /data/nfs")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"cat>>/etc/exports<<EOF")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/data/nfs 172.16.208.0/20(rw,sync,no_root_squash,no_all_squash)")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"EOF")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"exportfs  -arv")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),C=s("h2",{id:"\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils",tabindex:"-1"},[e("\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils "),s("a",{class:"header-anchor",href:"#\u4E8C\u3001\u5176\u5B83\u5BA2\u6237\u7AEF\u670D\u52A1\u5668\u5B89\u88C5nfs-utils","aria-hidden":"true"},"#")],-1),h=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"yum install -y  nfs-utils")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),_=s("h2",{id:"\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A",tabindex:"-1"},[e("\u4E09\u3001\u90E8\u7F72NFS\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFAPV\u63D2\u4EF6\uFF1A "),s("a",{class:"header-anchor",href:"#\u4E09\u3001\u90E8\u7F72nfs\u5B9E\u73B0\u81EA\u52A8\u521B\u5EFApv\u63D2\u4EF6\uFF1A","aria-hidden":"true"},"#")],-1),v=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"git clone https://github.com/kubernetes-incubator/external-storage")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),g=s("p",null,"\u4E0A\u9762\u7684Clone\u4E0B\u6765\u7684\u4ED3\u5E93\u7531\u4E8E\u662F\u5B98\u7F51\u7684\u6240\u4EE5\u53EF\u80FD\u5BFC\u81F4\u5185\u90E8\u6709\u4E9B\u8D44\u6E90\u662F\u5916\u7F51\u8D44\u6E90\uFF0C\u65E0\u6CD5\u6B63\u5E38\u90E8\u7F72\u8DDF\u542F\u52A8\uFF0C\u4E8E\u662F\u4E4E\u535A\u4E3B\u81EA\u5DF1\u4F7F\u7528\u79D1\u5B66\u4E0A\u7F51\u7684\u65B9\u5F0F\u5DF2\u7ECF\u628A\u5916\u7F51\u8D44\u6E90\u7ED9PUll\u4E0B\u6765\u66FF\u6362\u8FDB\u53BB\u4E86\uFF0C\u73B0\u5728\u4F60\u53EA\u9700\u8981\u4E0B\u8F7D\u535A\u4E3B\u63D0\u4F9B\u7684\u5C31\u53EF\u4EE5\u4E86\uFF0C\u4E0B\u8F7D\u94FE\u63A5\u5728\u4E0B\u9762@(\u4F60\u61C2\u7684)\u4E0D\u7528\u8C22",-1),b=s("p",null,[e('[file href="'),s("a",{href:"https://wwa.lanzoui.com/i2mohkkammj",target:"_blank",rel:"noreferrer"},"https://wwa.lanzoui.com/i2mohkkammj"),e('"]NFS\u52A8\u6001\u5B58\u50A8\u7C7B[/file]')],-1),k=s("blockquote",null,[s("p",null,"\u90E8\u7F72\u6D41\u7A0B\u5982\u4E0B")],-1),D=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"unzip nfs-client.zip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"cd nfs-client/")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubectl apply -f rbac.yaml # \u6388\u6743\u8BBF\u95EEapiserver")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubectl apply -f deployment.yaml # \u90E8\u7F72\u63D2\u4EF6\uFF0C\u9700\u4FEE\u6539\u91CC\u9762NFS\u670D\u52A1\u5668\u5730\u5740\u4E0E\u5171\u4EAB\u76EE\u5F55")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubectl apply -f class.yaml # \u521B\u5EFA\u5B58\u50A8\u7C7B")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubectl get cs # \u67E5\u770B\u5B58\u50A8\u7C7B")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),S=s("p",null,"\u5F53\u4F60\u51FA\u73B0\u62A5\u9519",-1),N=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pod has unbound immediate PersistentVolumeClaims")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),F=s("p",null,"\u591A\u534A\u662F\u4F60\u7684k8s\u7248\u672C\u9AD8\u4E8E1.20\u7684\u95EE\u9898",-1),$=s("p",null,'\u7B2C\u4E00\u79CD\u89E3\u51B3\u65B9\u6CD5 [tip type="danger" title="\u4F7F\u7528k8s\u7248\u672C\u9AD8\u4E8Ev1.20.0\u7684\u6CE8\u610F"] \u4FEE\u6539**/etc/kubernetes/manifests/kube-apiserver.yaml** \u6587\u4EF6',-1),x=s("p",null,"\u6DFB\u52A0\u6DFB\u52A0**- --feature-gates=RemoveSelfLink=false**",-1),K=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@master ~]# grep -B 5 'feature-gates' /etc/kubernetes/manifests/kube-apiserver.yaml")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --service-account-key-file=/etc/kubernetes/pki/sa.pub")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --service-account-signing-key-file=/etc/kubernetes/pki/sa.key")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --service-cluster-ip-range=10.96.0.0/12")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --feature-gates=RemoveSelfLink=false #\u6DFB\u52A0\u5185\u5BB9")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),L=s("p",null,"[/tip]",-1),M=s("p",null,"\u7B2C\u4E8C\u79CD\u89E3\u51B3\u65B9\u6CD5 \u4FEE\u6539nfs-client\u7684deployment\u53C2\u6570\uFF1A",-1),Y=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubectl -n kube-system edit deploy <nfs-client-deploy\u540D>")]),e(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),w=s("p",null,[e("\u5C06\u5176\u4E2D\u7684.spec.template.spec.containers[0].image\u53C2\u6570\u4FEE\u6539\u4E3A\uFF1A"),s("a",{href:"http://k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2",target:"_blank",rel:"noreferrer"},"k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2"),e(" \u7B49\u5F85nfs-client pod\u542F\u52A8\u5373\u53EF\u3002")],-1);function P(l,V,U,q,o,z){const i=r;return u(),p(i,{frontmatter:o.frontmatter,data:o.data},{"main-content-md":n(()=>[A,m,y,C,h,_,v,g,b,k,D,S,N,F,$,x,K,L,M,Y,w]),"main-header":n(()=>[a(l.$slots,"main-header")]),"main-header-after":n(()=>[a(l.$slots,"main-header-after")]),"main-nav":n(()=>[a(l.$slots,"main-nav")]),"main-content":n(()=>[a(l.$slots,"main-content")]),"main-content-after":n(()=>[a(l.$slots,"main-content-after")]),"main-nav-before":n(()=>[a(l.$slots,"main-nav-before")]),"main-nav-after":n(()=>[a(l.$slots,"main-nav-after")]),comment:n(()=>[a(l.$slots,"comment")]),footer:n(()=>[a(l.$slots,"footer")]),aside:n(()=>[a(l.$slots,"aside")]),"aside-custom":n(()=>[a(l.$slots,"aside-custom")]),default:n(()=>[a(l.$slots,"default")]),_:3},8,["frontmatter","data"])}const J=c(f,[["render",P]]);export{E as __pageData,J as default};
