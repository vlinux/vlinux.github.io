import{_ as y}from"./ValaxyMain.vue_vue_type_style_index_0_lang-ff623c6a.js";import{_ as D,c as C,w as o,o as i,b as s,U as l,q as e,r as t,W as F,p as A}from"./app-4a4ffc33.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-8f14011c.js";import"./YunCard.vue_vue_type_style_index_0_lang-44a49504.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-4581fd4f.js";const Ks=JSON.parse('{"title":"Sersync/lsync实时同步","description":"","frontmatter":{"title":"Sersync/lsync实时同步","categories":"Linux技术","tags":["Sersync","Lsync","实时同步"],"date":"2020-03-12T16:10:00.000Z"},"headers":[{"level":2,"title":"1.第二阶段实时同步解决了什么问题:","slug":"_1-第二阶段实时同步解决了什么问题","link":"#_1-第二阶段实时同步解决了什么问题","children":[]},{"level":2,"title":"2.实时同步难点","slug":"_2-实时同步难点","link":"#_2-实时同步难点","children":[]},{"level":2,"title":"1.查看当前系统是否支持inotify","slug":"_1-查看当前系统是否支持inotify","link":"#_1-查看当前系统是否支持inotify","children":[]},{"level":2,"title":"2.安装inotify-tools","slug":"_2-安装inotify-tools","link":"#_2-安装inotify-tools","children":[]},{"level":2,"title":"3.inotifywait详细参数解释","slug":"_3-inotifywait详细参数解释","link":"#_3-inotifywait详细参数解释","children":[]},{"level":2,"title":"4.查看inotify默认参数","slug":"_4-查看inotify默认参数","link":"#_4-查看inotify默认参数","children":[]},{"level":2,"title":"5.针对上述命令进行测试","slug":"_5-针对上述命令进行测试","link":"#_5-针对上述命令进行测试","children":[]},{"level":2,"title":"6.把客户端监控到情况出发rsync推送变化的文件","slug":"_6-把客户端监控到情况出发rsync推送变化的文件","link":"#_6-把客户端监控到情况出发rsync推送变化的文件","children":[]},{"level":2,"title":"7.inotify优缺点","slug":"_7-inotify优缺点","link":"#_7-inotify优缺点","children":[]},{"level":2,"title":"1.sersync介绍","slug":"_1-sersync介绍","link":"#_1-sersync介绍","children":[]},{"level":2,"title":"2.sersync优点","slug":"_2-sersync优点","link":"#_2-sersync优点","children":[]},{"level":2,"title":"1.主机规划","slug":"_1-主机规划","link":"#_1-主机规划","children":[]},{"level":2,"title":"2.安装sersync","slug":"_2-安装sersync","link":"#_2-安装sersync","children":[]},{"level":2,"title":"3.配置解释","slug":"_3-配置解释","link":"#_3-配置解释","children":[]},{"level":2,"title":"4.配置文件修改","slug":"_4-配置文件修改","link":"#_4-配置文件修改","children":[]},{"level":2,"title":"5.查看帮助说明","slug":"_5-查看帮助说明","link":"#_5-查看帮助说明","children":[]},{"level":2,"title":"6.启动服务","slug":"_6-启动服务","link":"#_6-启动服务","children":[]},{"level":2,"title":"7.测试数据是否同步","slug":"_7-测试数据是否同步","link":"#_7-测试数据是否同步","children":[]},{"level":2,"title":"1.官方地址","slug":"_1-官方地址","link":"#_1-官方地址","children":[]},{"level":2,"title":"2.lsyncd介绍","slug":"_2-lsyncd介绍","link":"#_2-lsyncd介绍","children":[]},{"level":2,"title":"3.lsyncd安装","slug":"_3-lsyncd安装","link":"#_3-lsyncd安装","children":[]},{"level":2,"title":"4.创建配置文件","slug":"_4-创建配置文件","link":"#_4-创建配置文件","children":[]},{"level":2,"title":"5.配置文件解释","slug":"_5-配置文件解释","link":"#_5-配置文件解释","children":[]},{"level":2,"title":"6.启动命令","slug":"_6-启动命令","link":"#_6-启动命令","children":[]},{"level":2,"title":"7.检查测试","slug":"_7-检查测试","link":"#_7-检查测试","children":[]}],"relativePath":"pages/posts/Sersync-lsync实时同步.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/Sersync-lsync实时同步.md","lastUpdated":1671091756000}'),c=JSON.parse('{"title":"Sersync/lsync实时同步","description":"","frontmatter":{"title":"Sersync/lsync实时同步","categories":"Linux技术","tags":["Sersync","Lsync","实时同步"],"date":"2020-03-12T16:10:00.000Z"},"headers":[{"level":2,"title":"1.第二阶段实时同步解决了什么问题:","slug":"_1-第二阶段实时同步解决了什么问题","link":"#_1-第二阶段实时同步解决了什么问题","children":[]},{"level":2,"title":"2.实时同步难点","slug":"_2-实时同步难点","link":"#_2-实时同步难点","children":[]},{"level":2,"title":"1.查看当前系统是否支持inotify","slug":"_1-查看当前系统是否支持inotify","link":"#_1-查看当前系统是否支持inotify","children":[]},{"level":2,"title":"2.安装inotify-tools","slug":"_2-安装inotify-tools","link":"#_2-安装inotify-tools","children":[]},{"level":2,"title":"3.inotifywait详细参数解释","slug":"_3-inotifywait详细参数解释","link":"#_3-inotifywait详细参数解释","children":[]},{"level":2,"title":"4.查看inotify默认参数","slug":"_4-查看inotify默认参数","link":"#_4-查看inotify默认参数","children":[]},{"level":2,"title":"5.针对上述命令进行测试","slug":"_5-针对上述命令进行测试","link":"#_5-针对上述命令进行测试","children":[]},{"level":2,"title":"6.把客户端监控到情况出发rsync推送变化的文件","slug":"_6-把客户端监控到情况出发rsync推送变化的文件","link":"#_6-把客户端监控到情况出发rsync推送变化的文件","children":[]},{"level":2,"title":"7.inotify优缺点","slug":"_7-inotify优缺点","link":"#_7-inotify优缺点","children":[]},{"level":2,"title":"1.sersync介绍","slug":"_1-sersync介绍","link":"#_1-sersync介绍","children":[]},{"level":2,"title":"2.sersync优点","slug":"_2-sersync优点","link":"#_2-sersync优点","children":[]},{"level":2,"title":"1.主机规划","slug":"_1-主机规划","link":"#_1-主机规划","children":[]},{"level":2,"title":"2.安装sersync","slug":"_2-安装sersync","link":"#_2-安装sersync","children":[]},{"level":2,"title":"3.配置解释","slug":"_3-配置解释","link":"#_3-配置解释","children":[]},{"level":2,"title":"4.配置文件修改","slug":"_4-配置文件修改","link":"#_4-配置文件修改","children":[]},{"level":2,"title":"5.查看帮助说明","slug":"_5-查看帮助说明","link":"#_5-查看帮助说明","children":[]},{"level":2,"title":"6.启动服务","slug":"_6-启动服务","link":"#_6-启动服务","children":[]},{"level":2,"title":"7.测试数据是否同步","slug":"_7-测试数据是否同步","link":"#_7-测试数据是否同步","children":[]},{"level":2,"title":"1.官方地址","slug":"_1-官方地址","link":"#_1-官方地址","children":[]},{"level":2,"title":"2.lsyncd介绍","slug":"_2-lsyncd介绍","link":"#_2-lsyncd介绍","children":[]},{"level":2,"title":"3.lsyncd安装","slug":"_3-lsyncd安装","link":"#_3-lsyncd安装","children":[]},{"level":2,"title":"4.创建配置文件","slug":"_4-创建配置文件","link":"#_4-创建配置文件","children":[]},{"level":2,"title":"5.配置文件解释","slug":"_5-配置文件解释","link":"#_5-配置文件解释","children":[]},{"level":2,"title":"6.启动命令","slug":"_6-启动命令","link":"#_6-启动命令","children":[]},{"level":2,"title":"7.检查测试","slug":"_7-检查测试","link":"#_7-检查测试","children":[]}],"relativePath":"pages/posts/Sersync-lsync实时同步.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/Sersync-lsync实时同步.md","lastUpdated":1671091756000}'),d={name:"pages/posts/Sersync-lsync实时同步.md",data(){return{data:c,frontmatter:c.frontmatter}},setup(){A("pageData",c)}},_={id:"第一章-为什么需要实时同步",tabindex:"-1"},h={id:"_1-第二阶段实时同步解决了什么问题",tabindex:"-1"},u=s("p",null,"解决 NFS单点故障问题 备份NFS数据并且提供冗余的服务功能",-1),f={id:"_2-实时同步难点",tabindex:"-1"},E=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"什么条件才同步")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"多久同步一次")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"用什么备份方式同步")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"用什么工具同步")]),l(`
`),s("span",{class:"line"})])])],-1),B={id:"第二章-inotify简介",tabindex:"-1"},g=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Inotify是一种强大的"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"细粒度的"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"异步的文件系统事件监视机制")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Linux2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"6"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"13起加入了inotify支持"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"通过inotify可以监控文件系统中添加"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"删除"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"修改"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"移动等各种事件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"利用这个内核接口"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"第三方软件就可以监控文件系统下文件的各种变化情况")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"而inotify-tools正是实施这样监控的软件")]),l(`
`),s("span",{class:"line"})])])],-1),m=s("p",null,"关系图",-1),v=s("p",null,[s("img",{src:"http:////upload-images.jianshu.io/upload_images/14248468-e23cc9187ab60ed7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/448/format/webp",alt:"img"})],-1),b={id:"第三章-inotify实时同步",tabindex:"-1"},k={id:"_1-查看当前系统是否支持inotify",tabindex:"-1"},x=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@nfs"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# uname "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"r")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3.10.0"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"862.el7.x86_64")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@nfs"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# ls "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"l "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"proc"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"sys"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"fs"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"inotify"),s("span",{style:{color:"#89DDFF"}},"/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"total "),s("span",{style:{color:"#F78C6C"}},"0")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"rw"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," root root "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," Oct "),s("span",{style:{color:"#F78C6C"}},"21"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"47"),s("span",{style:{color:"#A6ACCD"}}," max_queued_events")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"rw"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," root root "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," Oct "),s("span",{style:{color:"#F78C6C"}},"21"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"47"),s("span",{style:{color:"#A6ACCD"}}," max_user_instances")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"rw"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}}," root root "),s("span",{style:{color:"#F78C6C"}},"0"),s("span",{style:{color:"#A6ACCD"}}," Oct "),s("span",{style:{color:"#F78C6C"}},"21"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}},":"),s("span",{style:{color:"#F78C6C"}},"47"),s("span",{style:{color:"#A6ACCD"}}," max_user_watches")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"====="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"=====")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"max_queued_events   "),s("span",{style:{color:"#89DDFF"}},"=====>"),s("span",{style:{color:"#82AAFF"}},"设置inotify实例事件"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"event"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},"队列可容纳的事件数量")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"max_user_instances  "),s("span",{style:{color:"#89DDFF"}},"=====>"),s("span",{style:{color:"#A6ACCD"}},"设置每个用户可以运行的inotify或者inotifywatch命令的进程数")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"max_user_watches    "),s("span",{style:{color:"#89DDFF"}},"=====>"),s("span",{style:{color:"#82AAFF"}},"设置inotifywait或者inotifywatch命令可以监视的文件数量"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#A6ACCD"}},"单进程"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"})])])],-1),w={id:"_2-安装inotify-tools",tabindex:"-1"},$=s("div",{class:"language-csharp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#FFCB6B"}},"root@nfs"),s("span",{style:{color:"#A6ACCD"}}," ~"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# yum install inotify"),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"tools "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"y")]),l(`
`),s("span",{class:"line"})])])],-1),S={id:"_3-inotifywait详细参数解释",tabindex:"-1"},q=s("div",{class:"language-go"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"inotifywait参数说明")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"参数名称            参数说明")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"m "),s("span",{style:{color:"#89DDFF"}},",-"),s("span",{style:{color:"#A6ACCD"}},"monitor       始终保持事件监听状态")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"r"),s("span",{style:{color:"#89DDFF"}},",-"),s("span",{style:{color:"#A6ACCD"}},"recursive      递归查询目录")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"q"),s("span",{style:{color:"#89DDFF"}},",-"),s("span",{style:{color:"#A6ACCD"}},"quiet          只打印监控事件的信息")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"exclude           排除文件或目录时"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"不区分大小写")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"t"),s("span",{style:{color:"#89DDFF"}},",-"),s("span",{style:{color:"#A6ACCD"}},"timeout        超时时间")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"timefmt          指定时间输出格式")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"format           指定输出格式")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"e"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"event           后面指定增"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"删"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"改等事件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"inotifywait events 事件说明")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"access             读取文件或目录内容")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modify             修改文件或目录内容")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"attrib             文件或目录的属性改变")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"close_write        修改真实文件内容")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"close_nowrite   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"close   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"open               文件或目录被打开")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"moved_to           文件或目录移动到")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"moved_from         文件或目录从"),s("span",{style:{color:"#89DDFF"}},"..."),s("span",{style:{color:"#A6ACCD"}},"移动到")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"move               移动文件或目录移动到监视目录")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"create             在监视目录下创建文件或目录")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"delete             删除监视目录下的文件或目录")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"delete_self ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"umount             卸载文件系统")]),l(`
`),s("span",{class:"line"})])])],-1),N={id:"_4-查看inotify默认参数",tabindex:"-1"},L=s("div",{class:"language-ruby"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root"),s("span",{style:{color:"#89DDFF"}},"@"),s("span",{style:{color:"#A6ACCD"}},"nfs01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95","font-style":"italic"}},"# sysctl -a |egrep max_queued_events")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"fs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"inotify"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"max_queued_events "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"16384")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root"),s("span",{style:{color:"#89DDFF"}},"@"),s("span",{style:{color:"#A6ACCD"}},"nfs01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95","font-style":"italic"}},"#  sysctl -a |egrep max_user_watches")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"fs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"epoll"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"max_user_watches "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"201256")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"fs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"inotify"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"max_user_watches "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"8192")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root"),s("span",{style:{color:"#89DDFF"}},"@"),s("span",{style:{color:"#A6ACCD"}},"nfs01 "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#676E95","font-style":"italic"}},"# sysctl -a |egrep max_user_instances")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"fs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"inotify"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"max_user_instances "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"128")]),l(`
`),s("span",{class:"line"})])])],-1),P={id:"_5-针对上述命令进行测试",tabindex:"-1"},z=s("p",null,"参数解释:",-1),M=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"%"),s("span",{style:{color:"#FFCB6B"}},"T"),s("span",{style:{color:"#A6ACCD"}},"   "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#调用并显示定义好的时间格式")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"%"),s("span",{style:{color:"#FFCB6B"}},"w"),s("span",{style:{color:"#A6ACCD"}},"   "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#显示发生变化的文件的绝对路径")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"%"),s("span",{style:{color:"#FFCB6B"}},"f"),s("span",{style:{color:"#A6ACCD"}},"   "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#显示监控到的文件名称,去掉后只显示目录路径")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"delete,create"),s("span",{style:{color:"#A6ACCD"}},"   "),s("span",{style:{color:"#676E95","font-style":"italic"}},"#指定监控文件变化的类型 ")]),l(`
`),s("span",{class:"line"})])])],-1),O=s("p",null,"1.开启两个窗口:测试create和delete",-1),U=s("div",{class:"language-go"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"inotifywait "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"mrq "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"timefmt "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%d/%m/%y %H:%M"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"format "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%T %w%f"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"e delete"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"create "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"backup")]),l(`
`),s("span",{class:"line"})])])],-1),T=s("p",null,"2.测试close_write",-1),V=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"inotifywait"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-mrq"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--timefmt"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%d/%m/%y %H:%M"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--format"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%w%f"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"close_write"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/backup")]),l(`
`),s("span",{class:"line"})])])],-1),W=s("p",null,"3.打印出事件类型",-1),I=s("div",{class:"language-go"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"inotifywait "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"mrq "),s("span",{style:{color:"#89DDFF"}},"--"),s("span",{style:{color:"#A6ACCD"}},"format "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%w%f %e"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#A6ACCD"}},"e delete"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"create "),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"backup")]),l(`
`),s("span",{class:"line"})])])],-1),H={id:"_6-把客户端监控到情况出发rsync推送变化的文件",tabindex:"-1"},J=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#676E95","font-style":"italic"}},"#!/bin/bash ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Path"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#C3E88D"}},"/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"backup_Server"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#C3E88D"}},"172.16.1.41")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"export"),s("span",{style:{color:"#A6ACCD"}}," RSYNC_PASSWORD"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#F78C6C"}},"123456")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"/usr/bin/inotifywait"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-mrq"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--format"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"%w%f"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-e"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"create,close_write,delete"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#A6ACCD"}}," read line")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"line"),s("span",{style:{color:"#89DDFF"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"-f"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"line"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"then")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"       "),s("span",{style:{color:"#FFCB6B"}},"rsync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-az"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"line"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"rsync_backup@"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"backup_Server"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"::data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"else")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"       "),s("span",{style:{color:"#FFCB6B"}},"rsync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-az"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"--delete"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data/"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"rsync_backup@"),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"backup_Server"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},"::data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"fi")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1),R={id:"_7-inotify优缺点",tabindex:"-1"},Z=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"inotify优点")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},")监控文件系统事件变化")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"inotify缺点")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#A6ACCD"}},")并发如果大于200个文"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#F78C6C"}},"10"),s("span",{style:{color:"#A6ACCD"}},"-100k"),s("span",{style:{color:"#89DDFF"}},")"),s("span",{style:{color:"#A6ACCD"}},",同步就会由延迟")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"2"),s("span",{style:{color:"#A6ACCD"}},")我们前面的脚本,每次都是全部推送一次,但是确实是增量的,也可以只同步变化的文件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#A6ACCD"}},")监控到事件后,调用rsync同步是单进程"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#FFCB6B"}},"加"),s("span",{style:{color:"#89DDFF"}},"&"),s("span",{style:{color:"#FFCB6B"}},"并发"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"4"),s("span",{style:{color:"#A6ACCD"}},")我们自己写的脚本健壮性不高")]),l(`
`),s("span",{class:"line"})])])],-1),j={id:"第四章-sersync简介",tabindex:"-1"},G={id:"_1-sersync介绍",tabindex:"-1"},Y=s("p",null,"以下内容摘抄sersync作者官网的说明",-1),K=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sersync主要用于服务器同步"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"web镜像等功能.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"基于boost1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"41"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"0"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"inotify api"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"rsync command开发.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"目前使用的比较多的同步解决方案是inotify-tools"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}},"rsync")]),l(`
`),s("span",{class:"line"})])])],-1),Q={id:"_2-sersync优点",tabindex:"-1"},X=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"sersync是使用c"),s("span",{style:{color:"#89DDFF"}},"++"),s("span",{style:{color:"#A6ACCD"}},"编写"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"而且对linux系统文件系统产生的临时文件和重复的文件操作进行过滤(详细见附录"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"这个过滤脚本程序没有实现),所以结合rsync同步的时候"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"节省了运行时耗和网络资源"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"因此更快")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"相比较上面两个项目"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"sersync配置起来很简单"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"其中bin目录下已经有基本上静态编译的2进制文件"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"配合bin目录下的xml配置文件直接使用即可.")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"另外本项目相比较其他脚本开源项目"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"使用多线程进行同步"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"尤其在同步较大文件时"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"能够保证多个服务器保持同步状态")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"4"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"本项目有出错处理机制"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"通过失败队列对出错的文件重新同步"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"如果仍旧失败"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"则每10个小时对同步失败的文件重新同步")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"5"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"本项目自带crontab功能"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"只需在xml配置文件中开启"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"即可按照您的要求"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"隔一段时间整体同步一次"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"无须在额外配置crontab功能")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"6"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"本项目socket与http插件拓展"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#A6ACCD"}},"满足您二次开发的需要.")]),l(`
`),s("span",{class:"line"})])])],-1),ss={id:"第五章-sersync安装部署",tabindex:"-1"},ls={id:"_1-主机规划",tabindex:"-1"},os=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"nfs-server"),s("span",{style:{color:"#A6ACCD"}}," 172"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"16"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"31"),s("span",{style:{color:"#A6ACCD"}}," rsync"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}},"inotify"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}},"sersync  "),s("span",{style:{color:"#FFCB6B"}},"nfs-client")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"backup     172"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"16"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"1"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"41"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#FFCB6B"}},"rsync-server"),s("span",{style:{color:"#A6ACCD"}},"           "),s("span",{style:{color:"#FFCB6B"}},"nfs-server")]),l(`
`),s("span",{class:"line"})])])],-1),ns={id:"_2-安装sersync",tabindex:"-1"},es=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/opt/")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"wget"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"http://down.whsir.com/downloads/sersync2.5.4_64bit_binary_stable_final.tar.gz")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"tar"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"zxf"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"sersync2.5.4_64bit_binary_stable_final.tar.gz")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"mv"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"GNU-Linux-x86"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"sersync")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"sersync")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"cp"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"confxml.xml"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"confxml.xml.bak")]),l(`
`),s("span",{class:"line"})])])],-1),as={id:"_3-配置解释",tabindex:"-1"},ts=s("div",{class:"language-xml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#需要监控的目录      "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"localpath"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"watch"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}},"   ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#远程rsync服务器的IP地址和模块名称   "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"remote"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"ip"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"172.16.1.41"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"name"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}},"  ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#rsync传输的参数    "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"commonParams"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"params"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"-az"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#rsync密码文件路径  "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"auth"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"start"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"true"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"users"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"rsync_backup"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"passwordfile"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/etc/rsync.passwd"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>"),s("span",{style:{color:"#A6ACCD"}},"    #")]),l(`
`),s("span",{class:"line"})])])],-1),cs={id:"_4-配置文件修改",tabindex:"-1"},rs=s("div",{class:"language-xml"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 23     "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"sersync"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 24         "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"localpath"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"watch"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 25             "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"remote"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"ip"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"172.16.1.41"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"name"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 26             "),s("span",{style:{color:"#676E95","font-style":"italic"}},'<!--<remote ip="192.168.8.39" name="tongbu"/>-->')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 27             "),s("span",{style:{color:"#676E95","font-style":"italic"}},'<!--<remote ip="192.168.8.40" name="tongbu"/>-->')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 28         "),s("span",{style:{color:"#89DDFF"}},"</"),s("span",{style:{color:"#F07178"}},"localpath"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 29         "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"rsync"),s("span",{style:{color:"#89DDFF"}},">")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 30             "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"commonParams"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"params"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"-az"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," 31             "),s("span",{style:{color:"#89DDFF"}},"<"),s("span",{style:{color:"#F07178"}},"auth"),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"start"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"true"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"users"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"rsync_backup"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}}," "),s("span",{style:{color:"#C792EA"}},"passwordfile"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/etc/rsync.passwd"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},"/>")]),l(`
`),s("span",{class:"line"})])])],-1),ps={id:"_5-查看帮助说明",tabindex:"-1"},ys=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@nfs /opt/sersync"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# ./sersync2 -h")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"set"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"the"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"system"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"param")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"execute："),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"50000000"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/proc/sys/fs/inotify/max_user_watches")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"execute："),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"327679"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/proc/sys/fs/inotify/max_queued_events")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"parse"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"the"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"command"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"param")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"_______________________________________________________")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-d:启用守护进程模式")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-r:在监控前，将监控目录与远程主机用rsync命令推送一遍")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"c参数-n:"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"指定开启守护线程的数量，默认为10个")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-o:指定配置文件，默认使用confxml.xml文件")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-m:单独启用其他模块，使用"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-m"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"refreshCDN"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"开启刷新CDN模块")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-m:单独启用其他模块，使用"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-m"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"socket"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"开启socket模块")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"参数-m:单独启用其他模块，使用"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-m"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"http"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"开启http模块")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"不加-m参数，则默认执行同步程序")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"________________________________________________________________")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@nfs /opt/sersync"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#A6ACCD"}},"# ")]),l(`
`),s("span",{class:"line"})])])],-1),Ds={id:"_6-启动服务",tabindex:"-1"},Cs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"/sersync2"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-rdo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"confxml.xml")]),l(`
`),s("span",{class:"line"})])])],-1),is={id:"_7-测试数据是否同步",tabindex:"-1"},Fs=s("p",null,"backup服务器操作：",-1),As=s("p",null,"1秒查看一下/data目录下文件的个数",-1),ds=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do"),s("span",{style:{color:"#A6ACCD"}}," ls "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#FFCB6B"}},"wc"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-l"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#FFCB6B"}},"sleep"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0.1"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1),_s=s("p",null,"nfs服务端操作：",-1),hs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," i "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#A6ACCD"}},"1..1000"),s("span",{style:{color:"#89DDFF"}},"};"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do"),s("span",{style:{color:"#A6ACCD"}}," echo"),s("span",{style:{color:"#89DDFF"}},' "${'),s("span",{style:{color:"#C3E88D"}},"i"),s("span",{style:{color:"#89DDFF"}},'}"'),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"i"),s("span",{style:{color:"#89DDFF"}},'}"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"i"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},".txt"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#FFCB6B"}},"sleep"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0.1"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1),us={id:"第六章-lsyncd同步",tabindex:"-1"},fs={id:"_1-官方地址",tabindex:"-1"},Es=s("div",{class:"language-cpp"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https:"),s("span",{style:{color:"#676E95","font-style":"italic"}},"//github.com/axkibe/lsyncd](https://github.com/axkibe/lsyncd")]),l(`
`),s("span",{class:"line"})])])],-1),Bs={id:"_2-lsyncd介绍",tabindex:"-1"},gs=s("div",{class:"language-css"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Lysncd 实际上是lua语言封装了 inotify 和 rsync 工具，采用了 Linux 内核（2"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"6"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#FFCB6B"}},"13"),s("span",{style:{color:"#A6ACCD"}}," 及以后）里的 inotify 触发机制，然后通过rsync去差异同步，达到实时的效果。")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"它最令人称道的特性是，完美解决了 `inotify "),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#A6ACCD"}}," rsync`海量文件同步带来的文件频繁发送文件列表的问题 —— 通过时间延迟或累计触发事件次数实现。")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"另外，它的配置方式很简单，lua本身就是一种配置语言，可读性非常强。lsyncd也有多种工作模式可以选择，本地目录cp，本地目录rsync，远程目录rsyncssh。")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"实现简单高效的本地目录同步备份（网络存储挂载也当作本地目录），一个命令搞定。")]),l(`
`),s("span",{class:"line"})])])],-1),ms={id:"_3-lsyncd安装",tabindex:"-1"},vs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"yum"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"install"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"lsyncd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-y")]),l(`
`),s("span",{class:"line"})])])],-1),bs={id:"_4-创建配置文件",tabindex:"-1"},ks=s("p",null,"只监控1个目录",-1),xs=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@nfs "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#A6ACCD"}},"# cat /etc/lsyncd.conf")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"settings"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"logfile"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/var/log/lsyncd/lsyncd.log"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"statusFile"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/var/log/lsyncd/lsyncd.status"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"inotifyMode"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"CloseWrite"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"maxProcesses"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"sync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"default.rsync,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"target"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"rsync_backup@172.16.1.41::data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"exclude"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},".*"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"},")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delay"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"rsync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"binary"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/usr/bin/rsync"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"archive"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"compress"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"verbose"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"password_file"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/etc/rsync.passwd"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"_extra"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"--bwlimit=200"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"})])])],-1),ws=s("p",null,"监控2个目录",-1),$s=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#A6ACCD"}},"root@nfs "),s("span",{style:{color:"#89DDFF"}},"~]"),s("span",{style:{color:"#A6ACCD"}},"# cat /etc/lsyncd.conf")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"settings"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"logfile"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/var/log/lsyncd/lsyncd.log"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"statusFile"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/var/log/lsyncd/lsyncd.status"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"inotifyMode"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"CloseWrite"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"maxProcesses"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"8"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"sync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"default.rsync,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"target"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"rsync_backup@172.16.1.41::data"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"exclude"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},".*"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"},")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delay"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"rsync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"binary"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/usr/bin/rsync"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"archive"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"compress"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"verbose"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"password_file"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/etc/rsync.passwd"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"_extra"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"--bwlimit=200"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"sync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"default.rsync,")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#82AAFF"}},"source"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/backup"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"target"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"rsync_backup@172.16.1.41::backup"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delete"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"exclude"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},".*"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"},")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"delay"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"1"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  "),s("span",{style:{color:"#FFCB6B"}},"rsync"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"binary"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/usr/bin/rsync"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"archive"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"compress"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"verbose"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"password_file"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"/etc/rsync.passwd"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},",")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    "),s("span",{style:{color:"#FFCB6B"}},"_extra"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"="),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"{"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"--bwlimit=200"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  }")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),l(`
`),s("span",{class:"line"})])])],-1),Ss={id:"_5-配置文件解释",tabindex:"-1"},qs=s("p",null,"参考网友博客",-1),Ns=s("div",{class:"language-ruby"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF"}},"https:"),s("span",{style:{color:"#89DDFF"}},"//"),s("span",{style:{color:"#A6ACCD"}},"www"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"cnblogs"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"com"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#A6ACCD"}},"zxci"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#82AAFF"}},"p"),s("span",{style:{color:"#89DDFF"}},"/"),s("span",{style:{color:"#F78C6C"}},"6243574"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#A6ACCD"}},"html")]),l(`
`),s("span",{class:"line"})])])],-1),Ls={id:"_6-启动命令",tabindex:"-1"},Ps=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"systemctl"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"start"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"lsyncd"),s("span",{style:{color:"#A6ACCD"}}," ")]),l(`
`),s("span",{class:"line"})])])],-1),zs={id:"_7-检查测试",tabindex:"-1"},Ms=s("p",null,"backup测试",-1),Os=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"while"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"true"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do"),s("span",{style:{color:"#A6ACCD"}}," ls "),s("span",{style:{color:"#89DDFF"}},"|"),s("span",{style:{color:"#FFCB6B"}},"wc"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"-l"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#FFCB6B"}},"sleep"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0.1"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1),Us=s("p",null,"NFS测试",-1),Ts=s("div",{class:"language-bash"},[s("span",{class:"copy"}),s("pre",{class:"shiki material-palenight"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#82AAFF"}},"cd"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#C3E88D"}},"/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"for"),s("span",{style:{color:"#A6ACCD"}}," i "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"in"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"{"),s("span",{style:{color:"#A6ACCD"}},"1..1000"),s("span",{style:{color:"#89DDFF"}},"};"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"do"),s("span",{style:{color:"#A6ACCD"}}," echo"),s("span",{style:{color:"#89DDFF"}},' "${'),s("span",{style:{color:"#C3E88D"}},"i"),s("span",{style:{color:"#89DDFF"}},'}"'),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#82AAFF"}},"echo"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},'"${'),s("span",{style:{color:"#C3E88D"}},"i"),s("span",{style:{color:"#89DDFF"}},'}"'),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},">"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#89DDFF"}},"${"),s("span",{style:{color:"#A6ACCD"}},"i"),s("span",{style:{color:"#89DDFF"}},"}"),s("span",{style:{color:"#C3E88D"}},".txt"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#FFCB6B"}},"sleep"),s("span",{style:{color:"#A6ACCD"}}," "),s("span",{style:{color:"#F78C6C"}},"0.1"),s("span",{style:{color:"#89DDFF"}},";"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"done")]),l(`
`),s("span",{class:"line"})])])],-1);function Vs(a,Ws,Is,Hs,r,Js){const n=F,p=y;return i(),C(p,{frontmatter:r.frontmatter,data:r.data},{"main-content-md":o(()=>[s("h1",_,[l("第一章 为什么需要实时同步 "),e(n,{class:"header-anchor",href:"#第一章-为什么需要实时同步","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h2",h,[l("1.第二阶段实时同步解决了什么问题: "),e(n,{class:"header-anchor",href:"#_1-第二阶段实时同步解决了什么问题","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),u,s("h2",f,[l("2.实时同步难点 "),e(n,{class:"header-anchor",href:"#_2-实时同步难点","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),E,s("h1",B,[l("第二章 inotify简介 "),e(n,{class:"header-anchor",href:"#第二章-inotify简介","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),g,m,v,s("h1",b,[l("第三章 Inotify实时同步 "),e(n,{class:"header-anchor",href:"#第三章-inotify实时同步","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h2",k,[l("1.查看当前系统是否支持inotify "),e(n,{class:"header-anchor",href:"#_1-查看当前系统是否支持inotify","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),x,s("h2",w,[l("2.安装inotify-tools "),e(n,{class:"header-anchor",href:"#_2-安装inotify-tools","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),$,s("h2",S,[l("3.inotifywait详细参数解释 "),e(n,{class:"header-anchor",href:"#_3-inotifywait详细参数解释","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),q,s("h2",N,[l("4.查看inotify默认参数 "),e(n,{class:"header-anchor",href:"#_4-查看inotify默认参数","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),L,s("h2",P,[l("5.针对上述命令进行测试 "),e(n,{class:"header-anchor",href:"#_5-针对上述命令进行测试","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),z,M,O,U,T,V,W,I,s("h2",H,[l("6.把客户端监控到情况出发rsync推送变化的文件 "),e(n,{class:"header-anchor",href:"#_6-把客户端监控到情况出发rsync推送变化的文件","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),J,s("h2",R,[l("7.inotify优缺点 "),e(n,{class:"header-anchor",href:"#_7-inotify优缺点","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Z,s("h1",j,[l("第四章 sersync简介 "),e(n,{class:"header-anchor",href:"#第四章-sersync简介","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h2",G,[l("1.sersync介绍 "),e(n,{class:"header-anchor",href:"#_1-sersync介绍","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Y,K,s("h2",Q,[l("2.sersync优点 "),e(n,{class:"header-anchor",href:"#_2-sersync优点","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),X,s("h1",ss,[l("第五章 sersync安装部署 "),e(n,{class:"header-anchor",href:"#第五章-sersync安装部署","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h2",ls,[l("1.主机规划 "),e(n,{class:"header-anchor",href:"#_1-主机规划","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),os,s("h2",ns,[l("2.安装sersync "),e(n,{class:"header-anchor",href:"#_2-安装sersync","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),es,s("h2",as,[l("3.配置解释 "),e(n,{class:"header-anchor",href:"#_3-配置解释","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ts,s("h2",cs,[l("4.配置文件修改 "),e(n,{class:"header-anchor",href:"#_4-配置文件修改","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),rs,s("h2",ps,[l("5.查看帮助说明 "),e(n,{class:"header-anchor",href:"#_5-查看帮助说明","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ys,s("h2",Ds,[l("6.启动服务 "),e(n,{class:"header-anchor",href:"#_6-启动服务","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Cs,s("h2",is,[l("7.测试数据是否同步 "),e(n,{class:"header-anchor",href:"#_7-测试数据是否同步","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Fs,As,ds,_s,hs,s("h1",us,[l("第六章 lsyncd同步 "),e(n,{class:"header-anchor",href:"#第六章-lsyncd同步","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),s("h2",fs,[l("1.官方地址 "),e(n,{class:"header-anchor",href:"#_1-官方地址","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Es,s("h2",Bs,[l("2.lsyncd介绍 "),e(n,{class:"header-anchor",href:"#_2-lsyncd介绍","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),gs,s("h2",ms,[l("3.lsyncd安装 "),e(n,{class:"header-anchor",href:"#_3-lsyncd安装","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),vs,s("h2",bs,[l("4.创建配置文件 "),e(n,{class:"header-anchor",href:"#_4-创建配置文件","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),ks,xs,ws,$s,s("h2",Ss,[l("5.配置文件解释 "),e(n,{class:"header-anchor",href:"#_5-配置文件解释","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),qs,Ns,s("h2",Ls,[l("6.启动命令 "),e(n,{class:"header-anchor",href:"#_6-启动命令","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ps,s("h2",zs,[l("7.检查测试 "),e(n,{class:"header-anchor",href:"#_7-检查测试","aria-hidden":"true"},{default:o(()=>[l("#")]),_:1})]),Ms,Os,Us,Ts]),"main-header":o(()=>[t(a.$slots,"main-header")]),"main-header-after":o(()=>[t(a.$slots,"main-header-after")]),"main-nav":o(()=>[t(a.$slots,"main-nav")]),"main-content":o(()=>[t(a.$slots,"main-content")]),"main-content-after":o(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":o(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":o(()=>[t(a.$slots,"main-nav-after")]),comment:o(()=>[t(a.$slots,"comment")]),footer:o(()=>[t(a.$slots,"footer")]),aside:o(()=>[t(a.$slots,"aside")]),"aside-custom":o(()=>[t(a.$slots,"aside-custom")]),default:o(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const Qs=D(d,[["render",Vs]]);export{Ks as __pageData,Qs as default};
