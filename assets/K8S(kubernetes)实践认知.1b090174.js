import{_ as r}from"./ValaxyMain.vue_vue_type_style_index_0_lang.437d393b.js";import{_ as i,c as p,w as l,o as A,r as a,g as s,R as n,p as C}from"./app.902f16e8.js";import"./YunFooter.vue_vue_type_script_setup_true_lang.d07e2c3f.js";import"./YunCard.vue_vue_type_style_index_0_lang.8b0ee1ff.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.6f9bc592.js";const wi=JSON.parse('{"title":"K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5","description":"","frontmatter":{"title":"K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5","categories":"DevOps","tags":["K8s"],"date":"2020-03-09T09:16:00.000Z"},"headers":[{"level":2,"title":"Kubernetes\u67B6\u6784\u4ECB\u7ECD","slug":"kubernetes\u67B6\u6784\u4ECB\u7ECD","link":"#kubernetes\u67B6\u6784\u4ECB\u7ECD","children":[{"level":3,"title":"Kubernetes\u7CFB\u7EDF\u67B6\u6784","slug":"kubernetes\u7CFB\u7EDF\u67B6\u6784","link":"#kubernetes\u7CFB\u7EDF\u67B6\u6784","children":[]},{"level":3,"title":"Kubernetes\u903B\u8F91\u67B6\u6784","slug":"kubernetes\u903B\u8F91\u67B6\u6784","link":"#kubernetes\u903B\u8F91\u67B6\u6784","children":[]},{"level":3,"title":"Kubernetes\u7F51\u7EDC\u4ECB\u7ECD","slug":"kubernetes\u7F51\u7EDC\u4ECB\u7ECD","link":"#kubernetes\u7F51\u7EDC\u4ECB\u7ECD","children":[]}]},{"level":2,"title":"\u4F7F\u7528kubeadm\u90E8\u7F72Kubernetes v1.16.4","slug":"\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4","link":"#\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4","children":[{"level":3,"title":"\u90E8\u7F72Docker","slug":"\u90E8\u7F72docker","link":"#\u90E8\u7F72docker","children":[]},{"level":3,"title":"\u90E8\u7F72kubadm\u548Ckubelet","slug":"\u90E8\u7F72kubadm\u548Ckubelet","link":"#\u90E8\u7F72kubadm\u548Ckubelet","children":[]},{"level":3,"title":"\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72Master","slug":"\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master","link":"#\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master","children":[]},{"level":3,"title":"\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","slug":"\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","link":"#\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","children":[]},{"level":3,"title":"\u90E8\u7F72Node\u8282\u70B9","slug":"\u90E8\u7F72node\u8282\u70B9","link":"#\u90E8\u7F72node\u8282\u70B9","children":[]}]},{"level":2,"title":"\u516C\u6709\u4E91\u4E2D\u7684Kubernetes","slug":"\u516C\u6709\u4E91\u4E2D\u7684kubernetes","link":"#\u516C\u6709\u4E91\u4E2D\u7684kubernetes","children":[{"level":3,"title":"\u963F\u91CC\u4E91\u4E2D\u7684Kubernetes","slug":"\u963F\u91CC\u4E91\u4E2D\u7684kubernetes","link":"#\u963F\u91CC\u4E91\u4E2D\u7684kubernetes","children":[]},{"level":3,"title":"\u79C1\u6709\u4E91\u4E2D\u7684Kubernetes","slug":"\u79C1\u6709\u4E91\u4E2D\u7684kubernetes","link":"#\u79C1\u6709\u4E91\u4E2D\u7684kubernetes","children":[]}]},{"level":2,"title":"\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","slug":"\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","link":"#\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","children":[{"level":3,"title":"\u90E8\u7F72Harbor\u955C\u50CF\u4ED3\u5E93","slug":"\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93","link":"#\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93","children":[]},{"level":3,"title":"\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684Docker\u955C\u50CF","slug":"\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF","link":"#\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF","children":[]},{"level":3,"title":"\u914D\u7F6EDocker\u4ED3\u5E93","slug":"\u914D\u7F6Edocker\u4ED3\u5E93","link":"#\u914D\u7F6Edocker\u4ED3\u5E93","children":[]},{"level":3,"title":"\u767B\u5F55Harbor\u955C\u50CF\u4ED3\u5E93","slug":"\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93","link":"#\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93","children":[]},{"level":3,"title":"\u63D0\u4EA4\u955C\u50CF\u5230Registry","slug":"\u63D0\u4EA4\u955C\u50CF\u5230registry","link":"#\u63D0\u4EA4\u955C\u50CF\u5230registry","children":[]}]},{"level":2,"title":"Pod\u7BA1\u7406","slug":"pod\u7BA1\u7406","link":"#pod\u7BA1\u7406","children":[{"level":3,"title":"\u521B\u5EFAService","slug":"\u521B\u5EFAservice","link":"#\u521B\u5EFAservice","children":[]},{"level":3,"title":"\u521B\u5EFA\u4E00\u4E2AHeadless Service","slug":"\u521B\u5EFA\u4E00\u4E2Aheadless-service","link":"#\u521B\u5EFA\u4E00\u4E2Aheadless-service","children":[]}]},{"level":2,"title":"10.1 Ingress Controller","slug":"_10-1-ingress-controller","link":"#_10-1-ingress-controller","children":[]},{"level":2,"title":"Ingress Controller Traefik","slug":"ingress-controller-traefik","link":"#ingress-controller-traefik","children":[{"level":3,"title":"\u90E8\u7F72Treafik","slug":"\u90E8\u7F72treafik","link":"#\u90E8\u7F72treafik","children":[]}]},{"level":2,"title":"7.1 Rancher\u5FEB\u901F\u5165\u95E8","slug":"_7-1-rancher\u5FEB\u901F\u5165\u95E8","link":"#_7-1-rancher\u5FEB\u901F\u5165\u95E8","children":[]},{"level":2,"title":"7.2 \u4F7F\u7528Rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","slug":"_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","link":"#_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","children":[]},{"level":2,"title":"7.3 Rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","slug":"_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","link":"#_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","children":[{"level":3,"title":"Liveness\u63A2\u6D4B","slug":"liveness\u63A2\u6D4B","link":"#liveness\u63A2\u6D4B","children":[]},{"level":3,"title":"Readiness\u63A2\u6D4B","slug":"readiness\u63A2\u6D4B","link":"#readiness\u63A2\u6D4B","children":[]}]},{"level":2,"title":"\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","slug":"\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","link":"#\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","children":[{"level":3,"title":"Pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","slug":"pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","link":"#pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","children":[]}]},{"level":2,"title":"\u5E94\u7528\u7684DNS\u7BA1\u7406","slug":"\u5E94\u7528\u7684dns\u7BA1\u7406-1","link":"#\u5E94\u7528\u7684dns\u7BA1\u7406-1","children":[]},{"level":2,"title":"15.1 \u4F7F\u7528ConfigMap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","slug":"_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","link":"#_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","children":[{"level":3,"title":"\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7YAML\u6587\u4EF6\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u4ECE\u76EE\u5F55\u521B\u5EFAConfigMap","slug":"\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap","link":"#\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u6DF7\u5408\u9009\u9879\u521B\u5EFAConfigMap","slug":"\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap","link":"#\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012ConfigMap","slug":"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap","link":"#\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap","children":[]}]},{"level":2,"title":"15.2 \u4F7F\u7528Secret\u7BA1\u7406\u654F\u611F\u6570\u636E","slug":"_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E","link":"#_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E","children":[{"level":3,"title":"\u914D\u7F6EPod\u4F7F\u7528Harbor\u955C\u50CF","slug":"\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF","link":"#\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF","children":[]}]},{"level":2,"title":"Helm\u90E8\u7F72","slug":"helm\u90E8\u7F72","link":"#helm\u90E8\u7F72","children":[{"level":3,"title":"\u5B89\u88C5Helm","slug":"\u5B89\u88C5helm","link":"#\u5B89\u88C5helm","children":[]},{"level":3,"title":"\u4F7F\u7528Helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","slug":"\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","link":"#\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","children":[]},{"level":3,"title":"Helm\u7EC4\u4EF6","slug":"helm\u7EC4\u4EF6","link":"#helm\u7EC4\u4EF6","children":[]},{"level":3,"title":"\u81EA\u5B9A\u4E49Jenkins\u7684Chart","slug":"\u81EA\u5B9A\u4E49jenkins\u7684chart","link":"#\u81EA\u5B9A\u4E49jenkins\u7684chart","children":[]}]},{"level":2,"title":"\u521B\u5EFA\u81EA\u5DF1\u7684Chart","slug":"\u521B\u5EFA\u81EA\u5DF1\u7684chart","link":"#\u521B\u5EFA\u81EA\u5DF1\u7684chart","children":[{"level":3,"title":"\u521B\u5EFA\u81EA\u5B9A\u4E49Nginx\u7684Chart","slug":"\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart","link":"#\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart","children":[]},{"level":3,"title":"\u67E5\u770BHelm\u5B9E\u4F8B","slug":"\u67E5\u770Bhelm\u5B9E\u4F8B","link":"#\u67E5\u770Bhelm\u5B9E\u4F8B","children":[]}]},{"level":2,"title":"Prometheus\u5FEB\u901F\u5165\u95E8","slug":"prometheus\u5FEB\u901F\u5165\u95E8","link":"#prometheus\u5FEB\u901F\u5165\u95E8","children":[{"level":3,"title":"Prometheus\u67B6\u6784\u4ECB\u7ECD","slug":"prometheus\u67B6\u6784\u4ECB\u7ECD","link":"#prometheus\u67B6\u6784\u4ECB\u7ECD","children":[]},{"level":3,"title":"\u5B89\u88C5Prometheus","slug":"\u5B89\u88C5prometheus","link":"#\u5B89\u88C5prometheus","children":[]},{"level":3,"title":"\u4F7F\u7528Node Exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","slug":"\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","link":"#\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","children":[]},{"level":3,"title":"\u4F7F\u7528Prometheus UI\u67E5\u770B\u6570\u636E","slug":"\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E","link":"#\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E","children":[]},{"level":3,"title":"\u4F7F\u7528Grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","slug":"\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","link":"#\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","children":[]}]},{"level":2,"title":"Taints\uFF08\u6C61\u70B9\uFF09","slug":"taints\uFF08\u6C61\u70B9\uFF09","link":"#taints\uFF08\u6C61\u70B9\uFF09","children":[{"level":3,"title":"\u81EA\u5B9A\u4E49\u6C61\u70B9","slug":"\u81EA\u5B9A\u4E49\u6C61\u70B9","link":"#\u81EA\u5B9A\u4E49\u6C61\u70B9","children":[]}]},{"level":2,"title":"\u4EB2\u7F18\u6027\u8C03\u5EA6","slug":"\u4EB2\u7F18\u6027\u8C03\u5EA6","link":"#\u4EB2\u7F18\u6027\u8C03\u5EA6","children":[{"level":3,"title":"\u4F7F\u7528Swagger UI\u8FDB\u884CAPI\u4EA4\u4E92","slug":"\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92","link":"#\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92","children":[]}]}],"relativePath":"pages/posts/K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5.md","lastUpdated":0}'),o=JSON.parse('{"title":"K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5","description":"","frontmatter":{"title":"K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5","categories":"DevOps","tags":["K8s"],"date":"2020-03-09T09:16:00.000Z"},"headers":[{"level":2,"title":"Kubernetes\u67B6\u6784\u4ECB\u7ECD","slug":"kubernetes\u67B6\u6784\u4ECB\u7ECD","link":"#kubernetes\u67B6\u6784\u4ECB\u7ECD","children":[{"level":3,"title":"Kubernetes\u7CFB\u7EDF\u67B6\u6784","slug":"kubernetes\u7CFB\u7EDF\u67B6\u6784","link":"#kubernetes\u7CFB\u7EDF\u67B6\u6784","children":[]},{"level":3,"title":"Kubernetes\u903B\u8F91\u67B6\u6784","slug":"kubernetes\u903B\u8F91\u67B6\u6784","link":"#kubernetes\u903B\u8F91\u67B6\u6784","children":[]},{"level":3,"title":"Kubernetes\u7F51\u7EDC\u4ECB\u7ECD","slug":"kubernetes\u7F51\u7EDC\u4ECB\u7ECD","link":"#kubernetes\u7F51\u7EDC\u4ECB\u7ECD","children":[]}]},{"level":2,"title":"\u4F7F\u7528kubeadm\u90E8\u7F72Kubernetes v1.16.4","slug":"\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4","link":"#\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4","children":[{"level":3,"title":"\u90E8\u7F72Docker","slug":"\u90E8\u7F72docker","link":"#\u90E8\u7F72docker","children":[]},{"level":3,"title":"\u90E8\u7F72kubadm\u548Ckubelet","slug":"\u90E8\u7F72kubadm\u548Ckubelet","link":"#\u90E8\u7F72kubadm\u548Ckubelet","children":[]},{"level":3,"title":"\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72Master","slug":"\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master","link":"#\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master","children":[]},{"level":3,"title":"\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","slug":"\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","link":"#\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","children":[]},{"level":3,"title":"\u90E8\u7F72Node\u8282\u70B9","slug":"\u90E8\u7F72node\u8282\u70B9","link":"#\u90E8\u7F72node\u8282\u70B9","children":[]}]},{"level":2,"title":"\u516C\u6709\u4E91\u4E2D\u7684Kubernetes","slug":"\u516C\u6709\u4E91\u4E2D\u7684kubernetes","link":"#\u516C\u6709\u4E91\u4E2D\u7684kubernetes","children":[{"level":3,"title":"\u963F\u91CC\u4E91\u4E2D\u7684Kubernetes","slug":"\u963F\u91CC\u4E91\u4E2D\u7684kubernetes","link":"#\u963F\u91CC\u4E91\u4E2D\u7684kubernetes","children":[]},{"level":3,"title":"\u79C1\u6709\u4E91\u4E2D\u7684Kubernetes","slug":"\u79C1\u6709\u4E91\u4E2D\u7684kubernetes","link":"#\u79C1\u6709\u4E91\u4E2D\u7684kubernetes","children":[]}]},{"level":2,"title":"\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","slug":"\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","link":"#\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","children":[{"level":3,"title":"\u90E8\u7F72Harbor\u955C\u50CF\u4ED3\u5E93","slug":"\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93","link":"#\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93","children":[]},{"level":3,"title":"\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684Docker\u955C\u50CF","slug":"\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF","link":"#\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF","children":[]},{"level":3,"title":"\u914D\u7F6EDocker\u4ED3\u5E93","slug":"\u914D\u7F6Edocker\u4ED3\u5E93","link":"#\u914D\u7F6Edocker\u4ED3\u5E93","children":[]},{"level":3,"title":"\u767B\u5F55Harbor\u955C\u50CF\u4ED3\u5E93","slug":"\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93","link":"#\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93","children":[]},{"level":3,"title":"\u63D0\u4EA4\u955C\u50CF\u5230Registry","slug":"\u63D0\u4EA4\u955C\u50CF\u5230registry","link":"#\u63D0\u4EA4\u955C\u50CF\u5230registry","children":[]}]},{"level":2,"title":"Pod\u7BA1\u7406","slug":"pod\u7BA1\u7406","link":"#pod\u7BA1\u7406","children":[{"level":3,"title":"\u521B\u5EFAService","slug":"\u521B\u5EFAservice","link":"#\u521B\u5EFAservice","children":[]},{"level":3,"title":"\u521B\u5EFA\u4E00\u4E2AHeadless Service","slug":"\u521B\u5EFA\u4E00\u4E2Aheadless-service","link":"#\u521B\u5EFA\u4E00\u4E2Aheadless-service","children":[]}]},{"level":2,"title":"10.1 Ingress Controller","slug":"_10-1-ingress-controller","link":"#_10-1-ingress-controller","children":[]},{"level":2,"title":"Ingress Controller Traefik","slug":"ingress-controller-traefik","link":"#ingress-controller-traefik","children":[{"level":3,"title":"\u90E8\u7F72Treafik","slug":"\u90E8\u7F72treafik","link":"#\u90E8\u7F72treafik","children":[]}]},{"level":2,"title":"7.1 Rancher\u5FEB\u901F\u5165\u95E8","slug":"_7-1-rancher\u5FEB\u901F\u5165\u95E8","link":"#_7-1-rancher\u5FEB\u901F\u5165\u95E8","children":[]},{"level":2,"title":"7.2 \u4F7F\u7528Rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","slug":"_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","link":"#_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","children":[]},{"level":2,"title":"7.3 Rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","slug":"_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","link":"#_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","children":[{"level":3,"title":"Liveness\u63A2\u6D4B","slug":"liveness\u63A2\u6D4B","link":"#liveness\u63A2\u6D4B","children":[]},{"level":3,"title":"Readiness\u63A2\u6D4B","slug":"readiness\u63A2\u6D4B","link":"#readiness\u63A2\u6D4B","children":[]}]},{"level":2,"title":"\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","slug":"\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","link":"#\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","children":[{"level":3,"title":"Pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","slug":"pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","link":"#pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","children":[]}]},{"level":2,"title":"\u5E94\u7528\u7684DNS\u7BA1\u7406","slug":"\u5E94\u7528\u7684dns\u7BA1\u7406-1","link":"#\u5E94\u7528\u7684dns\u7BA1\u7406-1","children":[]},{"level":2,"title":"15.1 \u4F7F\u7528ConfigMap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","slug":"_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","link":"#_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","children":[{"level":3,"title":"\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7YAML\u6587\u4EF6\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAConfigMap","slug":"\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap","link":"#\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u4ECE\u76EE\u5F55\u521B\u5EFAConfigMap","slug":"\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap","link":"#\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u6DF7\u5408\u9009\u9879\u521B\u5EFAConfigMap","slug":"\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap","link":"#\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap","children":[]},{"level":3,"title":"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012ConfigMap","slug":"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap","link":"#\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap","children":[]}]},{"level":2,"title":"15.2 \u4F7F\u7528Secret\u7BA1\u7406\u654F\u611F\u6570\u636E","slug":"_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E","link":"#_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E","children":[{"level":3,"title":"\u914D\u7F6EPod\u4F7F\u7528Harbor\u955C\u50CF","slug":"\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF","link":"#\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF","children":[]}]},{"level":2,"title":"Helm\u90E8\u7F72","slug":"helm\u90E8\u7F72","link":"#helm\u90E8\u7F72","children":[{"level":3,"title":"\u5B89\u88C5Helm","slug":"\u5B89\u88C5helm","link":"#\u5B89\u88C5helm","children":[]},{"level":3,"title":"\u4F7F\u7528Helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","slug":"\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","link":"#\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","children":[]},{"level":3,"title":"Helm\u7EC4\u4EF6","slug":"helm\u7EC4\u4EF6","link":"#helm\u7EC4\u4EF6","children":[]},{"level":3,"title":"\u81EA\u5B9A\u4E49Jenkins\u7684Chart","slug":"\u81EA\u5B9A\u4E49jenkins\u7684chart","link":"#\u81EA\u5B9A\u4E49jenkins\u7684chart","children":[]}]},{"level":2,"title":"\u521B\u5EFA\u81EA\u5DF1\u7684Chart","slug":"\u521B\u5EFA\u81EA\u5DF1\u7684chart","link":"#\u521B\u5EFA\u81EA\u5DF1\u7684chart","children":[{"level":3,"title":"\u521B\u5EFA\u81EA\u5B9A\u4E49Nginx\u7684Chart","slug":"\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart","link":"#\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart","children":[]},{"level":3,"title":"\u67E5\u770BHelm\u5B9E\u4F8B","slug":"\u67E5\u770Bhelm\u5B9E\u4F8B","link":"#\u67E5\u770Bhelm\u5B9E\u4F8B","children":[]}]},{"level":2,"title":"Prometheus\u5FEB\u901F\u5165\u95E8","slug":"prometheus\u5FEB\u901F\u5165\u95E8","link":"#prometheus\u5FEB\u901F\u5165\u95E8","children":[{"level":3,"title":"Prometheus\u67B6\u6784\u4ECB\u7ECD","slug":"prometheus\u67B6\u6784\u4ECB\u7ECD","link":"#prometheus\u67B6\u6784\u4ECB\u7ECD","children":[]},{"level":3,"title":"\u5B89\u88C5Prometheus","slug":"\u5B89\u88C5prometheus","link":"#\u5B89\u88C5prometheus","children":[]},{"level":3,"title":"\u4F7F\u7528Node Exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","slug":"\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","link":"#\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","children":[]},{"level":3,"title":"\u4F7F\u7528Prometheus UI\u67E5\u770B\u6570\u636E","slug":"\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E","link":"#\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E","children":[]},{"level":3,"title":"\u4F7F\u7528Grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","slug":"\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","link":"#\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","children":[]}]},{"level":2,"title":"Taints\uFF08\u6C61\u70B9\uFF09","slug":"taints\uFF08\u6C61\u70B9\uFF09","link":"#taints\uFF08\u6C61\u70B9\uFF09","children":[{"level":3,"title":"\u81EA\u5B9A\u4E49\u6C61\u70B9","slug":"\u81EA\u5B9A\u4E49\u6C61\u70B9","link":"#\u81EA\u5B9A\u4E49\u6C61\u70B9","children":[]}]},{"level":2,"title":"\u4EB2\u7F18\u6027\u8C03\u5EA6","slug":"\u4EB2\u7F18\u6027\u8C03\u5EA6","link":"#\u4EB2\u7F18\u6027\u8C03\u5EA6","children":[{"level":3,"title":"\u4F7F\u7528Swagger UI\u8FDB\u884CAPI\u4EA4\u4E92","slug":"\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92","link":"#\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92","children":[]}]}],"relativePath":"pages/posts/K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5.md","path":"/Users/vlinux/vlinux/blog/valaxy/valaxy-vlinux/pages/posts/K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5.md","lastUpdated":0}'),d={name:"pages/posts/K8S(kubernetes)\u5B9E\u8DF5\u8BA4\u77E5.md",data(){return{data:o,frontmatter:o.frontmatter}},setup(){C("pageData",o)}},u=s("h1",{id:"kubernetes\u5FEB\u901F\u5165\u95E8",tabindex:"-1"},[n("Kubernetes\u5FEB\u901F\u5165\u95E8 "),s("a",{class:"header-anchor",href:"#kubernetes\u5FEB\u901F\u5165\u95E8","aria-hidden":"true"},"#")],-1),y=s("p",null,"\u5B66\u4E60Kubernetes\u6700\u6743\u5A01\u7684\u77E5\u8BC6\u6765\u6E90\u5C31\u662FKubernetes\u5B98\u65B9\u6587\u6863\uFF0C\u800C\u4E14\u5BF9\u4E8E\u521D\u5B66\u8005\u6765\u8BF4\uFF0C\u5B98\u65B9\u6587\u6863\u53EF\u80FD\u4E0D\u662F\u6700\u4F73\u9009\u62E9\u3002\u672C\u7AE0\u5C06\u5E26\u4F60\u5FAA\u5FAA\u5E8F\u6E10\u8FDB\u7684\u5B66\u4E60Kubernetes\uFF0C\u540E\u9762\u7AE0\u8282\u4F1A\u901A\u8FC7\u5927\u91CF\u7684\u5B9E\u8DF5\u6848\u4F8B\u6765\u7406\u89E3\u548C\u638C\u63E1Kubernetes\u7684\u77E5\u8BC6\u3002",-1),h=s("ul",null,[s("li",null,[n("Kubernetes\u5B98\u65B9\u6587\u6863\uFF1A"),s("a",{href:"https://kubernetes.io/docs/home/",target:"_blank",rel:"noreferrer"},"https://kubernetes.io/docs/home/")]),s("li",null,[n("Kuernetes Github\uFF1A"),s("a",{href:"https://github.com/kubernetes/",target:"_blank",rel:"noreferrer"},"https://github.com/kubernetes/")])],-1),D=s("h2",{id:"kubernetes\u67B6\u6784\u4ECB\u7ECD",tabindex:"-1"},[n("Kubernetes\u67B6\u6784\u4ECB\u7ECD "),s("a",{class:"header-anchor",href:"#kubernetes\u67B6\u6784\u4ECB\u7ECD","aria-hidden":"true"},"#")],-1),g=s("p",null,"Kubernetes \u6E90\u4E8E\u5E0C\u814A\u8BED\uFF0C\u610F\u4E3A \u201C\u8235\u624B\u201D \u6216 \u201C\u98DE\u884C\u5458\u201D\uFF0C\u662F\u7528\u4E8E\u81EA\u52A8\u90E8\u7F72\uFF0C\u6269\u5C55\u548C\u7BA1\u7406\u5BB9\u5668\u5316\u5E94\u7528\u7A0B\u5E8F\u7684\u5F00\u6E90\u7CFB\u7EDF\uFF0C\u7531\u4E8EK\u548CS\u4E4B\u95F4\u67098\u4E2A\u5B57\u6BCD\uFF0C\u88AB\u7B80\u79F0\u4E3AK8S\u3002Kubernetes \u6784\u5EFA\u5728 Google 15 \u5E74\u751F\u4EA7\u73AF\u5883\u7ECF\u9A8C\u57FA\u7840\u4E4B\u4E0A\uFF0C\u53EF\u4EE5\u5C06Kubernetes\u770B\u4F5C\u4E3AGoogle\u5185\u90E8\u7684\u5BB9\u5668\u7BA1\u7406\u5E73\u53F0Brog\u7684\u5F00\u6E90\u7248\u672C\uFF0C\u5F53\u7136\u4ED6\u4EEC\u4E4B\u95F4\u662F\u6709\u4E00\u4E9B\u5DEE\u5F02\u7684\u3002",-1),m=s("h3",{id:"kubernetes\u7CFB\u7EDF\u67B6\u6784",tabindex:"-1"},[n("Kubernetes\u7CFB\u7EDF\u67B6\u6784 "),s("a",{class:"header-anchor",href:"#kubernetes\u7CFB\u7EDF\u67B6\u6784","aria-hidden":"true"},"#")],-1),_=s("p",null,"Kubernetes\u88AB\u8BBE\u8BA1\u4E3AMaster\u548CNode\u4E24\u4E2A\u89D2\u8272\uFF0C\u8FD9\u7C7B\u4F3C\u4E8EOpenStack\u7684\u67B6\u6784\u7406\u5FF5\uFF0CMaster\u4E3A\u63A7\u5236\u8282\u70B9\uFF0CNode\u4E3A\u8BA1\u7B97\u8282\u70B9\u6216\u8005\u53EB\u5DE5\u4F5C\u8282\u70B9\uFF0C\u5728Master\u8282\u70B9\u4E0A\u6709\u4E00\u4E2AAPI Server\u670D\u52A1\uFF0C\u5BF9\u5916\u63D0\u4F9B\u6807\u51C6\u7684RestAPI\uFF0C\u8FD9\u4E5F\u662FKubernetes\u96C6\u7FA4\u7684\u5165\u53E3\uFF0C\u610F\u5916\u7740\u53EA\u8981\u548C\u96C6\u7FA4\u8FDB\u884C\u4EA4\u4E92\u5FC5\u987B\u8FDE\u63A5\u5230API Server\u4E0A\u3002",-1),b=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/4f93fc22b605a967fa54a2491557c04e.png",alt:"img"})],-1),k=s("p",null,[s("strong",null,"Master\u8282\u70B9\u4ECB\u7ECD")],-1),v=s("p",null,"Kubernetes Master\u8282\u70B9\u4E3B\u8981\u67094\u4E2A\u7EC4\u4EF6\uFF0CAPI Server\u3001Scheduler\u3001Controller\u3001etcd\u3002\u5982\u4E0B\u56FE\u6240\u793A\uFF1A",-1),f=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/0786901c59be2f756d7b979619a048b2.png",alt:"img"})],-1),x=s("ul",null,[s("li",null,[s("strong",null,"API Server"),n("\uFF1A\u63D0\u4F9BKubernetes API\u63A5\u53E3\uFF0C\u4E3B\u8981\u5904\u7406 Rest\u64CD\u4F5C\u4EE5\u53CA\u66F4\u65B0Etcd\u4E2D\u7684\u5BF9\u8C61\u3002\u662F\u6240\u6709\u8D44\u6E90\u589E\u5220\u6539\u67E5\u7684\u552F\u4E00\u5165\u53E3\u3002")]),s("li",null,[s("strong",null,"Scheduler"),n("\uFF1A\u7ED1\u5B9APod\u5230Node\u4E0A\uFF0C\u4E3B\u8981\u505A\u8D44\u6E90\u8C03\u5EA6\u3002")]),s("li",null,[s("strong",null,"Controller Manager"),n("\uFF1A\u6240\u6709\u5176\u4ED6\u7FA4\u96C6\u7EA7\u522B\u7684\u529F\u80FD\uFF0C\u76EE\u524D\u7531\u63A7\u5236\u5668Manager\u6267\u884C\u3002\u8D44\u6E90\u5BF9\u8C61\u7684\u81EA\u52A8\u5316\u63A7\u5236\u4E2D\u5FC3\uFF0CKubernetes\u96C6\u7FA4\u6709\u5F88\u591A\u63A7\u5236\u5668\u3002")]),s("li",null,[s("strong",null,"Etcd"),n("\uFF1A\u6240\u6709\u6301\u4E45\u5316\u7684\u72B6\u6001\u4FE1\u606F\u5B58\u50A8\u5728Etcd\u4E2D\uFF0C\u8FD9\u4E2A\u662FKubernetes\u96C6\u7FA4\u7684\u6570\u636E\u5E93\u3002")])],-1),P=s("p",null,[s("strong",null,"Node\u8282\u70B9\u4ECB\u7ECD")],-1),S=s("p",null,"Node\u8282\u70B9\u662FKubernetes\u96C6\u7FA4\u7684\u5DE5\u4F5C\u8282\u70B9\uFF0C\u5728Node\u8282\u70B9\u4E0A\u4E3B\u8981\u8FD0\u884C\u4E86Docker\u3001Kubelet\u3001kube-proxy\u4E09\u4E2A\u670D\u52A1\uFF08Fluentd\u8BF7\u5148\u5FFD\u7565\uFF09\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A",-1),E=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/ff26ae9ea18c1a93e50b8226abfa2fa7.png",alt:"img"})],-1),N=s("ul",null,[s("li",null,[s("strong",null,"Docker Engine"),n("\uFF1A\u8D1F\u8D23\u8282\u70B9\u7684\u5BB9\u5668\u7684\u7BA1\u7406\u5DE5\u4F5C\uFF0C\u6700\u7EC8\u521B\u5EFA\u51FA\u6765\u7684\u662F\u4E00\u4E2ADocker\u5BB9\u5668\u3002")]),s("li",null,[s("strong",null,"Kubelet"),n("\uFF1A\u5B89\u88C5\u5728Node\u4E0A\u7684\u4EE3\u7406\u670D\u52A1\uFF0C\u7528\u6765\u7BA1\u7406Pods\u4EE5\u53CA\u5BB9\u5668\u3001\u955C\u50CF\u3001Volume\u7B49\uFF0C\u5B9E\u73B0\u5BF9\u96C6\u7FA4\u5BF9\u8282\u70B9\u7684\u7BA1\u7406\u3002")]),s("li",null,[s("strong",null,"Kube-proxy"),n("\uFF1A\u5B89\u88C5\u5728Node\u4E0A\u7684\u7F51\u7EDC\u4EE3\u7406\u670D\u52A1\uFF0C\u63D0\u4F9B\u7F51\u7EDC\u4EE3\u7406\u4EE5\u53CA\u8D1F\u8F7D\u5747\u8861\uFF0C\u5B9E\u73B0\u4E0EService\u901A\u8BAF\u3002")])],-1),R=s("h3",{id:"kubernetes\u903B\u8F91\u67B6\u6784",tabindex:"-1"},[n("Kubernetes\u903B\u8F91\u67B6\u6784 "),s("a",{class:"header-anchor",href:"#kubernetes\u903B\u8F91\u67B6\u6784","aria-hidden":"true"},"#")],-1),T=s("p",null,"\u5728\u4E0A\u9762\u7684\u4ECB\u7ECD\u4E2D\u63D0\u5230\u50CFPod\u3001Service\u8FD9\u4E9B\u6982\u5FF5\uFF0C\u5728Kubernetes\u7684\u7CFB\u7EDF\u67B6\u6784\u56FE\u4E2D\u5E76\u6CA1\u6709\u4F53\u73B0\u51FA\u6765\uFF0C\u8FD9\u4E9B\u53EF\u4EE5\u7406\u89E3\u4E3AKubernetes\u903B\u8F91\u67B6\u6784\u4E2D\u7684\u7EC4\u4EF6\u3002\u4E5F\u5C31\u662F\u5728Master\u548CNode\u4E0A\u5E76\u4E0D\u5177\u4F53\u5B58\u5728\u7684\u4E00\u4E2A\u670D\u52A1\u6216\u8005\u8FDB\u7A0B\uFF0C\u4F46\u5374\u662FKubernetes\u7684\u7EC4\u4EF6\uFF0C\u4E5F\u662F\u6211\u4EEC\u7684\u7BA1\u7406\u5BF9\u8C61\u3002\u4E3B\u8981\u6709Pod\u3001Service\u548C\u5404\u79CD\u63A7\u5236\u5668\u7B49\u3002",-1),K=s("p",null,[s("strong",null,"Pod")],-1),I=s("p",null,"Pod\u662FKubernetes\u7684\u6700\u5C0F\u7BA1\u7406\u5355\u5143\uFF0C\u4E00\u4E2APod\u53EF\u4EE5\u5305\u542B\u4E00\u7EC4\u5BB9\u5668\u548C\u5377\u3002\u867D\u7136\u4E00\u4E2APod\u91CC\u9762\u53EF\u4EE5\u5305\u542B\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u5BB9\u5668\uFF0C\u4F46\u662FPod\u53EA\u6709\u4E00\u4E2AIP\u5730\u5740\uFF0C\u800C\u4E14Pod\u91CD\u542F\u540E\uFF0CIP\u5730\u5740\u4F1A\u53D1\u751F\u53D8\u5316\u3002",-1),M=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/e2a89d5ac819b578808e62d8fee0e960.png",alt:"img"})],-1),w=s("p",null,[s("strong",null,"Controller")],-1),L=s("p",null,"\u4E00\u4E2A\u5E94\u7528\u5982\u679C\u53EF\u4EE5\u6709\u4E00\u4E2A\u6216\u8005\u591A\u4E2APod\uFF0C\u5C31\u50CF\u4F60\u7ED9\u67D0\u4E00\u4E2A\u5E94\u7528\u505A\u96C6\u7FA4\uFF0C\u96C6\u7FA4\u4E2D\u7684\u6240\u6709Pod\u662F\u4E00\u6A21\u4E00\u6837\u7684\u3002Kubernetes\u4E2D\u6709\u5F88\u591A\u63A7\u5236\u5668\u53EF\u4EE5\u6765\u7BA1\u7406Pod\uFF0C\u4F8B\u5982\u4E0B\u56FE\u7684Replication Controller\u53EF\u4EE5\u63A7\u5236Pod\u7684\u526F\u672C\u6570\u91CF\uFF0C\u4ECE\u800C\u5B9E\u73B0\u6A2A\u5411\u6269\u5C55\u3002",-1),j=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/c4ae2886ff4fdb51b9a0dd20a14c8e50.png",alt:"img"})],-1),O=s("p",null,"Kubernetes\u4E2D\u6709\u5F88\u591A\u63A7\u5236\u5668\uFF0C\u540E\u9762\u7684\u7AE0\u8282\u6211\u4EEC\u4F1A\u4E00\u4E00\u8BB2\u5230\uFF0C\u5E38\u7528\u7684\u63A7\u5236\u5668\u5982\u4E0B\uFF1A",-1),G=s("ul",null,[s("li",null,"Replication Controller\uFF08\u65B0\u7248\u672C\u5DF2\u7ECF\u88ABReplicaSet\u6240\u66FF\u4EE3\uFF09"),s("li",null,"ReplicaSet\uFF08\u65B0\u7248\u672C\u88AB\u5C01\u88C5\u5728Deployment\u4E2D\uFF09"),s("li",null,"Deployment\uFF1A\u5C01\u88C5\u4E86Pod\u7684\u526F\u672C\u7BA1\u7406\u3001\u90E8\u7F72\u66F4\u65B0\u3001\u56DE\u6EDA\u3001\u6269\u5BB9\u3001\u7F29\u5BB9\u7B49\u529F\u80FD\u3002"),s("li",null,"DaemonSet\uFF1A\u4FDD\u8BC1\u6240\u6709\u7684Node\u4E0A\u6709\u4E14\u53EA\u6709\u4E00\u4E2APod\u5728\u8FD0\u884C\u3002"),s("li",null,"StatefulSet\uFF1A\u6709\u72B6\u6001\u7684\u5E94\u7528\uFF0C\u4E3A Pod \u63D0\u4F9B\u552F\u4E00\u7684\u6807\u8BC6\uFF0C\u5B83\u53EF\u4EE5\u4FDD\u8BC1\u90E8\u7F72\u548C scale \u7684\u987A\u5E8F\u3002"),s("li",null,"Job\uFF1A\u4F7F\u7528Kubernetes\u8FD0\u884C\u5355\u4E00\u4EFB\u52A1\u3002"),s("li",null,"CronJob\uFF1A\u4F7F\u7528Kubernetes\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1\u3002")],-1),U=s("p",null,[s("strong",null,"Service")],-1),V=s("p",null,"\u7531\u4E8EPod\u7684\u751F\u547D\u5468\u671F\u662F\u77ED\u6682\u7684\uFF0C\u800C\u4E14\u6BCF\u6B21\u91CD\u542FPod\u7684IP\u5730\u5740\u90FD\u4F1A\u53D1\u751F\u53D8\u5316\uFF0C\u800C\u4E14\u4E00\u4E2APod\u6709\u591A\u4E2A\u526F\u672C\uFF0C\u4E5F\u5C31\u662F\u8BF4\u4E00\u4E2A\u96C6\u7FA4\u4E2D\u6709\u4E86\u591A\u4E2A\u8282\u70B9\uFF0C\u5C31\u9700\u8981\u8003\u8651\u8D1F\u8F7D\u5747\u8861\u7684\u95EE\u9898\u3002Kubernetes\u4F7F\u7528Service\u6765\u5B9E\u73B0Pod\u7684\u8BBF\u95EE\uFF0C\u800C\u4E14Service\u6709\u4E00\u4E2ACluster IP\uFF0C\u901A\u5E38\u4E5F\u79F0\u4E4B\u4E3AVIP\uFF0C\u662F\u56FA\u5B9A\u4E0D\u53D8\u7684\u3002",-1),H=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/2e61328894d1eaf548ad6ff06d85a6a3.png",alt:"img"})],-1),Y=s("h3",{id:"kubernetes\u7F51\u7EDC\u4ECB\u7ECD",tabindex:"-1"},[n("Kubernetes\u7F51\u7EDC\u4ECB\u7ECD "),s("a",{class:"header-anchor",href:"#kubernetes\u7F51\u7EDC\u4ECB\u7ECD","aria-hidden":"true"},"#")],-1),F=s("p",null,"\u5728Kubernetes\u96C6\u7FA4\u4E2D\u5B58\u5728\u7740\u4E09\u79CD\u7F51\u7EDC\uFF0C\u5206\u522B\u662FNode\u7F51\u7EDC\u3001Pod\u7F51\u7EDC\u548CService\u7F51\u7EDC\uFF0C\u8FD9\u51E0\u79CD\u7F51\u7EDC\u4E4B\u95F4\u7684\u901A\u4FE1\u9700\u8981\u4F9D\u9760\u7F51\u7EDC\u63D2\u4EF6\uFF0CKubernetes\u672C\u8EAB\u5E76\u6CA1\u6709\u63D0\u4F9B\uFF0C\u793E\u533A\u63D0\u4F9B\u4E86\u50CFFlannel\u3001Calico\u3001Cannal\u7B49\uFF0C\u540E\u9762\u7AE0\u8282\u4F1A\u8BE6\u8FF0\u3002",-1),B=s("p",null,[s("strong",null,"Node\u7F51\u7EDC")],-1),$=s("p",null,"Node\u7F51\u7EDC\u6307\u7684\u662FKubernetes Node\u8282\u70B9\u672C\u5730\u7684\u7F51\u7EDC\uFF0C\u5728\u672C\u5B9E\u9A8C\u73AF\u5883\u4E2D\u4F7F\u7528\u7684\u662F192.168.56.0/24\u8FD9\u4E2A\u7F51\u6BB5\uFF0C\u6240\u6709\u7684Node\u548CMaster\u5728\u8BE5\u7F51\u6BB5\u90FD\u53EF\u4EE5\u6B63\u5E38\u901A\u4FE1\u3002",-1),q=s("p",null,[s("strong",null,"Pod\u7F51\u7EDC")],-1),J=s("p",null,"\u540E\u9762\u521B\u5EFA\u7684Pod\uFF0C\u6BCF\u4E00\u4E2APod\u90FD\u4F1A\u6709\u4E00\u4E2AIP\u5730\u5740\uFF0C\u8FD9\u4E2AIP\u5730\u5740\u7F51\u7EDC\u6BB5\u88AB\u79F0\u4E4B\u4E3APod\u7F51\u7EDC\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\u3002",-1),z=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod -o wide")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-hpn68 1/1 Running 0 9m7s 10.2.1.2 linux-node2.linuxhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"<none> <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-r4mfq 1/1 Running 0 7m46s 10.2.1.3 linux-node2.linuxhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"<none> <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),W=s("p",null,[s("strong",null,"Service\u7F51\u7EDC")],-1),Z=s("p",null,"Service\u662F\u4E3APod\u63D0\u4F9B\u8BBF\u95EE\u548C\u8D1F\u8F7D\u5747\u8861\u7684\u7F51\u7EDC\u5730\u5740\u6BB5\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\u3002",-1),X=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubernetes ClusterIP 10.1.0.1 <none> 443/TCP 64m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx NodePort 10.1.216.23 <none> 80:30893/TCP 8m3s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Q=s("p",null,"Kubernetes\u7684\u7EC4\u4EF6\u548C\u77E5\u8BC6\u7EDD\u975E\u5982\u6B64\uFF0C\u5FEB\u901F\u5165\u95E8\u53EF\u4EE5\u5148\u4E86\u89E3\u8FD9\u4E48\u591A\uFF0C\u4E0B\u4E00\u7AE0\u8282\uFF0C\u6211\u4EEC\u5148\u5FEB\u901F\u7684\u90E8\u7F72\u4E00\u4E2AKubernetes\u96C6\u7FA4\u3002",-1),ss=s("h2",{id:"\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4",tabindex:"-1"},[n("\u4F7F\u7528kubeadm\u90E8\u7F72Kubernetes v1.16.4 "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528kubeadm\u90E8\u7F72kubernetes-v1-16-4","aria-hidden":"true"},"#")],-1),ns=s("p",null,"\u60F3\u8981\u5FEB\u901F\u7684\u4F53\u9A8CKubernetes\u7684\u529F\u80FD\uFF0C\u5B98\u65B9\u63D0\u4F9B\u4E86\u975E\u5E38\u591A\u7684\u90E8\u7F72\u65B9\u6848\uFF0C\u53EF\u4EE5\u4F7F\u7528\u5B98\u65B9\u63D0\u4F9B\u7684kubeadm\u4EE5\u5BB9\u5668\u7684\u65B9\u5F0F\u8FD0\u884CKubernetes\u96C6\u7FA4\uFF0C\u4E5F\u53EF\u4EE5\u4F7F\u7528\u4E8C\u8FDB\u5236\u65B9\u5F0F\u90E8\u7F72\u66F4\u6709\u5229\u4E8E\u7406\u89E3Kubernetes\u7684\u67B6\u6784\uFF0C\u6211\u4EEC\u5148\u4F7F\u7528kubeadm\u5FEB\u901F\u7684\u90E8\u7F72\u4E00\u4E2AKubernetes\u96C6\u7FA4\u540E\uFF0C\u5B66\u4E60Kubernetes\u7684\u4F7F\u7528\uFF0C\u7136\u540E\u52A8\u624B\u4F7F\u7528\u4E8C\u8FDB\u5236\u7684\u65B9\u5F0F\u6765\u6DF1\u5165\u7406\u89E3Kubernetes\u67B6\u6784\u3002",-1),ls=s("blockquote",null,[s("p",null,"\u6CE8\u610F\uFF1A\u8BF7\u4E0D\u8981\u628A\u76EE\u5149\u4EC5\u4EC5\u653E\u5728\u90E8\u7F72\u4E0A\uFF0C\u8981\u6162\u6162\u7684\u4E86\u89E3\u5176\u672C\u8D28\u3002")],-1),es=s("p",null,"Kubernetesv1.13\u7248\u672C\u53D1\u5E03\u540E\uFF0Ckubeadm\u624D\u6B63\u5F0F\u8FDB\u5165GA\uFF0C\u53EF\u4EE5\u751F\u4EA7\u4F7F\u7528\u3002\u76EE\u524DKubernetes\u7684\u5BF9\u5E94\u955C\u50CF\u4ED3\u5E93\uFF0C\u5728\u56FD\u5185\u963F\u91CC\u4E91\u4E5F\u6709\u4E86\u955C\u50CF\u7AD9\u70B9\uFF0C\u4F7F\u7528kubeadm\u90E8\u7F72Kubernetes\u96C6\u7FA4\u53D8\u5F97\u7B80\u5355\u5E76\u4E14\u5BB9\u6613\u4E86\u5F88\u591A\uFF0C\u672C\u6587\u4F7F\u7528kubeadm\u5E26\u9886\u5927\u5BB6\u5FEB\u901F\u90E8\u7F72Kubernetes v1.16.2\u7248\u672C\u3002",-1),as=s("p",null,[s("strong",null,"\u5B9E\u9A8C\u73AF\u5883\u51C6\u5907")],-1),os=s("p",null,"\u5728\u672C\u4E66\u7684\u5B9E\u9A8C\u73AF\u5883\u7684\u57FA\u7840\u4E0A\uFF0C\u6211\u4EEC\u5982\u4E0B\u6765\u5206\u914D\u89D2\u8272\uFF1A",-1),ts=s("table",null,[s("thead",null,[s("tr",null,[s("th",null,"\u4E3B\u673A\u540D"),s("th",null,"IP\u5730\u5740\uFF08NAT\uFF09"),s("th",null,"\u6700\u4F4E\u914D\u7F6E"),s("th",null,"\u63CF\u8FF0")])]),s("tbody",null,[s("tr",null,[s("td",null,[s("a",{href:"http://linux-node1.linuxhot.com",target:"_blank",rel:"noreferrer"},"linux-node1.linuxhot.com")]),s("td",null,"eth0:192.168.56.11"),s("td",null,"1CPU/1G\u5185\u5B58"),s("td",null,"Kubernets Master/Etcd\u8282\u70B9")]),s("tr",null,[s("td",null,[s("a",{href:"http://linux-node2.linuxhot.com",target:"_blank",rel:"noreferrer"},"linux-node2.linuxhot.com")]),s("td",null,"eth0:192.168.56.12"),s("td",null,"1CPU/1G\u5185\u5B58"),s("td",null,"Kubernets Node\u8282\u70B9")]),s("tr",null,[s("td",null,[s("a",{href:"http://linux-node3.linuxhot.com",target:"_blank",rel:"noreferrer"},"linux-node3.linuxhot.com")]),s("td",null,"eth0:192.168.56.13"),s("td",null,"1CPU/1G\u5185\u5B58"),s("td",null,"Kubernets Node\u8282\u70B9")]),s("tr",null,[s("td",null,"Service\u7F51\u6BB5"),s("td",null,"10.1.0.0/16"),s("td"),s("td")]),s("tr",null,[s("td",null,"Pod\u7F51\u6BB5"),s("td",null,"10.2.0.0/16"),s("td"),s("td")]),s("tr",null,[s("td",null,"\u5907\u6CE8"),s("td",null,"\u5982\u679C\u6709\u6761\u4EF6\u53EF\u4EE5\u90E8\u7F72\u591A\u4E2AKubernets node\uFF0C\u5B9E\u9A8C\u6548\u679C\u66F4\u4F73\u3002"),s("td"),s("td")])])],-1),cs=s("h3",{id:"\u90E8\u7F72docker",tabindex:"-1"},[n("\u90E8\u7F72Docker "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72docker","aria-hidden":"true"},"#")],-1),rs=s("p",null,"\u9996\u5148\u9700\u8981\u5728\u6240\u6709Kubernetes\u96C6\u7FA4\u7684\u8282\u70B9\u4E2D\u5B89\u88C5Docker\u548Ckubeadm\u3002",-1),is=s("p",null,[s("strong",null,"1.\u8BBE\u7F6E\u4F7F\u7528\u56FD\u5185Yum\u6E90")],-1),ps=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd /etc/yum.repos.d/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 yum.repos.d]# wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),As=s("p",null,[s("strong",null,"2.\u5B89\u88C5\u6307\u5B9A\u7684Docker\u7248\u672C")],-1),Cs=s("p",null,[n("\u7531\u4E8Ekubeadm\u5BF9Docker\u7684\u7248\u672C\u662F\u6709\u8981\u6C42\u7684\uFF0C\u9700\u8981\u5B89\u88C5\u4E0EKubernetes\u5339\u914D\u7684\u7248\u672C\uFF0C\u8FD9\u4E2A\u5BF9\u5E94\u5173\u7CFB\u4E00\u822C\u5728\u6BCF\u6B21\u53D1\u5E03\u7684Changlog\u4E2D\u53EF\u4EE5\u627E\u5230\uFF0C\u4F8B\u59821.16.2\u7684CHANGELOG\u5982\u4E0B\uFF1A"),s("a",{href:"https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.16.md",target:"_blank",rel:"noreferrer"},"CHANGELOG")],-1),ds=s("p",null,"\u5F53\u524Dv1.16.2\u652F\u6301\u7684Docker\u7248\u672C\u6709v1.13.1, 17.03, 17.06, 17.09, 18.06, 18.09,\u53EF\u4EE5\u901A\u8FC7\u4E0B\u9762\u547D\u4EE4\u67E5\u770B\uFF1A",-1),us=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# yum list docker-ce.x86_64 --showduplicates | sort -r")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * updates: mirror.jdcloud.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Loading mirror speeds from cached hostfile")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Loaded plugins: fastestmirror")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * extras: mirror.jdcloud.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * epel: mirrors.njupt.edu.cn")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:19.03.4-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:19.03.3-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:19.03.2-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:19.03.1-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:19.03.0-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.9-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.8-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.7-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.6-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.5-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.4-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.3-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.2-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.1-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            3:18.09.0-3.el7                     docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.06.3.ce-3.el7                    docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.06.2.ce-3.el7                    docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.06.1.ce-3.el7                    docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.06.0.ce-3.el7                    docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.03.1.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            18.03.0.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.12.1.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.12.0.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.09.1.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.09.0.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.06.2.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.06.1.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.06.0.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.03.3.ce-1.el7                    docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.03.2.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.03.1.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker-ce.x86_64            17.03.0.ce-1.el7.centos             docker-ce-stable")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," * base: mirrors.neusoft.edu.cn")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Available Packages")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ys=s("p",null,[s("strong",null,"3.\u5B89\u88C5Docker18.09\u7248\u672C")],-1),hs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# yum -y install docker-ce-18.09.9-3.el7 docker-ce-cli-18.09.9-3.el7")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ds=s("p",null,[s("strong",null,"4.\u8BBE\u7F6Ecgroup\u9A71\u52A8\u4F7F\u7528systemd")],-1),gs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# mkdir /etc/docker")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat > /etc/docker/daemon.json <<EOF")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    {")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'      "registry-mirrors": ["https://dx5z2hy7.mirror.aliyuncs.com"],')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'      "exec-opts": ["native.cgroupdriver=systemd"]')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    }")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"EOF")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ms=s("p",null,[s("strong",null,"5.\u542F\u52A8\u540E\u53F0\u8FDB\u7A0B")],-1),_s=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable docker && systemctl start docker")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),bs=s("p",null,[s("strong",null,"6.\u67E5\u770BDocker\u7248\u672C")],-1),ks=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker --version")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Docker version 18.09.9, build 039a7df9ba")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),vs=s("h3",{id:"\u90E8\u7F72kubadm\u548Ckubelet",tabindex:"-1"},[n("\u90E8\u7F72kubadm\u548Ckubelet "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72kubadm\u548Ckubelet","aria-hidden":"true"},"#")],-1),fs=s("p",null,"\u5728Kubernetes\u96C6\u7FA4\u7684\u6240\u6709\u8282\u70B9\u4E0A\u90E8\u7F72\u5B8C\u6BD5Docker\u540E\uFF0C\u8FD8\u9700\u8981\u5168\u90E8\u90E8\u7F72kubeadm\u548Ckubelet\uFF0C\u5176\u4E2Dkubeadm\u662F\u7BA1\u7406\u5DE5\u5177\uFF0Ckubelet\u662F\u4E00\u4E2A\u670D\u52A1\uFF0C\u7528\u4E8E\u542F\u52A8Kubernetes\u5BF9\u5E94\u7684\u670D\u52A1\u3002",-1),xs=s("p",null,[s("strong",null,"1.\u8BBE\u7F6Ekubernetes YUM\u4ED3\u5E93")],-1),Ps=s("p",null,"\u8FD9\u91CC\u5728\u5B98\u65B9\u6587\u6863\u7684\u57FA\u7840\u4E0A\u4FEE\u6539\u4E3A\u4E86\u56FD\u5185\u963F\u91CC\u4E91\u7684yum\u4ED3\u5E93\uFF0C",-1),Ss=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/yum.repos.d/kubernetes.repo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[kubernetes]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"name=Kubernetes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"enabled=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gpgcheck=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"repo_gpgcheck=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Es=s("blockquote",null,[s("p",null,"\u6CE8\u610F\uFF1A\u6700\u4E0B\u9762\u4E00\u884Cgpgkey\u7684\u4E24\u4E2AURL\u5730\u5740\u4E4B\u95F4\u662F\u7A7A\u683C\uFF0C\u56E0\u4E3A\u6392\u7248\u95EE\u9898\u53EF\u80FD\u5BFC\u81F4\u6362\u884C\u3002")],-1),Ns=s("p",null,[s("strong",null,"2.\u5B89\u88C5\u8F6F\u4EF6\u5305")],-1),Rs=s("p",null,"\u7531\u4E8E\u7248\u672C\u66F4\u65B0\u9891\u7E41\uFF0C\u8BF7\u6307\u5B9A\u5BF9\u5E94\u7684\u7248\u672C\u53F7\uFF0C\u672C\u6587\u91C7\u75281.16.2\u7248\u672C\uFF0C\u5176\u5B83\u7248\u672C\u672A\u7ECF\u6D4B\u8BD5\uFF0C\u5982\u679C\u4E0D\u6307\u5B9A\u7248\u672C\u9ED8\u8BA4\u5B89\u88C5\u6700\u65B0\u7248\u672C\u3002",-1),Ts=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# yum install -y kubelet-1.16.2 kubeadm-1.16.2 kubectl-1.16.2 ipvsadm")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ks=s("p",null,[s("strong",null,"3.\u914D\u7F6Ekubelet")],-1),Is=s("p",null,"\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0CKubelet\u4E0D\u5141\u8BB8\u6240\u5728\u7684\u4E3B\u673A\u5B58\u5728\u4EA4\u6362\u5206\u533A\uFF0C\u540E\u671F\u89C4\u5212\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u8003\u8651\u5728\u7CFB\u7EDF\u5B89\u88C5\u7684\u65F6\u5019\u4E0D\u521B\u5EFA\u4EA4\u6362\u5206\u533A\uFF0C\u9488\u5BF9\u5DF2\u7ECF\u5B58\u5728\u4EA4\u6362\u5206\u533A\u7684\u53EF\u4EE5\u8BBE\u7F6E\u5FFD\u7565\u7981\u6B62\u4F7F\u7528Swap\u7684\u9650\u5236\uFF0C\u4E0D\u7136\u65E0\u6CD5\u542F\u52A8Kubelet\u3002",-1),Ms=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/sysconfig/kubelet")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'KUBELET_CGROUP_ARGS="--cgroup-driver=systemd"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'KUBELET_EXTRA_ARGS="--fail-swap-on=false"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ws=s("p",null,"\u5728\u6240\u6709\u8282\u70B9\u4E0A\u5173\u95EDSWAP",-1),Ls=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# swapoff -a")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),js=s("p",null,[s("strong",null,"4.\u8BBE\u7F6E\u5185\u6838\u53C2\u6570")],-1),Os=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat <<EOF >  /etc/sysctl.d/k8s.conf")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"net.bridge.bridge-nf-call-ip6tables = 1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"net.bridge.bridge-nf-call-iptables = 1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"net.ipv4.ip_forward = 1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"EOF")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Gs=s("p",null,"\u4F7F\u914D\u7F6E\u751F\u6548",-1),Us=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# sysctl --system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Vs=s("p",null,[s("strong",null,"5.\u542F\u52A8kubelet\u5E76\u8BBE\u7F6E\u5F00\u673A\u542F\u52A8")],-1),Hs=s("p",null,"\u6CE8\u610F\uFF0C\u6B64\u65F6kubelet\u662F\u65E0\u6CD5\u6B63\u5E38\u542F\u52A8\u7684\uFF0C\u53EF\u4EE5\u67E5\u770B/var/log/messages\u6709\u62A5\u9519\u4FE1\u606F\uFF0C\u7B49\u5F85\u6267\u884C\u521D\u59CB\u5316\u4E4B\u540E\u5373\u53EF\u6B63\u5E38\uFF0C\u4E3A\u6B63\u5E38\u73B0\u8C61\u3002",-1),Ys=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable kubelet && systemctl start kubelet")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Fs=s("p",null,[s("strong",null,"6.\u4F7F\u7528IPVS\u8FDB\u884C\u8D1F\u8F7D\u5747\u8861")],-1),Bs=s("p",null,"\u5728Kubernetes\u96C6\u7FA4\u4E2DKube-Proxy\u7EC4\u4EF6\u8D1F\u8F7D\u5747\u8861\u7684\u529F\u80FD\uFF0C\u9ED8\u8BA4\u4F7F\u7528iptables\uFF0C\u751F\u4EA7\u73AF\u5883\u5EFA\u8BAE\u4F7F\u7528ipvs\u8FDB\u884C\u8D1F\u8F7D\u5747\u8861\u3002\u5728\u6240\u6709\u8282\u70B9\u542F\u7528ipvs\u6A21\u5757",-1),$s=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/sysconfig/modules/ipvs.modules")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#!/bin/bash")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe -- ip_vs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe -- ip_vs_rr")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe -- ip_vs_wrr")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe -- ip_vs_sh")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"modprobe -- nf_conntrack_ipv4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# chmod +x /etc/sysconfig/modules/ipvs.modules")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# source /etc/sysconfig/modules/ipvs.modules")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),qs=s("p",null,"\u67E5\u770B\u6A21\u5757\u662F\u5426\u52A0\u8F7D\u6B63\u5E38",-1),Js=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# lsmod | grep -e ip_vs -e nf_conntrack_ipv4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ip_vs_sh               12688  0 ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ip_vs_wrr              12697  0 ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ip_vs_rr               12600  0 ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ip_vs                 145497  6 ip_vs_rr,ip_vs_sh,ip_vs_wrr")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_conntrack_ipv4      15053  15 ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_defrag_ipv4         12729  1 nf_conntrack_ipv4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nf_conntrack          133095  7 ip_vs,nf_nat,nf_nat_ipv4,xt_conntrack,nf_nat_masquerade_ipv4,nf_conntrack_netlink,nf_conntrack_ipv4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"libcrc32c              12644  4 xfs,ip_vs,nf_nat,nf_conntrack")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),zs=s("ul",null,[s("li",null,[n("\u4EE5\u4E0A\u6B65\u9AA4\u8BF7\u5728Kubernetes\u7684\u6240\u6709\u8282\u70B9\u4E0A\u6267\u884C\uFF0C\u672C\u5B9E\u9A8C\u73AF\u5883\u662F\u9700\u8981\u5728linux-node1\u3001linux-node2\u3001linux-node3\u8FD9\u4E09\u53F0\u673A\u5668\u4E0A\u5747\u5B89\u88C5Docker\u3001kubeadm\u3001kubelet\uFF0C\u5BF9\u4E8E\u4EE5\u4E0A\u64CD\u4F5C\u9700\u8981\u81EA\u52A8\u5316\u53EF\u4EE5\u53C2\u8003\u6211\u4F7F\u7528SaltStack\u5B8C\u6210\u7684salt-kubeadm\u9879\u76EE\uFF1A"),s("a",{href:"https://github.com/unixhot/salt-kubeadm",target:"_blank",rel:"noreferrer"},"https://github.com/unixhot/salt-kubeadm")])],-1),Ws=s("h3",{id:"\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master",tabindex:"-1"},[n("\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72Master "),s("a",{class:"header-anchor",href:"#\u521D\u59CB\u5316\u96C6\u7FA4\u90E8\u7F72master","aria-hidden":"true"},"#")],-1),Zs=s("p",null,"\u5728\u6240\u6709\u8282\u70B9\u4E0A\u5B89\u88C5\u5B8C\u6BD5\u540E\uFF0C\u5728linux-node1\u8FD9\u53F0Master\u8282\u70B9\u4E0A\u8FDB\u884C\u96C6\u7FA4\u7684\u521D\u59CB\u5316\u5DE5\u4F5C\u3002",-1),Xs=s("p",null,[s("strong",null,"1.\u5BFC\u51FA\u6240\u6709\u9ED8\u8BA4\u7684\u914D\u7F6E")],-1),Qs=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubeadm config print init-defaults > kubeadm.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),sn=s("p",null,"\u4E0A\u9762\u7684\u547D\u4EE4\u4F1A\u751F\u6210\u4E00\u4E2A\u9ED8\u8BA4\u914D\u7F6E\u7684kubeadm\u914D\u7F6E\u6587\u4EF6\uFF0C\u7136\u540E\u5728\u6B64\u57FA\u7840\u4E0A\u8FDB\u884C\u4FEE\u6539\u5373\u53EF\u3002",-1),nn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat kubeadm.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: kubeadm.k8s.io/v1beta2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"bootstrapTokens:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- groups:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - system:bootstrappers:kubeadm:default-node-token")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  token: abcdef.0123456789abcdef")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ttl: 24h0m0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  usages:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - signing")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - authentication")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: InitConfiguration")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"localAPIEndpoint:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  advertiseAddress: 192.168.56.11  #\u4FEE\u6539\u4E3AAPI Server\u7684\u5730\u5740")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  bindPort: 6443")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nodeRegistration:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  criSocket: /var/run/dockershim.sock")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: linux-node1.example.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  taints:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - effect: NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    key: node-role.kubernetes.io/master")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"---")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiServer:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  timeoutForControlPlane: 4m0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: kubeadm.k8s.io/v1beta2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"certificatesDir: /etc/kubernetes/pki")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"clusterName: kubernetes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"controllerManager: {}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"dns:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  type: CoreDNS")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"etcd:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  local:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    dataDir: /var/lib/etcd")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"imageRepository: registry.aliyuncs.com/google_containers  #\u4FEE\u6539\u4E3A\u963F\u91CC\u4E91\u955C\u50CF\u4ED3\u5E93")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: ClusterConfiguration")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubernetesVersion: v1.16.2  #\u4FEE\u6539\u4E3A\u5177\u4F53\u7684\u7248\u672C")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"networking:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  dnsDomain: cluster.local")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  serviceSubnet: 10.1.0.0/16   #\u4FEE\u6539Service\u7684\u7F51\u7EDC")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  podSubnet: 10.2.0.0/16      #\u65B0\u589EPod\u7684\u7F51\u7EDC")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scheduler: {}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"---   #\u4E0B\u9762\u6709\u589E\u52A0\u7684\u4E09\u884C\u914D\u7F6E\uFF0C\u7528\u4E8E\u8BBE\u7F6EKubeproxy\u4F7F\u7528LVS")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: kubeproxy.config.k8s.io/v1alpha1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: KubeProxyConfiguration")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mode: ipvs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ln=s("p",null,[s("strong",null,"2. \u6267\u884C\u521D\u59CB\u5316\u64CD\u4F5C")],-1),en=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubeadm init --config kubeadm.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[init] Using Kubernetes version: v1.16.2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] Running pre-flight checks")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"error execution phase preflight: [preflight] Some fatal errors occurred:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        [ERROR NumCPU]: the number of available CPUs 1 is less than the required 2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        [ERROR Swap]: running with swap on is not supported. Please disable swa")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] If you know what you are doing, you can make a check non-fatal with `--ignore-preflight-errors=...`")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"To see the stack trace of this error execute with --v=5 or higher")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),an=s("p",null,"\u5982\u679C\u9047\u5230\u4E0A\u9762\u8FD9\u6837\u7684\u62A5\u9519\uFF0C\u662F\u56E0\u4E3A\u5728\u5B9E\u9A8C\u73AF\u5883\u5F00\u542F\u4E86\u4EA4\u6362\u5206\u533A\uFF0C\u4EE5\u53CACPU\u7684\u6838\u6570\u5C0F\u4E8E2\u9020\u6210\u7684\uFF0C\u53EF\u4EE5\u4F7F\u7528--ignore-preflight-errors=\u8FDB\u884C\u5FFD\u7565\u3002 --ignore-preflight-errors=\uFF1A\u5FFD\u7565\u8FD0\u884C\u65F6\u7684\u9519\u8BEF\uFF0C\u4F8B\u5982\u4E0A\u9762\u76EE\u524D\u5B58\u5728[ERROR NumCPU]\u548C[ERROR Swap]\uFF0C\u5FFD\u7565\u8FD9\u4E24\u4E2A\u62A5\u9519\u5C31\u662F\u589E\u52A0--ignore-preflight-errors=NumCPU \u548C--ignore-preflight-errors=Swap\u7684\u914D\u7F6E\u5373\u53EF\u3002",-1),on=s("p",null,"\u518D\u6B21\u6267\u884C\u521D\u59CB\u5316\u64CD\u4F5C\uFF1A",-1),tn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubeadm init --config kubeadm.yaml \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  --ignore-preflight-errors=Swap,NumCPU ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[init] Using Kubernetes version: v1.16.2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] Running pre-flight checks")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        [WARNING NumCPU]: the number of available CPUs 1 is less than the required 2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        [WARNING Swap]: running with swap on is not supported. Please disable swap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] Pulling images required for setting up a Kubernetes cluster")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] This might take a minute or two, depending on the speed of your internet connection")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),cn=s("p",null,"\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u4F1A\u5728\u5F53\u524D\u8F93\u51FA\u4E0B\u505C\u7559\uFF0C\u7B49\u5F85\u4E0B\u8F7DKubernetes\u7EC4\u4EF6\u7684Docker\u955C\u50CF\u3002\u6839\u636E\u4F60\u7684\u7F51\u7EDC\u60C5\u51B5\uFF0C\u53EF\u4EE5\u6301\u7EED1-5\u5206\u949F\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u4F7F\u7528docker images\u67E5\u770B\u4E0B\u8F7D\u7684\u955C\u50CF\u3002\u955C\u50CF\u4E0B\u8F7D\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u5C31\u4F1A\u8FDB\u884C\u521D\u59CB\u64CD\u4F5C\uFF1A",-1),rn=s("p",null,"\u8FD9\u91CC\u7701\u7565\u4E86\u6240\u6709\u8F93\u51FA\uFF0C\u521D\u59CB\u5316\u64CD\u4F5C\u4E3B\u8981\u7ECF\u5386\u4E86\u4E0B\u976215\u4E2A\u6B65\u9AA4\uFF0C\u6BCF\u4E2A\u9636\u6BB5\u5747\u8F93\u51FA\u5747\u4F7F\u7528[\u6B65\u9AA4\u540D\u79F0]\u4F5C\u4E3A\u5F00\u5934\uFF1A",-1),pn=s("ol",null,[s("li",null,"[init]\uFF1A\u6307\u5B9A\u7248\u672C\u8FDB\u884C\u521D\u59CB\u5316\u64CD\u4F5C"),s("li",null,"[preflight] \uFF1A\u521D\u59CB\u5316\u524D\u7684\u68C0\u67E5\u548C\u4E0B\u8F7D\u6240\u9700\u8981\u7684Docker\u955C\u50CF\u6587\u4EF6\u3002"),s("li",null,"[kubelet-start]\uFF1A\u751F\u6210kubelet\u7684\u914D\u7F6E\u6587\u4EF6\u201D/var/lib/kubelet/config.yaml\u201D\uFF0C\u6CA1\u6709\u8FD9\u4E2A\u6587\u4EF6kubelet\u65E0\u6CD5\u542F\u52A8\uFF0C\u6240\u4EE5\u521D\u59CB\u5316\u4E4B\u524D\u7684kubelet\u5B9E\u9645\u4E0A\u542F\u52A8\u5931\u8D25\u3002"),s("li",null,"[certificates]\uFF1A\u751F\u6210Kubernetes\u4F7F\u7528\u7684\u8BC1\u4E66\uFF0C\u5B58\u653E\u5728/etc/kubernetes/pki\u76EE\u5F55\u4E2D\u3002"),s("li",null,"[kubeconfig] \uFF1A\u751F\u6210 KubeConfig\u6587\u4EF6\uFF0C\u5B58\u653E\u5728/etc/kubernetes\u76EE\u5F55\u4E2D\uFF0C\u7EC4\u4EF6\u4E4B\u95F4\u901A\u4FE1\u9700\u8981\u4F7F\u7528\u5BF9\u5E94\u6587\u4EF6\u3002"),s("li",null,"[control-plane]\uFF1A\u4F7F\u7528/etc/kubernetes/manifest\u76EE\u5F55\u4E0B\u7684YAML\u6587\u4EF6\uFF0C\u5B89\u88C5 Master\u7EC4\u4EF6\u3002"),s("li",null,"[etcd]\uFF1A\u4F7F\u7528/etc/kubernetes/manifest/etcd.yaml\u5B89\u88C5Etcd\u670D\u52A1\u3002"),s("li",null,"[wait-control-plane]\uFF1A\u7B49\u5F85control-plan\u90E8\u7F72\u7684Master\u7EC4\u4EF6\u542F\u52A8\u3002"),s("li",null,"[apiclient]\uFF1A\u68C0\u67E5Master\u7EC4\u4EF6\u670D\u52A1\u72B6\u6001\u3002"),s("li",null,"[uploadconfig]\uFF1A\u66F4\u65B0\u914D\u7F6E"),s("li",null,"[kubelet]\uFF1A\u4F7F\u7528configMap\u914D\u7F6Ekubelet\u3002"),s("li",null,"[patchnode]\uFF1A\u66F4\u65B0CNI\u4FE1\u606F\u5230Node\u4E0A\uFF0C\u901A\u8FC7\u6CE8\u91CA\u7684\u65B9\u5F0F\u8BB0\u5F55\u3002"),s("li",null,"[mark-control-plane]\uFF1A\u4E3A\u5F53\u524D\u8282\u70B9\u6253\u6807\u7B7E\uFF0C\u6253\u4E86\u89D2\u8272Master\uFF0C\u548C\u4E0D\u53EF\u8C03\u5EA6\u6807\u7B7E\uFF0C\u8FD9\u6837\u9ED8\u8BA4\u5C31\u4E0D\u4F1A\u4F7F\u7528Master\u8282\u70B9\u6765\u8FD0\u884CPod\u3002"),s("li",null,"[bootstrap-token]\uFF1A\u751F\u6210token\u8BB0\u5F55\u4E0B\u6765\uFF0C\u540E\u8FB9\u4F7F\u7528kubeadm join\u5F80\u96C6\u7FA4\u4E2D\u6DFB\u52A0\u8282\u70B9\u65F6\u4F1A\u7528\u5230"),s("li",null,"[addons]\uFF1A\u5B89\u88C5\u9644\u52A0\u7EC4\u4EF6CoreDNS\u548Ckube-proxy")],-1),An=s("p",null,"\u6210\u529F\u6267\u884C\u4E4B\u540E\uFF0C\u4F60\u4F1A\u770B\u5230\u4E0B\u9762\u7684\u8F93\u51FA\uFF1A",-1),Cn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Your Kubernetes master has initialized successfully!")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"To start using your cluster, you need to run the following as a regular user:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mkdir -p $HOME/.kube")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sudo chown $(id -u):$(id -g) $HOME/.kube/config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"You should now deploy a pod network to the cluster.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'Run "kubectl apply -f [podnetwork].yaml" with one of the options listed at:')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https://kubernetes.io/docs/concepts/cluster-administration/addons/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"You can now join any number of machines by running the following on each node")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"as root:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubeadm join 192.168.56.11:6443 --token 19fhhl.3mzkyk16tcgp6vga --discovery-token-ca-cert-hash sha256:76a88c38b673d3b2ac73e33127a809688cb3e58c533512ac6d92ecb66aa57a45")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),dn=s("p",null,"\u5982\u679C\u6267\u884C\u5931\u8D25\uFF0C\u90A3\u610F\u5473\u7740\u4E4B\u524D\u7684\u64CD\u4F5C\u5B58\u5728\u95EE\u9898\uFF0C\u68C0\u67E5\u987A\u5E8F\u5982\u4E0B\uFF1A",-1),un=s("ul",null,[s("li",null,"\u57FA\u7840\u73AF\u5883"),s("li",null,"\u4E3B\u673A\u540D\u662F\u5426\u53EF\u4EE5\u89E3\u6790\uFF0CSELinux\uFF0Ciptables\u662F\u5426\u5173\u95ED\u3002"),s("li",null,"\u4EA4\u6362\u5206\u533A\u662F\u5426\u5B58\u5728free -m\u67E5\u770B"),s("li",null,"\u5185\u6838\u53C2\u6570\u662F\u5426\u4FEE\u6539\u3001IPVS\u662F\u5426\u4FEE\u6539\uFF08\u76EE\u524D\u9636\u6BB5\u4E0D\u4F1A\u9020\u6210\u5931\u8D25\uFF09"),s("li",null,"\u57FA\u7840\u8F6F\u4EF6"),s("li",null,"Docker\u662F\u5426\u5B89\u88C5\u5E76\u542F\u52A8"),s("li",null,"Kubelet\u662F\u5426\u5B89\u88C5\u5E76\u542F\u52A8"),s("li",null,"\u6267\u884Ckubeadm\u662F\u5426\u6709\u522B\u7684\u62A5\u9519\u662F\u5426\u5FFD\u7565"),s("li",null,"systemctl status kubelet\u67E5\u770Bkubelet\u662F\u5426\u542F\u52A8"),s("li",null,"\u5982\u679Ckubelet\u65E0\u6CD5\u542F\u52A8\uFF0C\u67E5\u770B\u65E5\u5FD7\u6709\u4EC0\u4E48\u62A5\u9519\uFF0C\u5E76\u89E3\u51B3\u62A5\u9519\u3002"),s("li",null,"\u4EE5\u4E0A\u90FD\u89E3\u51B3\u5B8C\u6BD5\uFF0C\u9700\u8981\u91CD\u65B0\u521D\u59CB\u5316"),s("li",null,"kubeadm reset \u8FDB\u884C\u91CD\u7F6E\uFF08\u751F\u4EA7\u5343\u4E07\u4E0D\u8981\u6267\u884C\uFF0C\u4F1A\u76F4\u63A5\u5220\u9664\u96C6\u7FA4\uFF09"),s("li",null,"\u6839\u636Ekubeadm reset \u63D0\u5347\uFF0C\u6E05\u695Aiptables\u548CLVS\u3002")],-1),yn=s("p",null,"\u8BF7\u6839\u636E\u4E0A\u9762\u8F93\u51FA\u7684\u8981\u6C42\u914D\u7F6Ekubectl\u547D\u4EE4\u6765\u8BBF\u95EE\u96C6\u7FA4\u3002",-1),hn=s("p",null,[s("strong",null,"3.\u4E3Akubectl\u51C6\u5907Kubeconfig\u6587\u4EF6\u3002")],-1),Dn=s("p",null,"kubectl\u9ED8\u8BA4\u4F1A\u5728\u6267\u884C\u7684\u7528\u6237\u5BB6\u76EE\u5F55\u4E0B\u9762\u7684.kube\u76EE\u5F55\u4E0B\u5BFB\u627Econfig\u6587\u4EF6\u3002\u8FD9\u91CC\u662F\u5C06\u5728\u521D\u59CB\u5316\u65F6[kubeconfig]\u6B65\u9AA4\u751F\u6210\u7684admin.conf\u62F7\u8D1D\u5230.kube/config\u3002",-1),gn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# mkdir -p $HOME/.kube")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# chown $(id -u):$(id -g) $HOME/.kube/config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),mn=s("p",null,"\u5728\u8BE5\u914D\u7F6E\u6587\u4EF6\u4E2D\uFF0C\u8BB0\u5F55\u4E86API Server\u7684\u8BBF\u95EE\u5730\u5740\uFF0C\u6240\u4EE5\u540E\u9762\u76F4\u63A5\u6267\u884Ckubectl\u547D\u4EE4\u5C31\u53EF\u4EE5\u6B63\u5E38\u8FDE\u63A5\u5230API Server\u4E2D\u3002",-1),_n=s("p",null,[s("strong",null,"4.\u4F7F\u7528kubectl\u547D\u4EE4\u67E5\u770B\u7EC4\u4EF6\u72B6\u6001")],-1),bn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get cs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME STATUS MESSAGE ERROR")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scheduler Healthy ok")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"controller-manager Healthy ok")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'etcd-0 Healthy {"health": "true"}')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),kn=s("p",null,"**\u77E5\u8BC6\u56DE\u987E\uFF1A\u4E3A\u4EC0\u4E48\u4E0A\u9762\u7684\u8F93\u51FA\u6CA1\u6709\u663E\u793AAPI Server\u7EC4\u4EF6\u7684\u72B6\u6001",-1),vn=s("p",null,"\u56E0\u4E3AAPI Server\u662FKubernetes\u96C6\u7FA4\u7684\u5165\u53E3\uFF0C\u6240\u6709\u548CKubernetes\u96C6\u7FA4\u7684\u4EA4\u4E92\u90FD\u5FC5\u987B\u7ECF\u8FC7APIServer\uFF0Ckubectl\u547D\u4EE4\u4E5F\u662F\u8FDE\u63A5\u5230API Server\u4E0A\u8FDB\u884C\u4EA4\u4E92\uFF0C\u6240\u4EE5\u5982\u679C\u80FD\u591F\u6B63\u5E38\u4F7F\u7528kubectl\u6267\u884C\u547D\u4EE4\uFF0C\u610F\u5473\u7740API Server\u8FD0\u884C\u6B63\u5E38\u3002",-1),fn=s("p",null,[s("strong",null,"5.\u4F7F\u7528kubectl\u83B7\u53D6Node\u4FE1\u606F")],-1),xn=s("p",null,"\u76EE\u524D\u53EA\u6709\u4E00\u4E2A\u8282\u70B9\uFF0C\u89D2\u8272\u662FMaster\uFF0C\u72B6\u6001\u662FNotReady\u3002",-1),Pn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get node")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME STATUS ROLES AGE VERSION")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node1.unixhot.com NotReady master 14m v1.16.2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Sn=s("h3",{id:"\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6",tabindex:"-1"},[n("\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6 "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72\u7F51\u7EDC\u63D2\u4EF6","aria-hidden":"true"},"#")],-1),En=s("p",null,"Master\u8282\u70B9NotReady\u7684\u539F\u56E0\u5C31\u662F\u56E0\u4E3A\u6CA1\u6709\u4F7F\u7528\u4EFB\u4F55\u7684\u7F51\u7EDC\u63D2\u4EF6\uFF0C\u6B64\u65F6Node\u548CMaster\u7684\u8FDE\u63A5\u8FD8\u4E0D\u6B63\u5E38\u3002\u76EE\u524D\u6700\u6D41\u884C\u7684Kubernetes\u7F51\u7EDC\u63D2\u4EF6\u6709Flannel\u3001Calico\u3001Canal\uFF0C\u8FD9\u91CC\u5206\u522B\u5217\u4E3E\u4E86Canal\u548CFlannel\uFF0C\u4F60\u53EF\u4EE5\u9009\u62E9\u5176\u4E2D\u4E4B\u4E00\u8FDB\u884C\u90E8\u7F72\u3002 \u56E0\u4E3A\u57FA\u7840\u7684Kubernetes\u96C6\u7FA4\u5DF2\u7ECF\u914D\u7F6E\u5B8C\u6BD5\uFF0C\u540E\u9762\u7684\u589E\u52A0\u7EC4\u4EF6\u7B49\u64CD\u4F5C\uFF0C\u51E0\u4E4E\u90FD\u53EF\u4EE5\u4F7F\u7528kubectl\u548C\u4E00\u4E2AYAML\u914D\u7F6E\u6587\u4EF6\u6765\u5B8C\u6210\u3002",-1),Nn=s("p",null,"\u3010\u90E8\u7F72canal\u7F51\u7EDC\u63D2\u4EF6\u3011",-1),Rn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl apply -f https://docs.projectcalico.org/v3.3/getting-started/kubernetes/installation/hosted/canal/rbac.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl apply -f https://docs.projectcalico.org/v3.3/getting-started/kubernetes/installation/hosted/canal/canal.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Tn=s("p",null,"\u3010\u90E8\u7F72Flannel\u7F51\u7EDC\u63D2\u4EF6\u3011\uFF08\u63A8\u8350\uFF09 \u90E8\u7F72Flannel\u7F51\u7EDC\u63D2\u4EF6\u9700\u8981\u4FEE\u6539Pod\u7684IP\u5730\u5740\u6BB5\uFF0C\u4FEE\u6539\u4E3A\u548C\u4F60\u521D\u59CB\u5316\u4E00\u76F4\u7684\u7F51\u6BB5\uFF0C\u53EF\u4EE5\u5148\u4E0B\u8F7DFlannel\u7684YAML\u6587\u4EF6\u4FEE\u6539\u540E\uFF0C\u518D\u6267\u884C\u3002",-1),Kn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# git clone --depth 1 https://github.com/coreos/flannel.git")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd flannel/Documentation/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 Documentation]# vim kube-flannel.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'# \u4FEE\u6539"Network": "10.244.0.0/16"\u4E3A"Network": "10.2.0.0/16",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"74   net-conf.json: |")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"75     {")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'76       "Network": "10.2.0.0/16",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'77       "Backend": {')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'78         "Type": "vxlan"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"79       }")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"80     }")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# \u8BF7\u6CE8\u610F\uFF0CFlannel\u7684\u955C\u50CF\u62C9\u53D6\u901F\u5EA6\u4F1A\u6BD4\u8F83\u6162\uFF0C\u53EF\u4EE5\u66FF\u6362\u4E3A\u56FD\u5185\u955C\u50CF")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# image: quay.io/coreos/flannel:v0.10.0-amd64")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"image: quay-mirror.qiniu.com/coreos/flannel:v0.11.0-amd64")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# \u5982\u679CNode\u4E2D\u6709\u591A\u4E2A\u7F51\u5361\uFF0C\u53EF\u4EE5\u4F7F\u7528--iface\u6765\u6307\u5B9A\u5BF9\u5E94\u7684\u7F51\u5361\u53C2\u6570\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - name: kube-flannel")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        image: quay-mirror.qiniu.com/coreos/flannel:v0.11.0-amd64")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        command:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - /opt/bin/flanneld")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        args:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - --ip-masq")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - --kube-subnet-mgr")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - --iface=eth0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),In=s("p",null,"\u90E8\u7F72Flannel",-1),Mn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 Documentation]# kubectl create -f kube-flannel.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),wn=s("p",null,"\u67E5\u770BPod\u72B6\u6001",-1),Ln=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 Documentation]# kubectl get pod -n kube-system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                                              READY   STATUS     RESTARTS   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"coredns-58cc8c89f4-cjhdv                          0/1     Pending    0          41m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"coredns-58cc8c89f4-vdfn2                          0/1     Pending    0          41m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"etcd-linux-node1.unixhot.com                      1/1     Running    0          41m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-apiserver-linux-node1.unixhot.com            1/1     Running    0          40m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-controller-manager-linux-node1.unixhot.com   1/1     Running    1          40m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-flannel-ds-amd64-bwsxl                       0/1     Init:0/1   0          20s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-proxy-5qrmh                                  1/1     Running    0          41m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-scheduler-linux-node1.unixhot.com            1/1     Running    1          41m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),jn=s("p",null,"\u53EF\u4EE5\u770B\u5230\u6B64\u65F6CoreDNS\u5904\u4E8EPending\u72B6\u6001\uFF0C\u9700\u8981\u7B49\u5F85\u7F51\u7EDC\u63D2\u4EF6canal\u6216\u8005Flannel\u7684Pod\u72B6\u6001\u53D8\u6210Running\u4E4B\u540ECoreDNS\u4E5F\u4F1A\u6B63\u5E38\u3002\u6240\u6709Pod\u7684\u72B6\u6001\u90FD\u53D8\u6210Running\u4E4B\u540E\uFF0C\u8FD9\u4E2A\u65F6\u5019\u518D\u6B21\u83B7\u53D6Node\uFF0C\u4F1A\u53D1\u73B0\u8282\u70B9\u53D8\u6210\u4E86Ready\u72B6\u6001\u3002",-1),On=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get node")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME STATUS ROLES AGE VERSION")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node1.unixhot.com Ready master 29m v1.16.2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Gn=s("p",null,[s("em",null,"kubeadm\u5176\u5B9E\u4F7F\u7528Kubernetes\u90E8\u7F72Kubernetes\uFF0C\u8FD9\u6837\u5C31\u5B58\u5728\u5148\u6709\u9E21\u8FD8\u662F\u5148\u6709\u86CB\u7684\u95EE\u9898\uFF0C\u6240\u4EE5\uFF0C\u6211\u4EEC\u9996\u5148\u624B\u52A8\u90E8\u7F72\u4E86Docker\u548Ckubelet\uFF0C\u7136\u540Ekubeadm\u8C03\u7528kubelet\u4EE5\u9759\u6001Pod\u7684\u65B9\u5F0F\u90E8\u7F72\u4E86Kubernetes\u96C6\u7FA4\u4E2D\u7684\u5176\u5B83\u7EC4\u4EF6\u3002\u9759\u6001Pod\u5728\u540E\u9762\u7684\u7AE0\u8282\u4F1A\u8BB2\u5230\u3002")],-1),Un=s("h3",{id:"\u90E8\u7F72node\u8282\u70B9",tabindex:"-1"},[n("\u90E8\u7F72Node\u8282\u70B9 "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72node\u8282\u70B9","aria-hidden":"true"},"#")],-1),Vn=s("p",null,"Master\u8282\u70B9\u90E8\u7F72\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u5C31\u53EF\u4EE5\u90E8\u7F72Node\u8282\u70B9\uFF0C\u9996\u5148\u8BF7\u9075\u5FAA\u90E8\u7F72Docker\u548Ckubeadm\u7AE0\u8282\u4E3ANode\u8282\u70B9\u90E8\u7F72\u5B89\u88C5\u597Ddocker\u3001kubeadm\u548Ckubelet\uFF0C\u6B64\u8FC7\u7A0B\u8FD9\u91CC\u4E0D\u518D\u91CD\u590D\u5217\u51FA\u3002",-1),Hn=s("p",null,[s("strong",null,"1.\u5728Master\u8282\u70B9\u8F93\u51FA\u589E\u52A0\u8282\u70B9\u7684\u547D\u4EE4")],-1),Yn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubeadm token create --print-join-command")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubeadm join 192.168.56.11:6443 --token isggqa.xjwsm3i6nex91d2x --discovery-token-ca-cert-hash sha256:718827895a9a5e63dfa9ff54e16ad6dc0c493139c9c573b67ad66968036cd569")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Fn=s("p",null,[s("strong",null,"2.\u5728Node\u8282\u70B9\u6267\u884C")],-1),Bn=s("p",null,"\u6CE8\u610F\u5982\u679C\u8282\u70B9\u6709\u4EA4\u6362\u5206\u533A\uFF0C\u9700\u8981\u589E\u52A0--ignore-preflight-errors=Swap\u3002",-1),$n=s("p",null,"\u90E8\u7F72linux-node2",-1),qn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node2 ~]# kubeadm join 192.168.56.11:6443 --token isggqa.xjwsm3i6nex91d2x --discovery-token-ca-cert-hash sha256:718827895a9a5e63dfa9ff54e16ad6dc0c493139c9c573b67ad66968036cd569 --ignore-preflight-errors=Swap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Jn=s("p",null,"\u90E8\u7F72linux-node3",-1),zn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node3 ~]# kubeadm join 192.168.56.11:6443 --tokenisggqa.xjwsm3i6nex91d2x --discovery-token-ca-cert-hash sha256:718827895a9a5e63dfa9ff54e16ad6dc0c493139c9c573b67ad66968036cd569 --ignore-preflight-errors=Swap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Wn=s("p",null,"\u8FD9\u4E2A\u65F6\u5019kubernetes\u4F1A\u4F7F\u7528DaemonSet\u5728\u6240\u6709\u8282\u70B9\u4E0A\u90FD\u90E8\u7F72canal/flannel\u548Ckube-proxy\u3002\u90E8\u7F72\u5B8C\u6BD5\u4E4B\u540E\u8282\u70B9\u5373\u90E8\u7F72\u5B8C\u6BD5\u3002DaemonSet\u7684\u5185\u5BB9\u540E\u9762\u4F1A\u8BB2\u89E3\u3002",-1),Zn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    [root@linux-node1 ~]# kubectl get daemonset --all-namespaces")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    NAMESPACE NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system canal 2 2 1 2 1 beta.kubernetes.io/os=linux 17m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-proxy 2 2 2 2 2 <none> 47m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Xn=s("p",null,"\u5F85\u6240\u6709Pod\u5168\u90E8\u542F\u52A8\u5B8C\u6BD5\u4E4B\u540E\uFF0C\u8282\u70B9\u5C31\u6062\u590DReady\u72B6\u6001\u3002",-1),Qn=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    [root@linux-node1 ~]# kubectl get pod --all-namespaces")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    NAMESPACE NAME READY STATUS RESTARTS AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system canal-lv92w 3/3 Running 0 8m45s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system canal-rq5n5 3/3 Running 0 23m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system coredns-78d4cf999f-5k4sg 1/1 Running 0 53m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system coredns-78d4cf999f-bnbgf 1/1 Running 0 53m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system etcd-linux-node1.linuxhot.com 1/1 Running 0 52m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-apiserver-linux-node1.linuxhot.com 1/1 Running 0 52m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-controller-manager-linux-node1.linuxhot.com 1/1 Running 0 52m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-proxy-sddlp 1/1 Running 0 53m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-proxy-tw96b 1/1 Running 0 8m45s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    kube-system kube-scheduler-linux-node1.linuxhot.com 1/1 Running 0 52m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),sl=s("p",null,[s("strong",null,"\u67E5\u770B\u6240\u6709\u8282\u70B9"),n(" `` [root@linux-node1 ~]# kubectl get node NAME STATUS ROLES AGE VERSION "),s("a",{href:"http://linux-node1.linuxhot.com",target:"_blank",rel:"noreferrer"},"linux-node1.linuxhot.com"),n(" Ready master 49m v1.13.2 "),s("a",{href:"http://linux-node2.linuxhot.com",target:"_blank",rel:"noreferrer"},"linux-node2.linuxhot.com"),n(" Ready 4m48s v1.13.2")],-1),nl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**\u5982\u4F55\u7ED9Node\u52A0\u4E0ARoles\u6807\u7B7E**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u4F7F\u7528kubectl get node\u80FD\u591F\u770B\u5230linux-node1.linuxhot.com\u7684ROLES\u662Fmaster\u8FD9\u4E2A\u662F\u5728\u8FDB\u884C\u96C6\u7FA4\u521D\u59CB\u5316\u7684\u65F6\u5019[mark-control-plane]\u8FDB\u884C\u6807\u8BB0\u7684\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[mark-control-plane] Marking the node linux-node1.linuxhot.com as control-plane")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},`by adding the label "node-role.kubernetes.io/master=''"`)]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[mark-control-plane] Marking the node linux-node1.linuxhot.com as control-plane")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"by adding the taints [node-role.kubernetes.io/master:NoSchedule]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1.\u67E5\u770B\u8282\u70B9\u7684\u6807\u7B7E")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get nodes --show-labels")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME STATUS ROLES AGE VERSION LABELS")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node1.linuxhot.com Ready master 48m v1.13.3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/hostname=linux-node1.linuxhot.com,node-role.kubernetes.io/master=")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node2.linuxhot.com Ready <none> 7m13s v1.13.3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"beta.kubernetes.io/arch=amd64,beta.kubernetes.io/os=linux,kubernetes.io/hostname=linux-node2.linuxhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"2.\u589E\u52A0\u6807\u7B7E")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl label nodes linux-node2.linuxhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"node-role.kubernetes.io/node=")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"node/linux-node2.linuxhot.com labeled")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3.\u67E5\u770B\u6548\u679C")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get nodes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME STATUS ROLES AGE VERSION")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node1.linuxhot.com Ready master 50m v1.13.3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"linux-node2.linuxhot.com Ready node 8m41s v1.13.3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"### \u6D4B\u8BD5Kubernetes\u96C6\u7FA4 {#test}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u5728\u4E0A\u9762\u7684\u6B65\u9AA4\u4E2D\uFF0C\u6211\u4EEC\u521B\u5EFA\u4E86\u4E00\u4E2AKubernetes\u96C6\u7FA4\uFF0C1\u4E2AMaster\u548C2\u4E2ANode\u8282\u70B9\uFF0C\u5728\u751F\u4EA7\u73AF\u5883\u9700\u8981\u8003\u8651Master\u7684\u9AD8\u53EF\u7528\uFF0C\u8FD9\u91CC\u5148\u4E0D\u7528\u8003\u8651\uFF0C\u540E\u9762\u4F1A\u8BB2\u5230\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**1.\u521B\u5EFA\u4E00\u4E2A\u5355Pod\u7684Nginx\u5E94\u7528**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create deployment nginx --image=nginx:alpine")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"deployment.apps/nginx created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME READY STATUS RESTARTS AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-9j7ql 0/1 ContainerCreating 0 10s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**2.\u67E5\u770BPod\u8BE6\u7EC6\u4FE1\u606F**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u5F85Pod\u7684\u72B6\u6001\u4E3ARunning\u540E\uFF0C\u53EF\u4EE5\u83B7\u53D6Pod\u7684IP\u5730\u5740\uFF0C\u8FD9\u4E2AIP\u5730\u5740\u662F\u4ECEMaster\u8282\u70B9\u521D\u59CB\u5316\u7684--pod-network-cidr=10.2.0.0/16\u5730\u5740\u6BB5\u4E2D\u5206\u914D\u7684\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod -o wide")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-9j7ql 1/1 Running 0 59s 10.2.1.2 linux-node2.linuxhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"<none> <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**3.\u6D4B\u8BD5Nginx\u8BBF\u95EE**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# curl --head http://10.2.1.2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"HTTP/1.1 200 OK")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Server: nginx/1.15.8")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Date: Sun, 13 Jan 2019 01:16:36 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Type: text/html")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Length: 612")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Last-Modified: Wed, 26 Dec 2018 23:21:49 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Connection: keep-alive")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'ETag: "5c240d0d-264"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Accept-Ranges: bytes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**4.\u6D4B\u8BD5\u6269\u5BB9**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u73B0\u5728\u5C06Nginx\u5E94\u7528\u7684Pod\u526F\u672C\u6570\u91CF\u62D3\u5C55\u52302\u4E2A\u8282\u70B9")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl scale deployment nginx --replicas=2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"deployment.extensions/nginx scaled")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME READY STATUS RESTARTS AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-9j7ql 1/1 Running 0 2m13s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-54458cd494-vnm4f 1/1 Running 0 5s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**5.\u4E3ANginx\u589E\u52A0Service**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u4E3ANginx\u589E\u52A0Service\uFF0C\u4F1A\u521B\u5EFA\u4E00\u4E2ACluster")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IP\uFF0C\u4ECEMaster\u521D\u59CB\u5316\u7684--service-cidr=10.1.0.0/16\u5730\u5740\u6BB5\u4E2D\u8FDB\u884C\u5206\u914D\uFF0C")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u5E76\u5F00\u542FNodePort\u662F\u5728Node\u8282\u70B9\u4E0A\u8FDB\u884C\u7AEF\u53E3\u6620\u5C04\uFF0C\u8FDB\u884C\u5916\u90E8\u8BBF\u95EE\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl expose deployment nginx --port=80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--type=NodePort")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"service/nginx exposed")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubernetes ClusterIP 10.1.0.1 <none> 443/TCP 88m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx NodePort 10.1.147.204 <none> 80:30599/TCP 67m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"**6.\u6D4B\u8BD5Service\u7684VIP**")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# curl --head http://10.1.147.204/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"HTTP/1.1 200 OK ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Server: nginx/1.15.8")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Date: Sun, 13 Jan 2019 01:26:21 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Type: text/html")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Length: 612")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Last-Modified: Wed, 26 Dec 2018 23:21:49 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Connection: keep-alive")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'ETag: "5c240d0d-264"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Accept-Ranges: bytes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ll=s("p",null,[n("``` "),s("strong",null,"7.\u6D4B\u8BD5NodePort\uFF0C\u5916\u90E8\u8BBF\u95EE\u3002")],-1),el=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/1f9d523f359ce6d49515d04703d8e941.png",alt:"img"})],-1),al=s("p",null,"\u8FD9\u4E00\u5207\u770B\u8D77\u6765\u4F3C\u4E4E\u4E0D\u662F\u5341\u5206\u5B8C\u7F8E\uFF0C\u4F46\u662F\u73B0\u5728\u4F60\u5DF2\u7ECF\u62E5\u6709\u4E86\u4E00\u4E2AKubernetes\u96C6\u7FA4\uFF0C\u63A5\u4E0B\u6765\u5C31\u53EF\u4EE5\u7EE7\u7EED\u63A2\u7D22Kubernetes\u7684\u4E16\u754C\u4E86\u3002",-1),ol=s("h2",{id:"\u516C\u6709\u4E91\u4E2D\u7684kubernetes",tabindex:"-1"},[n("\u516C\u6709\u4E91\u4E2D\u7684Kubernetes "),s("a",{class:"header-anchor",href:"#\u516C\u6709\u4E91\u4E2D\u7684kubernetes","aria-hidden":"true"},"#")],-1),tl=s("p",null,"\u622A\u6B622019\u5E742\u6708\uFF0C\u5927\u591A\u6570\u516C\u6709\u4E91\u5DF2\u7ECF\u63D0\u4F9B\u4E86\u5BB9\u5668Kubernetes\u7684\u4EA7\u54C1\u670D\u52A1\uFF0C\u5BF9\u4E8E\u4F7F\u7528\u516C\u6709\u4E91\u7684\u7528\u6237\u6765\u8BF4\uFF0C\u6700\u4F73\u5B9E\u8DF5\u662F\u76F4\u63A5\u8D2D\u4E70\u516C\u6709\u4E91\u4EA7\u54C1\uFF0C\u800C\u975E\u81EA\u5DF1\u90E8\u7F72Kubernetes\u96C6\u7FA4\uFF0C\u4E3B\u8981\u662F\u56E0\u4E3A\u516C\u6709\u4E91\u5DF2\u7ECF\u5C06\u7F51\u7EDC\u548C\u5B58\u50A8\u4E0EKubernetes\u96C6\u6210\u597D\u4E86\uFF0C\u89E3\u51B3\u4E86\u751F\u4EA7\u5E94\u7528\u7684\u96BE\u9898\u3002",-1),cl=s("h3",{id:"\u963F\u91CC\u4E91\u4E2D\u7684kubernetes",tabindex:"-1"},[n("\u963F\u91CC\u4E91\u4E2D\u7684Kubernetes "),s("a",{class:"header-anchor",href:"#\u963F\u91CC\u4E91\u4E2D\u7684kubernetes","aria-hidden":"true"},"#")],-1),rl=s("p",null,"\u56FD\u5185\u963F\u91CC\u4E91\u63D0\u4F9B\u4E86\u5BB9\u5668\u670D\u52A1 Kubernetes \u7248\uFF08\u7B80\u79F0 ACK\uFF09\u63D0\u4F9B\u9AD8\u6027\u80FD\u53EF\u4F38\u7F29\u7684\u5BB9\u5668\u5E94\u7528\u7BA1\u7406\u80FD\u529B\uFF0C\u652F\u6301\u4F01\u4E1A\u7EA7 Kubernetes \u5BB9\u5668\u5316\u5E94\u7528\u7684\u5168\u751F\u547D\u5468\u671F\u7BA1\u7406\u3002\u5BB9\u5668\u670D\u52A1 Kubernetes \u7248\u7B80\u5316\u96C6\u7FA4\u7684\u642D\u5EFA\u548C\u6269\u5BB9\u7B49\u5DE5\u4F5C\uFF0C\u6574\u5408\u963F\u91CC\u4E91\u865A\u62DF\u5316\u3001\u5B58\u50A8\u3001\u7F51\u7EDC\u548C\u5B89\u5168\u80FD\u529B\uFF0C\u6253\u9020\u4E91\u7AEF\u6700\u4F73\u7684 Kubernetes \u5BB9\u5668\u5316\u5E94\u7528\u8FD0\u884C\u73AF\u5883\u3002",-1),il=s("p",null,[s("strong",null,"\u963F\u91CC\u4E91Kubernetes\u6A21\u5F0F")],-1),pl=s("p",null,"\u5BB9\u5668\u670D\u52A1Kubernetes\u7248\u5305\u542B\u4E86\u7ECF\u5178Dedicated Kubernetes\u4EE5\u53CAServerless\u4E24\u79CD\u5F62\u6001\uFF0C\u65B9\u4FBF\u60A8\u6309\u9700\u9009\u62E9\u3002",-1),Al=s("ul",null,[s("li",null,"\u7ECF\u5178Dedicated Kubernetes\u6A21\u5F0F\uFF1A\u60A8\u53EF\u4EE5\u5BF9\u96C6\u7FA4\u57FA\u7840\u8BBE\u65BD\u548C\u5BB9\u5668\u5E94\u7528\u8FDB\u884C\u66F4\u7EC6\u7C92\u5EA6\u7684\u63A7\u5236\uFF0C\u6BD4\u5982\u9009\u62E9\u5BBF\u4E3B\u673A\u5B9E\u4F8B\u89C4\u683C\u548C\u64CD\u4F5C\u7CFB\u7EDF\uFF0C\u6307\u5B9AKubernetes \u7248\u672C\u3001\u81EA\u5B9A\u4E49 Kubernetes \u7279\u6027\u5F00\u5173\u8BBE\u7F6E\u7B49\u3002\u963F\u91CC\u4E91 Kubernetes \u670D\u52A1\u8D1F\u8D23\u4E3A\u96C6\u7FA4\u521B\u5EFA\u5E95\u5C42\u4E91\u8D44\u6E90\uFF0C\u5347\u7EA7\u7B49\u81EA\u52A8\u5316\u8FD0\u7EF4\u64CD\u4F5C\u3002\u800C\u60A8\u9700\u8981\u89C4\u5212\u3001\u7EF4\u62A4\u3001\u5347\u7EA7\u670D\u52A1\u5668\u96C6\u7FA4\uFF0C\u624B\u52A8\u6216\u81EA\u52A8\u5728\u96C6\u7FA4\u4E2D\u6DFB\u52A0\u6216\u5220\u9664\u670D\u52A1\u5668\u3002"),s("li",null,"Serverless \u6A21\u5F0F\uFF1A\u60A8\u65E0\u9700\u521B\u5EFA\u5E95\u5C42\u865A\u62DF\u5316\u8D44\u6E90\uFF0C\u53EF\u4EE5\u5229\u7528 Kubernetes \u547D\u4EE4\u6307\u660E\u5E94\u7528\u5BB9\u5668\u955C\u50CF\u3001CPU \u548C\u5185\u5B58\u8981\u6C42\u4EE5\u53CA\u5BF9\u5916\u670D\u52A1\u65B9\u5F0F\uFF0C\u76F4\u63A5\u542F\u52A8\u3002")],-1),Cl=s("p",null,[s("strong",null,"\u963F\u91CC\u4E91Kubernetes\u4EA7\u54C1\u67B6\u6784")],-1),dl=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/43688d33a81f2bd6af354d0715b6b297.png",alt:"C:UsersjasonDesktop15447553537457_zh-CN.png"})],-1),ul=s("p",null,[s("strong",null,"\u963F\u91CC\u4E91Kubernetes\u521B\u5EFA")],-1),yl=s("p",null,"\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u53EF\u4EE5\u5728\u963F\u91CC\u4E91\u4E2D\u81EA\u884C\u521B\u5EFA5\u4E2A\u96C6\u7FA4\uFF0C\u6BCF\u4E2A\u96C6\u7FA4\u6700\u591A\u53EF\u4EE5\u6DFB\u52A0 40 \u4E2A\u8282\u70B9\u3002\u5982\u9700\u66F4\u9AD8\u914D\u989D\uFF0C\u9700\u8981\u63D0\u4EA4\u5DE5\u5355\u7533\u8BF7\u3002",-1),hl=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/4c165d0ebc842862595f9fd0f4650d43.png",alt:"img"})],-1),Dl=s("p",null,"\u963F\u91CC\u4E91\u5C06\u7F51\u7EDC\u3001\u5B58\u50A8\u3001\u5B89\u5168\u7B49\u65B9\u9762\u5DF2\u7ECF\u8FDB\u884C\u4E86\u6DF1\u5EA6\u96C6\u6210\uFF0C\u5728\u521B\u5EFAKubernetes\u96C6\u7FA4\u65F6\uFF0C\u963F\u91CC\u4E91\u5BB9\u5668\u670D\u52A1\u63D0\u4F9B\u4E24\u79CD\u7F51\u7EDC\u63D2\u4EF6\uFF1ATerway\u548CFlannel\uFF1A",-1),gl=s("ul",null,[s("li",null,"Flannel\uFF1A\u4F7F\u7528\u7684\u662F\u7B80\u5355\u7A33\u5B9A\u7684\u793E\u533A\u7684Flannel CNI\u63D2\u4EF6\uFF0C\u914D\u5408\u963F\u91CC\u4E91\u7684VPC\u7684\u9AD8\u901F\u7F51\u7EDC\uFF0C\u80FD\u7ED9\u96C6\u7FA4\u9AD8\u6027\u80FD\u548C\u7A33\u5B9A\u7684\u5BB9\u5668\u7F51\u7EDC\u4F53\u9A8C\uFF0C\u4F46\u529F\u80FD\u504F\u7B80\u5355\uFF0C\u652F\u6301\u7684\u7279\u6027\u5C11\uFF0C\u4F8B\u5982\uFF1A\u4E0D\u652F\u6301\u57FA\u4E8EKubernetes\u6807\u51C6\u7684Network Policy\u3002"),s("li",null,"Terway\uFF1A\u662F\u963F\u91CC\u4E91\u5BB9\u5668\u670D\u52A1\u81EA\u7814\u7684\u7F51\u7EDC\u63D2\u4EF6\uFF0C\u529F\u80FD\u4E0A\u5B8C\u5168\u517C\u5BB9Flannel\uFF0C\u652F\u6301\u5C06\u963F\u91CC\u4E91\u7684\u5F39\u6027\u7F51\u5361\u5206\u914D\u7ED9\u5BB9\u5668\uFF0C\u652F\u6301\u57FA\u4E8EKubernetes\u6807\u51C6\u7684NetworkPolicy\u6765\u5B9A\u4E49\u5BB9\u5668\u95F4\u7684\u8BBF\u95EE\u7B56\u7565\uFF0C\u652F\u6301\u5BF9\u5355\u4E2A\u5BB9\u5668\u505A\u5E26\u5BBD\u7684\u9650\u6D41\u3002\u5BF9\u4E8E\u4E0D\u9700\u8981\u4F7F\u7528Network Policy\u7684\u7528\u6237\uFF0C\u53EF\u4EE5\u9009\u62E9Flannel\uFF0C\u5176\u4ED6\u60C5\u51B5\u5EFA\u8BAE\u9009\u62E9Terway\u3002\u4E86\u89E3\u66F4\u591ATerway\u7F51\u7EDC\u63D2\u4EF6\u7684\u76F8\u5173\u5185\u5BB9\uFF0C\u8BF7\u53C2\u89C1Terway\u7F51\u7EDC\u63D2\u4EF6\u3002")],-1),ml=s("p",null,"\u6700\u7EC8\u963F\u91CC\u4E91\u4F1A\u4F7F\u7528kubeadm\u5E2E\u4F60\u521B\u5EFA\u4E00\u4E2A\u6307\u5B9A\u7248\u672C\u7684Kubernetes\u96C6\u7FA4\u3002",-1),_l=s("h3",{id:"\u79C1\u6709\u4E91\u4E2D\u7684kubernetes",tabindex:"-1"},[n("\u79C1\u6709\u4E91\u4E2D\u7684Kubernetes "),s("a",{class:"header-anchor",href:"#\u79C1\u6709\u4E91\u4E2D\u7684kubernetes","aria-hidden":"true"},"#")],-1),bl=s("p",null,[s("strong",null,"\u5185\u7F51\u90E8\u7F72Kubernetes")],-1),kl=s("p",null,"\u5F88\u591A\u4F01\u4E1A\u9700\u8981\u5185\u7F51\u90E8\u7F72Kubernetes\u4F46\u662F\u5185\u7F51\u53C8\u65E0\u6CD5\u8BBF\u95EE\u5916\u7F51\uFF0C\u5C31\u9700\u8981\u672C\u5730\u5316\u90E8\u7F72\uFF0C\u65E0\u5FD8\u4E86\u672C\u5730\u8BDD\u90E8\u7F72\u4E3B\u8981\u5305\u62EC\u4E24\u4E2A\u65B9\u9762\uFF0C\u4E00\u4E2A\u662F\u8F6F\u4EF6\u4ED3\u5E93\u7684\u51C6\u5907\uFF0C\u4E00\u4E2A\u662FKubernetes\u955C\u50CF\u7684\u51C6\u5907\u3002",-1),vl=s("ol",null,[s("li",null,"\u51C6\u5907\u5185\u7F51YUM\u4ED3\u5E93\uFF08\u7565\uFF09"),s("li",null,"\u51C6\u5907Docker Registry\uFF08\u8BF7\u53C2\u8003Harbor\u7AE0\u8282\uFF09"),s("li",null,"\u4E0B\u8F7D\u5E76\u63D0\u4EA4\u955C\u50CF\u5230Harbor\u4E2D\uFF0C\u7136\u540E\u5C06Harbor\u7684\u955C\u50CF\u90E8\u7F72\u76F4\u63A5COPY\u5230\u751F\u4EA7\u73AF\u5883\u4E2D")],-1),fl=s("p",null,"\u4E0B\u8F7D\u811A\u672C\u5982\u4E0B\uFF0C\u8BF7\u6839\u636E\u9700\u6C42\u81EA\u884C\u4FEE\u6539\uFF1A",-1),xl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim k8s-images.sh")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"#!/bin/bash")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# EVN")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'ALIYUN_REG="registry.aliyuncs.com/google_containers"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'FLANNEL_REG="quay-mirror.qiniu.com/coreos"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'LOCAL_REG="192.168.56.11/kubernetes"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"K8S_VER=v1.15.5")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"PAUSE_VER=3.1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ETCD_VER=3.3.10")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"COREDNS_VER=1.3.1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"FLANNEL_VER=v0.11.0-amd64")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# Kubernetes Docker Images")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IMAGES=(")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  kube-proxy:${K8S_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  kube-scheduler:${K8S_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  kube-controller-manager:${K8S_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  kube-apiserver:${K8S_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  pause:${PAUSE_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  etcd-amd64:${ETCD_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  coredns:${COREDNS_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},")")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"for IMAGE in ${IMAGES[@]}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"do")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  docker pull ${ALIYUN_REG}/${IMAGE}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  docker tag ${ALIYUN_REG}/${IMAGE} ${LOCAL_REG}/${IMAGE}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  #docker push ${LOCAL_REG}/${IMAGES}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"done")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# Flannel")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker pull ${FLANNEL_REG}/flannel:${FLANNEL_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"docker tag ${FLANNEL_REG}/flannel:${FLANNEL_VER} ${LOCAL_REG}/flannel:${FLANNEL_VER}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Pl=s("h1",{id:"\u7B2C\u4E94\u90E8\u5206-\u5C06\u5E94\u7528\u8FC1\u79FB\u81F3kubernetes",tabindex:"-1"},[n("\u7B2C\u4E94\u90E8\u5206 \u5C06\u5E94\u7528\u8FC1\u79FB\u81F3Kubernetes "),s("a",{class:"header-anchor",href:"#\u7B2C\u4E94\u90E8\u5206-\u5C06\u5E94\u7528\u8FC1\u79FB\u81F3kubernetes","aria-hidden":"true"},"#")],-1),Sl=s("h1",{id:"_6-\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D",tabindex:"-1"},[n("6 \u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D "),s("a",{class:"header-anchor",href:"#_6-\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","aria-hidden":"true"},"#")],-1),El=s("h2",{id:"\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D",tabindex:"-1"},[n("\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D "),s("a",{class:"header-anchor",href:"#\u7B2C\u4E00\u6B65\uFF1A\u5C06\u5E94\u7528\u5C01\u88C5\u8FDB\u5BB9\u5668\u4E2D","aria-hidden":"true"},"#")],-1),Nl=s("p",null,"\u5728\u4E4B\u524D\u7684\u5BB9\u5668\u955C\u50CF\u5B9E\u6218\u4E2D\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u5B66\u4E60\u4E86\u5982\u4F55\u5C06\u5E94\u7528\u5BB9\u5668\u5316\uFF0C\u8FD9\u91CC\u6211\u4EEC\u5C06\u4E0B\u8F7D\u4F7F\u7528\u4E24\u4E2A\u5B98\u65B9\u7684Nginx\u955C\u50CF\u6765\u5B8C\u6210\u63A5\u4E0B\u6765\u7684\u5B9E\u9A8C\u3002",-1),Rl=s("h3",{id:"\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93",tabindex:"-1"},[n("\u90E8\u7F72Harbor\u955C\u50CF\u4ED3\u5E93 "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72harbor\u955C\u50CF\u4ED3\u5E93","aria-hidden":"true"},"#")],-1),Tl=s("p",null,"\u751F\u4EA7\u73AF\u5883\u4E2D\u53EF\u4EE5\u4F7F\u7528Harbor\u6765\u7BA1\u7406Docker\u955C\u50CF\uFF0C\u8BF7\u53C2\u8003\u4E4B\u524D\u7AE0\u8282\u7684\u5185\u5BB9\u5B8C\u6210Harbor\u955C\u50CF\u4ED3\u5E93\u7684\u90E8\u7F72\u5DE5\u4F5C\uFF0C\u5E76\u5728Harbor\u4E2D\u521B\u5EFA\u4E00\u4E2Adevopsedu\u7684\u9879\u76EE\u3002",-1),Kl=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/093b4b731c05b54a1b8426e924f93d45.png",alt:"img"})],-1),Il=s("h3",{id:"\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF",tabindex:"-1"},[n("\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684Docker\u955C\u50CF "),s("a",{class:"header-anchor",href:"#\u5236\u4F5C\u5B9E\u9A8C\u7528\u7684docker\u955C\u50CF","aria-hidden":"true"},"#")],-1),Ml=s("p",null,"\u8FD9\u91CC\u4E0D\u518D\u6F14\u793ADocker\u955C\u50CF\u7684\u6784\u5EFA\uFF0C\u76F4\u63A5\u4E0B\u8F7D\u4E24\u4E2A\u5B98\u65B9\u955C\u50CF\u4F5C\u4E3A\u6848\u4F8B\u3002",-1),wl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker pull nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker pull nginx:1.14.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ll=s("h3",{id:"\u914D\u7F6Edocker\u4ED3\u5E93",tabindex:"-1"},[n("\u914D\u7F6EDocker\u4ED3\u5E93 "),s("a",{class:"header-anchor",href:"#\u914D\u7F6Edocker\u4ED3\u5E93","aria-hidden":"true"},"#")],-1),jl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root\\@linux-node1 ~]# vim /etc/docker/daemon.json")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "registry-mirrors": ["https://tdimi5q1.mirror.aliyuncs.com"],')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "insecure-registries" : ["http://192.168.56.11"]')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl restart docker")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ol=s("h3",{id:"\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93",tabindex:"-1"},[n("\u767B\u5F55Harbor\u955C\u50CF\u4ED3\u5E93 "),s("a",{class:"header-anchor",href:"#\u767B\u5F55harbor\u955C\u50CF\u4ED3\u5E93","aria-hidden":"true"},"#")],-1),Gl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker login 192.168.56.11")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Username: admin")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Password:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"WARNING! Your password will be stored unencrypted in /root/.docker/config.json.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    Configure a credential helper to remove this warning. See")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    https://docs.docker.com/engine/reference/commandline/login/\\#credentials-store")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    Login Succeeded")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ul=s("h3",{id:"\u63D0\u4EA4\u955C\u50CF\u5230registry",tabindex:"-1"},[n("\u63D0\u4EA4\u955C\u50CF\u5230Registry "),s("a",{class:"header-anchor",href:"#\u63D0\u4EA4\u955C\u50CF\u5230registry","aria-hidden":"true"},"#")],-1),Vl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker tag nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.56.11/devopsedu/nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker tag nginx:1.14.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.56.11/devopsedu/nginx:1.14.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker push 192.168.56.11/devopsedu/nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker push 192.168.56.11/devopsedu/nginx:1.14.0")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Hl=s("p",null,"\u5728\u4E0A\u9762\u7684\u6B65\u9AA4\u4E2D\uFF0C\u6A21\u62DF\u4E86\u751F\u4EA7\u73AF\u5883\u5982\u4F55\u6784\u5EFA\u548C\u63D0\u4EA4\u955C\u50CF\uFF0C\u5982\u679C\u5BF9\u4E8E\u6784\u5EFA\u548C\u63D0\u4EA4\u955C\u50CF\u6709\u7591\u95EE\u53EF\u4EE5\u590D\u4E60\u7B2C3\u7AE0\u7684\u5185\u5BB9\u3002",-1),Yl=s("h1",{id:"_7-\u7B2C\u4E8C\u6B65\uFF1A\u5C06\u5BB9\u5668\u5C01\u88C5\u5230pod\u4E2D",tabindex:"-1"},[n("7 \u7B2C\u4E8C\u6B65\uFF1A\u5C06\u5BB9\u5668\u5C01\u88C5\u5230Pod\u4E2D "),s("a",{class:"header-anchor",href:"#_7-\u7B2C\u4E8C\u6B65\uFF1A\u5C06\u5BB9\u5668\u5C01\u88C5\u5230pod\u4E2D","aria-hidden":"true"},"#")],-1),Fl=s("p",null,"Pod\u662FKubernetes\u6700\u5C0F\u7684\u7BA1\u7406\u5355\u5143\uFF0C\u4E00\u4E2APod\u53EF\u4EE5\u4EE3\u8868\u4E00\u4E2A\u8FD0\u884C\u5728\u96C6\u7FA4\u91CC\u7684\u8FDB\u7A0B\u3002\u4E4B\u524D\u662F\u5728\u5BBF\u4E3B\u673A\u4E0A\u8FD0\u884C\u4E0D\u540C\u7684\u8FDB\u7A0B\uFF0C\u73B0\u5728\u662F\u8FD0\u884C\u4E0D\u540C\u7684Pod\u3002\u524D\u9762\u4ECB\u7ECD\u8FC7Pod\u662F\u4E00\u4E2A\u903B\u8F91\u67B6\u6784\u7684\u7EC4\u4EF6\uFF0CPod\u91CC\u5C01\u88C5\u4E86\u4E00\u4E2A\uFF08\u6216\u8005\u591A\u4E2A\uFF09\u5E94\u7528\u5BB9\u5668\uFF0C\u5B58\u50A8\u8D44\u6E90\u548CIP\u5730\u5740\u3002",-1),Bl=s("p",null,[s("strong",null,"\u4E3A\u4EC0\u4E48\u8981\u9020\u4E00\u4E2APod\u51FA\u6765\uFF1F"),n(" \u5B66\u4E60Kubernetes\u9047\u5230\u7684\u6700\u591A\u7684\u540D\u79F0\u53EF\u80FD\u5C31\u662FPod\u4E86\uFF0C\u5176\u5B83\u5F00\u6E90\u7684\u5BB9\u5668\u7BA1\u7406\u5E73\u53F0\u4F8B\u5982Mesos\u76F4\u63A5\u7BA1\u7406\u548C\u8C03\u5EA6\u7684\u662F\u5BB9\u5668\uFF0C\u4F46\u662FKubernetes\u786E\u662FPod\uFF0C\u5B83\u5728\u5BB9\u5668\u4E0A\u9762\u505A\u4E86\u4E00\u5C42\u5C01\u88C5\uFF0C\u65B9\u4FBF\u7528\u6237\u5C06\u4E00\u7EC4\u7D27\u8026\u5408\u7684\u5BB9\u5668\uFF0C\u653E\u7F6E\u5728\u4E00\u4E2A\u5171\u4EAB\u8D44\u6E90\u7684\u5355\u5143\u4E2D\u3002\u5BF9\u4E8E\u5F88\u591A\u6CA1\u6709\u6B64\u7C7B\u573A\u666F\u7684\u521D\u5B66\u8005\uFF0C\u53EF\u4EE5\u6682\u65F6\u5C06Pod\u770B\u505A\u662F\u5BB9\u5668\u7684\u4E00\u4E2A\u58F3\uFF0C\u4F60\u4E5F\u5B8C\u5168\u53EF\u4EE5\u53EA\u5728Pod\u4E2D\u8FD0\u884C\u4E00\u4E2A\u5BB9\u5668\uFF0C\u968F\u7740\u5B66\u4E60\u7684\u6DF1\u5165\u518D\u6162\u6162\u7406\u89E3\u3002 Kubernetes\u8FD0\u884CPod\u7684\u4E24\u79CD\u65B9\u5F0F\uFF1A")],-1),$l=s("ul",null,[s("li",null,"Pod\u91CC\u53EA\u8FD0\u884C\u4E00\u4E2A\u5355\u72EC\u5BB9\u5668\uFF0C\u662FKubernetes\u6700\u5E38\u89C1\u7684\u4F7F\u7528\u573A\u666F\uFF1B\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u628APod\u770B\u505A\u662F\u4E00\u4E2A\u5355\u72EC\u5BB9\u5668\u7684\u8FDE\u63A5\u5668\uFF0CKubernetes\u901A\u8FC7Pod\u53BB\u7BA1\u7406\u5BB9\u5668\uFF0C\u4F5C\u4E3A\u4F7F\u7528\u8005\u51E0\u4E4E\u4E0D\u7528\u5173\u5FC3\u5BB9\u5668\u3002"),s("li",null,"Pod\u91CC\u8FD0\u884C\u591A\u4E2A\u6709\u5173\u7CFB\u5BB9\u5668\u3002\u4F8B\u5982\u5982\u679C\u4F7F\u7528Nginx+Tomcat\u8FD0\u884CJava\u5E94\u7528\uFF0C\u53EF\u4EE5\u5236\u4F5C\u4E00\u4E2A\u955C\u50CF\u91CC\u9762\u5305\u542B\u4E86Nginx+Tomcat\uFF0C\u4E5F\u53EF\u4EE5\u5206\u522B\u5236\u4F5C\u4E24\u4E2A\u955C\u50CFNginx\u955C\u50CF\u548CTomcat\u955C\u50CF\uFF0C\u5982\u679C\u4F7F\u7528Kubernetes\u5C31\u9700\u8981\u4F7F\u7528Pod\uFF0C\u5982\u679C\u5C06Nginx\u548CTomcat\u5355\u72EC\u653E\u5728\u4E24\u4E2APod\u91CC\u9762\u6765\u7BA1\u7406\uFF0C\u5C31\u4F1A\u9762\u4E34\u5F88\u591A\u5F88\u591A\u95EE\u9898\u3002\u8FD9\u4E2A\u65F6\u5019\uFF0C\u5C31\u53EF\u4EE5\u628A\u8FD9\u4E24\u4E2A\u5BB9\u5668\u653E\u7F6E\u5728\u4E00\u4E2APod\u4E2D\u3002")],-1),ql=s("h2",{id:"pod\u7BA1\u7406",tabindex:"-1"},[n("Pod\u7BA1\u7406 "),s("a",{class:"header-anchor",href:"#pod\u7BA1\u7406","aria-hidden":"true"},"#")],-1),Jl=s("p",null,"\u5728Kubernetes\u4E2D\u4F7F\u7528YAML\u683C\u5F0F\u6765\u63CF\u8FF0\u4E00\u4E2APod\u3002",-1),zl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim nginx-pod.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: nginx-pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - name: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- containerPort: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Wl=s("p",null,"Pod\u7684YAML\u63CF\u8FF0\u5185\u5BB9\u8FD8\u6709\u5F88\u591A\uFF0C\u5728\u4F7F\u7528kubeadm\u90E8\u7F72Kubernetes\u7684\u65F6\u5019\uFF0C\u5C31\u662F\u4F7F\u7528\u9759\u6001Pod\u7684\u65B9\u5F0F\u8FD0\u884C\u7684\u76F8\u5173\u670D\u52A1\uFF0CYAML\u6587\u4EF6\u5B58\u653E\u5728\uFF0C\u5F53\u7136\u73B0\u5728\u5F88\u591A\u914D\u7F6E\u8FD8\u662F\u770B\u4E0D\u61C2\u7684\uFF0C\u5E26\u7740\u95EE\u9898\u7EE7\u7EED\u5B66\u4E60\u3002",-1),Zl=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# ls -l /etc/kubernetes/manifests/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"total 16")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw------- 1 root root 2041 Feb 11 20:33 etcd.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw------- 1 root root 2700 Feb 11 20:33 kube-apiserver.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw------- 1 root root 2345 Feb 11 20:33 kube-controller-manager.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw------- 1 root root 1080 Feb 11 20:33 kube-scheduler.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Xl=s("p",null,"\u521B\u5EFAPod",-1),Ql=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f nginx-pod.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'pod "nginx-pod" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),se=s("p",null,"\u67E5\u770BPod",-1),ne=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                                READY     STATUS    RESTARTS   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-pod                           1/1       Running   0          49s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),le=s("p",null,"\u67E5\u770BPod\u66F4\u591A\u4FE1\u606F",-1),ee=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod -o wide")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                                READY     STATUS    RESTARTS   AGE       IP           NODE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-pod  1/1       Running   0          1m        10.2.53.18   192.168.56.13")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ae=s("p",null,"\u67E5\u770BPod\u8BE6\u60C5",-1),oe=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl describe pod nginx-pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Name:         nginx-pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Namespace:    default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Node:         192.168.56.13/192.168.56.13")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Start Time:   Sat, 02 Jun 2018 06:42:53 +0800")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Labels:       app=nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Annotations:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Status:       Running")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IP:           10.2.53.18")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),te=s("p",null,"\u67E5\u770BPod\u65E5\u5FD7",-1),ce=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl logs pod/nginx-pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),re=s("p",null,[s("strong",null,"Pod\u4E2D\u7684\u955C\u50CF\u62C9\u53D6\u7B56\u7565"),n(" \u5F53kubelet\u5C1D\u8BD5\u62C9\u53D6\u6307\u5B9A\u7684\u955C\u50CF\u65F6\uFF0C[imagePullPolicy]\u548C\u955C\u50CF\u7684\u6807\u7B7E\u4F1A\u751F\u6548\u3002")],-1),ie=s("ul",null,[s("li",null,"imagePullPolicy: IfNotPresent\uFF1A\u4EC5\u5F53\u955C\u50CF\u5728\u672C\u5730\u4E0D\u5B58\u5728\u65F6\u955C\u50CF\u624D\u88AB\u62C9\u53D6\u3002"),s("li",null,"imagePullPolicy: Always\uFF1A\u6BCF\u6B21\u542F\u52A8 pod \u7684\u65F6\u5019\u90FD\u4F1A\u62C9\u53D6\u955C\u50CF\u3002")],-1),pe=s("p",null,"\u7701\u7565imagePullPolicy\uFF0C\u955C\u50CF\u6807\u7B7E\u4E3A:latest\u6216\u88AB\u7701\u7565\uFF0CAlways\u88AB\u5E94\u7528\u3002 imagePullPolicy\u88AB\u7701\u7565\uFF0C\u5E76\u4E14\u955C\u50CF\u7684\u6807\u7B7E\u88AB\u6307\u5B9A\u4E14\u4E0D\u662F:latest\uFF0CIfNotPresent\u88AB\u5E94\u7528\u3002 imagePullPolicy: Never\uFF1A\u955C\u50CF\u88AB\u5047\u8BBE\u5B58\u5728\u4E8E\u672C\u5730\u3002 \u6CA1\u6709\u5C1D\u8BD5\u62C9\u53D6\u955C\u50CF\u3002",-1),Ae=s("h1",{id:"_7-3-\u7B2C\u4E09\u6B65\uFF1A\u4F7F\u7528controllers\u7BA1\u7406pod",tabindex:"-1"},[n("7.3 \u7B2C\u4E09\u6B65\uFF1A\u4F7F\u7528Controllers\u7BA1\u7406Pod "),s("a",{class:"header-anchor",href:"#_7-3-\u7B2C\u4E09\u6B65\uFF1A\u4F7F\u7528controllers\u7BA1\u7406pod","aria-hidden":"true"},"#")],-1),Ce=s("p",null,"\u5728\u5B9E\u9645\u7684\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u6211\u4EEC\u5176\u5B9E\u5F88\u5C11\u5355\u72EC\u521B\u5EFAPod\uFF0C\u800C\u662F\u901A\u8FC7\u63A7\u5236\u5668\u6765\u8FDB\u884CPod\u7684\u7BA1\u7406\uFF0CKubernetes\u63D0\u4F9B\u4E86\u5F88\u591A\u7684\u63A7\u5236\u5668\uFF0C\u4E00\u4E2A Controllers \u53EF\u4EE5\u521B\u5EFA\u548C\u7BA1\u7406\u5F88\u591A\u4E2A Pod, \u4E5F\u63D0\u4F9B\u590D\u5236\u3001\u521D\u59CB\u5316\uFF0C\u4EE5\u53CA\u63D0\u4F9B\u96C6\u7FA4\u8303\u56F4\u7684\u81EA\u6211\u6062\u590D\u7684\u529F\u80FD\u3002\u6BD4\u5982\u8BF4\uFF1A \u5982\u679C\u4E00\u4E2A\u8282\u70B9\u5B95\u673A\uFF0CController \u5C06\u8C03\u5EA6\u4E00\u4E2A\u5728\u5176\u4ED6\u8282\u70B9\u4E0A\u5B8C\u5168\u76F8\u540C\u7684 pod \u6765\u81EA\u52A8\u53D6\u4EE3\u5F53\u524D\u7684 pod\u3002",-1),de=s("h1",{id:"_8-1-replication-controller\u63A7\u5236\u5668",tabindex:"-1"},[n("8.1 Replication Controller\u63A7\u5236\u5668 "),s("a",{class:"header-anchor",href:"#_8-1-replication-controller\u63A7\u5236\u5668","aria-hidden":"true"},"#")],-1),ue=s("h1",{id:"_8-2-replica-sets\u63A7\u5236\u5668",tabindex:"-1"},[n("8.2 Replica Sets\u63A7\u5236\u5668 "),s("a",{class:"header-anchor",href:"#_8-2-replica-sets\u63A7\u5236\u5668","aria-hidden":"true"},"#")],-1),ye=s("h1",{id:"_8-3-deployment\u63A7\u5236\u5668",tabindex:"-1"},[n("8.3 Deployment\u63A7\u5236\u5668 "),s("a",{class:"header-anchor",href:"#_8-3-deployment\u63A7\u5236\u5668","aria-hidden":"true"},"#")],-1),he=s("h1",{id:"_8-4-daemonset\u63A7\u5236\u5668",tabindex:"-1"},[n("8.4 DaemonSet\u63A7\u5236\u5668 "),s("a",{class:"header-anchor",href:"#_8-4-daemonset\u63A7\u5236\u5668","aria-hidden":"true"},"#")],-1),De=s("p",null,"DaemonSet \u786E\u4FDD\u5168\u90E8\uFF08\u6216\u8005\u4E00\u4E9B\uFF09Node \u4E0A\u8FD0\u884C\u4E00\u4E2A Pod \u7684\u526F\u672C\u3002\u5F53\u6709 Node \u52A0\u5165\u96C6\u7FA4\u65F6\uFF0C\u4E5F\u4F1A\u4E3A\u4ED6\u4EEC\u65B0\u589E\u4E00\u4E2A Pod \u3002\u5F53\u6709 Node \u4ECE\u96C6\u7FA4\u79FB\u9664\u65F6\uFF0C\u8FD9\u4E9B Pod \u4E5F\u4F1A\u88AB\u56DE\u6536\u3002\u5220\u9664 DaemonSet \u5C06\u4F1A\u5220\u9664\u5B83\u521B\u5EFA\u7684\u6240\u6709 Pod\u3002 \u4F7F\u7528 DaemonSet \u7684\u4E00\u4E9B\u5178\u578B\u7528\u6CD5\uFF1A",-1),ge=s("ul",null,[s("li",null,"\u8FD0\u884C\u96C6\u7FA4\u5B58\u50A8 daemon\uFF0C\u4F8B\u5982\u5728\u6BCF\u4E2A Node \u4E0A\u8FD0\u884C glusterd\u3001ceph\u3002"),s("li",null,"\u5728\u6BCF\u4E2A Node \u4E0A\u8FD0\u884C\u65E5\u5FD7\u6536\u96C6 daemon\uFF0C\u4F8B\u5982filebeat\u3001logstash\u3002"),s("li",null,"\u5728\u6BCF\u4E2A Node \u4E0A\u8FD0\u884C\u76D1\u63A7 daemon\uFF0C\u4F8B\u5982 Prometheus Node Exporter\u3001collectd\u3001Datadog \u4EE3\u7406\u3001Zabbix Agent\u3002")],-1),me=s("p",null,[s("strong",null,"\u521B\u5EFADaemonSet")],-1),_e=s("p",null,"DaemonSet\u7684\u63CF\u8FF0\u6587\u4EF6\u548CDeployment\u975E\u5E38\u76F8\u4F3C\uFF0C\u53EA\u9700\u8981\u4FEE\u6539Kind\uFF0C\u5E76\u53BB\u6389\u526F\u672C\u6570\u91CF\u7684\u914D\u7F6E\u5373\u53EF",-1),be=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 example]# vim nginx-daemonset.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: apps/v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: DaemonSet")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: nginx-daemonset")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  selector:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    matchLabels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  template:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - name: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        image: nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - containerPort: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ke=s("p",null,"\u67E5\u770BPod\u5728Node\u4E0A\u7684\u5206\u5E03",-1),ve=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod -o wide")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                    READY     STATUS    RESTARTS   AGE       IP           NODE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-daemonset-hk28q   1/1       Running   0          1m        10.2.56.10   192.168.56.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-daemonset-wtt68   1/1       Running   0          1m        10.2.53.10   192.168.56.13")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get daemonset")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME              DESIRED   CURRENT   READY     UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-daemonset   2         2         2         2            2           <none>          1m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),fe=s("h1",{id:"_7-4-\u7B2C\u56DB\u6B65\uFF1A\u4F7F\u7528service\u7BA1\u7406pod\u8BBF\u95EE",tabindex:"-1"},[n("7.4 \u7B2C\u56DB\u6B65\uFF1A\u4F7F\u7528Service\u7BA1\u7406Pod\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#_7-4-\u7B2C\u56DB\u6B65\uFF1A\u4F7F\u7528service\u7BA1\u7406pod\u8BBF\u95EE","aria-hidden":"true"},"#")],-1),xe=s("p",null,"\u5728\u4E0A\u9762\u7684\u5C0F\u8282\uFF0C\u6211\u4EEC\u901A\u8FC7Deployment\u53EF\u4EE5\u4E3A\u4E00\u4E2A\u5E94\u7528\u521B\u5EFA\u591A\u4E2APod\uFF0C\u800C\u4E14\u53EF\u4EE5\u52A8\u6001\u7684\u8FDB\u884C\u589E\u52A0\u3001\u6216\u8005\u5220\u9664\u591A\u4F59\u7684Pod\uFF0CKubernetes Pod \u662F\u6709\u751F\u547D\u5468\u671F\u7684\uFF0C\u5B83\u4EEC\u53EF\u4EE5\u88AB\u521B\u5EFA\uFF0C\u4E5F\u53EF\u4EE5\u88AB\u9500\u6BC1\uFF0C\u4F46\u662F\u6BCF\u6B21Pod\u7684IP\u5730\u5740\u5C31\u4F1A\u53D1\u751F\u53D8\u5316\uFF0C\u5916\u9762\u5982\u4F55\u8BBF\u95EE\u5230\u8BE5Pod\u5462\uFF1F\u603B\u4E0D\u80FD\u6BCF\u6B21Pod\u91CD\u542F\u5C31\u4FEE\u6539\u8BBF\u95EE\u7684IP\u5730\u5740\u5427\u3002 \u6BCF\u4E2A Pod \u90FD\u4F1A\u83B7\u53D6\u5B83\u81EA\u5DF1\u7684 IP \u5730\u5740\uFF0C\u4F46\u662F\u6BCF\u6B21\u5373\u4F7F\u8FD9\u4E9B IP \u5730\u5740\u4E0D\u603B\u662F\u7A33\u5B9A\u53EF\u4F9D\u8D56\u7684\u3002 \u8FD9\u4F1A\u5BFC\u81F4\u4E00\u4E2A\u95EE\u9898\uFF1A\u5728 Kubernetes \u96C6\u7FA4\u4E2D\uFF0C\u5982\u679C\u4E00\u7EC4 Pod\uFF08\u79F0\u4E3A backend\uFF09\u4E3A\u5176\u5B83 Pod \uFF08\u79F0\u4E3A frontend\uFF09\u63D0\u4F9B\u670D\u52A1\uFF0C\u90A3\u4E48\u90A3\u4E9B frontend \u8BE5\u5982\u4F55\u53D1\u73B0\uFF0C\u5E76\u8FDE\u63A5\u5230\u8FD9\u7EC4 Pod \u4E2D\u7684\u54EA\u4E9B backend \u5462\uFF1F",-1),Pe=s("h1",{id:"_9-1-service\u4ECB\u7ECD\u548C\u7BA1\u7406",tabindex:"-1"},[n("9.1 Service\u4ECB\u7ECD\u548C\u7BA1\u7406 "),s("a",{class:"header-anchor",href:"#_9-1-service\u4ECB\u7ECD\u548C\u7BA1\u7406","aria-hidden":"true"},"#")],-1),Se=s("h3",{id:"\u521B\u5EFAservice",tabindex:"-1"},[n("\u521B\u5EFAService "),s("a",{class:"header-anchor",href:"#\u521B\u5EFAservice","aria-hidden":"true"},"#")],-1),Ee=s("p",null,"\u7EE7\u7EED\u6211\u4EECNginx\u7684\u6848\u4F8B\uFF0C\u6211\u4EEC\u4E3A\u4E4B\u524D\u7684\u5E94\u7528\u521B\u5EFA\u4E00\u4E2AService",-1),Ne=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat nginx-service.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: nginx-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  selector:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - protocol: TCP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    port: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    targetPort: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Re=s("ul",null,[s("li",null,"\u7B2C1\u884C\uFF1A\u5B9A\u4E49\u8D44\u6E90\u7C7B\u578B\u4E3AService"),s("li",null,"\u7B2C2\u884C\uFF1A\u5B9A\u4E49\u5F53\u524DService API\u7684\u7248\u672C"),s("li",null,"\u7B2C3\u884C\uFF1Ametadata\u8BBE\u7F6E"),s("li",null,"\u7B2C4\u884C\uFF1A\u8BBE\u7F6EService\u7684\u540D\u79F0\u4E3Anginx-service"),s("li",null,"\u7B2C5\u884C\uFF1Aspec: \u5F00\u59CB\u8BBE\u7F6EService\u7684\u5185\u5BB9"),s("li",null,"\u7B2C6\u884C\uFF1Aselector: \u4E3A\u8BE5Service\u6307\u5B9A\u4E00\u4E2A\u5339\u914D\u7684\u6807\u7B7E"),s("li",null,"\u7B2C7\u884C\uFF1Aapp: nginx \u6240\u6709\u5E26\u6709\u6807\u7B7Eapp \uFF1Anginx\u7684Pod\u5C06\u4F7F\u7528\u8BE5Service"),s("li",null,"\u7B2C8\u884C\uFF1Aports: \u6307\u5B9AService\u9700\u8981\u5BF9\u5916\u7684\u7AEF\u53E3"),s("li",null,"\u7B2C9\u884C\uFF1A\u8BBE\u7F6E\u7AEF\u53E3\u534F\u8BAE\uFF1A\u652F\u6301TCP\u548CUDP"),s("li",null,"\u7B2C10\u884C\uFF1A\u8BBE\u7F6EService\u7684\u7AEF\u53E3"),s("li",null,"\u7B2C11\u884C\uFF1A\u8BBE\u7F6EPod\u7684\u7AEF\u53E3\uFF0CKubernetes\u4F1A\u5C06\u53D1\u9001\u7ED9Service\u7AEF\u53E3\u7684\u8FDE\u63A5\uFF0C\u8F6C\u53D1\u5230Pod\u7684\u7AEF\u53E3\u4E0A\u3002")],-1),Te=s("p",null,"\u521B\u5EFANginx Service",-1),Ke=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f nginx-service.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'service "nginx-service" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ie=s("p",null,"\u67E5\u770BNginx Service",-1),Me=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubernetes      ClusterIP   10.1.0.1      <none>        443/TCP   7h")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-service   ClusterIP   10.1.184.53   <none>        80/TCP    25s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),we=s("p",null,"\u8BBF\u95EEServce IP",-1),Le=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# curl --head 10.1.181.45")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"HTTP/1.1 200 OK")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Server: nginx/1.11.10")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Date: Tue, 21 Feb 2017 08:20:42 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Type: text/html")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Content-Length: 612")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Last-Modified: Tue, 14 Feb 2017 15:36:04 GMT")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Connection: keep-alive")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'ETag: "58a323e4-264"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Accept-Ranges: bytes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),je=s("h1",{id:"_9-2-service\u548Cendpoint",tabindex:"-1"},[n("9.2 Service\u548CEndpoint "),s("a",{class:"header-anchor",href:"#_9-2-service\u548Cendpoint","aria-hidden":"true"},"#")],-1),Oe=s("p",null,"Service\u4F5C\u4E3AKubernetes\u4E2D\u4E3APod\u5B9E\u73B0\u8D1F\u8F7D\u5747\u8861\u7684\u7EC4\u4EF6\uFF0C\u51E0\u4E4E\u5728\u6240\u6709\u7684\u6587\u7AE0\u4E2D\u4E3A\u4E86\u65B9\u4FBF\u521D\u5B66\u8005\u7406\u89E3\uFF0C\u57FA\u672C\u4E0A\u8BF4\u7684\u662FService\u4F1A\u6765\u76D1\u542CPod\u7684\u53D8\u5316\uFF0C\u7136\u540E\u6765\u66F4\u65B0Pod\u7684IP\u5730\u5740\u3002\u5176\u5B9E\u8FD9\u4E2A\u4E8B\u60C5\u4E0D\u662FService\u5E72\u7684\uFF0C\u800C\u662F\u6709\u4E00\u4E2A\u5E55\u540E\u82F1\u96C4\uFF1AEndpoint Endpoints\u8868\u793A\u4E86\u4E00\u4E2AService\u5BF9\u5E94\u7684\u6240\u6709Pod\u526F\u672C\u7684\u8BBF\u95EE\u5730\u5740\uFF0C\u800CEndpoints Controller\u8D1F\u8D23\u751F\u6210\u548C\u7EF4\u62A4\u6240\u6709Endpoints\u5BF9\u8C61\u7684\u63A7\u5236\u5668\u3002\u5B83\u8D1F\u8D23\u76D1\u542CService\u548C\u5BF9\u5E94\u7684Pod\u526F\u672C\u7684\u53D8\u5316\u3002",-1),Ge=s("ul",null,[s("li",null,"\u5982\u679C\u76D1\u6D4B\u5230Service\u88AB\u5220\u9664\uFF0C\u5219\u5220\u9664\u548C\u8BE5Service\u540C\u540D\u7684Endpoints\u5BF9\u8C61\uFF1B"),s("li",null,"\u5982\u679C\u76D1\u6D4B\u5230\u65B0\u7684Service\u88AB\u521B\u5EFA\u6216\u4FEE\u6539\uFF0C\u5219\u6839\u636E\u8BE5Service\u4FE1\u606F\u83B7\u5F97\u76F8\u5173\u7684Pod\u5217\u8868\uFF0C\u7136\u540E\u521B\u5EFA\u6216\u66F4\u65B0Service\u5BF9\u5E94\u7684Endpoints\u5BF9\u8C61\u3002"),s("li",null,"\u5982\u679C\u76D1\u6D4B\u5230Pod\u7684\u4E8B\u4EF6\uFF0C\u5219\u66F4\u65B0\u5B83\u5BF9\u5E94\u7684Service\u7684Endpoints\u5BF9\u8C61\u3002")],-1),Ue=s("p",null,"kube-proxy\u8FDB\u7A0B\u83B7\u53D6\u6BCF\u4E2AService\u7684Endpoints\uFF0C\u5B9E\u73B0Service\u7684\u8D1F\u8F7D\u5747\u8861\u529F\u80FD\u3002",-1),Ve=s("h3",{id:"\u521B\u5EFA\u4E00\u4E2Aheadless-service",tabindex:"-1"},[n("\u521B\u5EFA\u4E00\u4E2AHeadless Service "),s("a",{class:"header-anchor",href:"#\u521B\u5EFA\u4E00\u4E2Aheadless-service","aria-hidden":"true"},"#")],-1),He=s("p",null,"\u7F16\u5199\u4E00\u4E2AService\u4E0D\u4F7F\u7528clusterip",-1),Ye=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat mysql-service.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - protocol: TCP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    port: 3306")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    targetPort: 3306")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  clusterIP: None")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f mysql-service.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'service "mysql-service" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Fe=s("p",null,"\u67E5\u770BService\uFF0C\u53EF\u4EE5\u653E\u5FC3CLUSTER-IP\u4E3ANone",-1),Be=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get service mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)    AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mysql-service   ClusterIP   None         <none>        3306/TCP   17s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),$e=s("p",null,"2.\u521B\u5EFA\u4E00\u4E2AEndpoint",-1),qe=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim mysql-endpoint.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Endpoints")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," name: mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"subsets:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- addresses:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - ip: 192.168.56.13")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - port: 3306")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    protocol: TCP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f mysql-endpoint.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'endpoints "mysql-service" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Je=s("p",null,"3.\u67E5\u770BService\u548CEndpoint\u7684\u5173\u8054",-1),ze=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get ep mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            ENDPOINTS            AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mysql-service   192.168.56.13:3306   42s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl describe svc mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Name:              mysql-service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Namespace:         default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Labels:            <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Annotations:       <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Selector:          <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Type:              ClusterIP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"IP:                None")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Port:              <unset>  3306/TCP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"TargetPort:        3306/TCP")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Endpoints:         192.168.56.13:3306")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Session Affinity:  None")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Events:            <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),We=s("h1",{id:"_7-5-\u7B2C\u4E94\u6B65\uFF1A\u4F7F\u7528ingress\u63D0\u4F9B\u5916\u90E8\u8BBF\u95EE",tabindex:"-1"},[n("7.5 \u7B2C\u4E94\u6B65\uFF1A\u4F7F\u7528Ingress\u63D0\u4F9B\u5916\u90E8\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#_7-5-\u7B2C\u4E94\u6B65\uFF1A\u4F7F\u7528ingress\u63D0\u4F9B\u5916\u90E8\u8BBF\u95EE","aria-hidden":"true"},"#")],-1),Ze=s("p",null,"\u901A\u8FC7Service\u53EF\u4EE5\u5C06Kubernetes\u96C6\u7FA4\u4E2D\u7684\u670D\u52A1\u4EE5IP\uFF1APort\u7684\u65B9\u5F0F\u66B4\u9732\u51FA\u6765\uFF0C\u6211\u4EEC\u79F0\u4E4B\u4E3A4\u5C42\u7684\u8D1F\u8F7D\u5747\u8861\uFF0C\u56E0\u4E3A\u8FD9\u4E2A\u662FOSI\u4E03\u5C42\u6A21\u578B\u4E2D\u4F20\u8F93\u5C42\u7684\u529F\u80FD\u3002",-1),Xe=s("p",null,"\u90A3\u4E48\u5982\u4F55\u5B9E\u73B0\u4E03\u5C42\u7684\u8D1F\u8F7D\u5747\u8861\u5462\uFF0C\u4F8B\u5982\u50CFNginx\u90A3\u6837\uFF0C\u53EF\u4EE5\u7075\u6D3B\u7684\u8FDB\u884C\u53CD\u5411\u4EE3\u7406\u7684\u8BBE\u7F6E\uFF0C\u6839\u636E\u4E0D\u540C\u7684URL\u8FDB\u884C\u8F6C\u53D1\u7B49\uFF0C\u96BE\u9053\u6211\u9700\u8981\u81EA\u5DF1\u90E8\u7F72\u4E00\u4E2ANginx\u6765\u505A\u8FD9\u4E2A\u4E8B\u60C5\u5417\uFF1F\u9996\u5148\uFF0C\u5982\u679C\u4F60\u6709\u8FD9\u4E2A\u60F3\u6CD5\uFF0C\u5E76\u6CA1\u6709\u9519\uFF0C\u751A\u81F3\u4F60\u5B8C\u5168\u53EF\u4EE5\u81EA\u5DF1\u72EC\u7ACB\u90E8\u7F72\u4E00\u4E2ANginx\u6765\u5B8C\u6210\uFF0C\u4F46\u662FKubernetes\u63D0\u4F9B\u4E86\u66F4\u597D\u7684\u89E3\u51B3\u65B9\u6848\u5C31\u662FIngress\u3002 Ingress\u5C31\u662F\u4ECEkubernetes\u96C6\u7FA4\u5916\u8BBF\u95EE\u96C6\u7FA4\u7684\u5165\u53E3\uFF0C\u5C06\u7528\u6237\u7684URL\u8BF7\u6C42\u8F6C\u53D1\u5230\u4E0D\u540C\u7684service\u4E0A\u3002ingress\u76F8\u5F53\u4E8Enginx\u53CD\u5411\u4EE3\u7406\u670D\u52A1\u5668\uFF0C\u5B83\u5305\u62EC\u7684\u89C4\u5219\u5B9A\u4E49\u5C31\u662FURL\u7684\u8DEF\u7531\u4FE1\u606F\u3002",-1),Qe=s("h2",{id:"_10-1-ingress-controller",tabindex:"-1"},[n("10.1 Ingress Controller "),s("a",{class:"header-anchor",href:"#_10-1-ingress-controller","aria-hidden":"true"},"#")],-1),sa=s("p",null,"\u5728\u5B66\u4E60Service\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u77E5\u9053\u6700\u7EC8\u7684\u8D1F\u8F7D\u5747\u8861\u7531kube-proxy\u548CLVS\u6765\u5B8C\u6210\uFF0C\u90A3\u4E48Ingress\u9760\u4EC0\u4E48\u6765\u5B9E\u73B07\u5C42\u7684\u8DEF\u7531\u673A\u5236\u5462\uFF1F\u7B54\u6848\u662FIngress Controller\u3002",-1),na=s("p",null,"Ingress Controller \u5B9E\u8D28\u4E0A\u53EF\u4EE5\u7406\u89E3\u4E3A\u662F\u4E2A\u76D1\u89C6\u5668\uFF0CIngress Controller \u901A\u8FC7\u4E0D\u65AD\u5730\u8DDF kubernetes API \u6253\u4EA4\u9053\uFF0C\u5B9E\u65F6\u7684\u611F\u77E5\u540E\u7AEF service\u3001pod \u7B49\u53D8\u5316\uFF0C\u6BD4\u5982\u65B0\u589E\u548C\u51CF\u5C11 pod\uFF0Cservice \u589E\u52A0\u4E0E\u51CF\u5C11\u7B49\uFF1B\u5F53\u5F97\u5230\u8FD9\u4E9B\u53D8\u5316\u4FE1\u606F\u540E\uFF0CIngress Controller \u518D\u7ED3\u5408\u4E0B\u6587\u7684 Ingress \u751F\u6210\u914D\u7F6E\uFF0C\u7136\u540E\u66F4\u65B0\u53CD\u5411\u4EE3\u7406\u8D1F\u8F7D\u5747\u8861\u5668\uFF0C\u5E76\u5237\u65B0\u5176\u914D\u7F6E\uFF0C\u8FBE\u5230\u670D\u52A1\u53D1\u73B0\u7684\u4F5C\u7528\u3002",-1),la=s("p",null,"Ingress Controller\u76EE\u524D\u6709\u4E24\u5927\u5F00\u6E90\u9879\u76EE\uFF0C\u4E00\u4E2A\u662FNginx Controller\uFF0C\u4E00\u4E2A\u662F\u76EE\u524D\u6BD4\u8F83\u6D41\u884C\u7684Traefik\uFF0CTraefik\u662F\u4E00\u6B3E\u5F00\u6E90\u7684\u53CD\u5411\u4EE3\u7406\u4E0E\u8D1F\u8F7D\u5747\u8861\u5DE5\u5177\u3002\u5B83\u6700\u5927\u7684\u4F18\u70B9\u662F\u80FD\u591F\u4E0E\u5E38\u89C1\u7684\u5FAE\u670D\u52A1\u7CFB\u7EDF\u76F4\u63A5\u6574\u5408\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u81EA\u52A8\u5316\u52A8\u6001\u914D\u7F6E\u3002\u76EE\u524D\u652F\u6301Docker, Swarm, Mesos/Marathon, Mesos, Kubernetes, Consul, Etcd, Zookeeper, BoltDB, Rest API\u7B49\u7B49\u540E\u7AEF\u6A21\u578B\u3002",-1),ea=s("h2",{id:"ingress-controller-traefik",tabindex:"-1"},[n("Ingress Controller Traefik "),s("a",{class:"header-anchor",href:"#ingress-controller-traefik","aria-hidden":"true"},"#")],-1),aa=s("h3",{id:"\u90E8\u7F72treafik",tabindex:"-1"},[n("\u90E8\u7F72Treafik "),s("a",{class:"header-anchor",href:"#\u90E8\u7F72treafik","aria-hidden":"true"},"#")],-1),oa=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl label nodes 192.168.56.12 edgenode=true")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'node "192.168.56.12" labeled')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f /srv/addons/ingress/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ta=s("h1",{id:"_11-\u7B2C\u516D\u6B65\uFF1A\u4F7F\u7528pv\u548Cpvc\u7BA1\u7406\u6570\u636E\u5B58\u50A8",tabindex:"-1"},[n("11 \u7B2C\u516D\u6B65\uFF1A\u4F7F\u7528PV\u548CPVC\u7BA1\u7406\u6570\u636E\u5B58\u50A8 "),s("a",{class:"header-anchor",href:"#_11-\u7B2C\u516D\u6B65\uFF1A\u4F7F\u7528pv\u548Cpvc\u7BA1\u7406\u6570\u636E\u5B58\u50A8","aria-hidden":"true"},"#")],-1),ca=s("p",null,"\u622A\u6B62\u76EE\u524D\u6211\u4EEC\u6240\u542F\u52A8Pod\u7684\u5BB9\u5668\u4E2D\u7684\u6570\u636E\u5B58\u50A8\u90FD\u662F\u4E34\u65F6\u7684\uFF0C\u56E0\u6B64Pod\u91CD\u542F\u6216\u8005\u88AB\u5220\u9664\u7684\u65F6\u5019\uFF0C\u4EA7\u751F\u5728\u5BB9\u5668\u4E2D\u7684\u6570\u636E\u4F1A\u53D1\u751F\u4E22\u5931\u3002\u5B9E\u9645\u5E94\u7528\u4E2D\uFF0C\u6211\u4EEC\u6709\u4E9B\u5E94\u7528\u662F\u65E0\u72B6\u6001\uFF0C\u6709\u4E9B\u5E94\u7528\u5219\u9700\u8981\u4FDD\u6301\u72B6\u6001\u6570\u636E\uFF0C\u786E\u4FDDPod\u91CD\u542F\u4E4B\u540E\u80FD\u591F\u8BFB\u53D6\u5230\u4E4B\u524D\u7684\u72B6\u6001\u6570\u636E\uFF0C\u6709\u4E9B\u5E94\u7528\u5219\u4F5C\u4E3A\u96C6\u7FA4\u63D0\u4F9B\u670D\u52A1\u3002\u8FD9\u4E09\u79CD\u670D\u52A1\u5F52\u7EB3\u4E3A\u65E0\u72B6\u6001\u670D\u52A1\u3001\u6709\u72B6\u6001\u670D\u52A1\u4EE5\u53CA\u6709\u72B6\u6001\u7684\u96C6\u7FA4\u670D\u52A1\uFF0C\u5176\u4E2D\u540E\u9762\u4E24\u4E2A\u5B58\u5728\u6570\u636E\u4FDD\u5B58\u4E0E\u5171\u4EAB\u7684\u9700\u6C42\uFF0C\u56E0\u6B64\u5C31\u8981\u91C7\u7528\u5BB9\u5668\u5916\u7684\u5B58\u50A8\u65B9\u6848\u3002 Kubernetes\u4E2D\u5B58\u50A8\u4E2D\u6709\u56DB\u4E2A\u91CD\u8981\u7684\u6982\u5FF5\uFF1AVolume\u3001PersistentVolume\uFF08PV\uFF09\u3001PersistentVolumeClaim \uFF08PVC\uFF09\u3001StorageClass\u3002\u638C\u63E1\u4E86\u8FD9\u56DB\u4E2A\u6982\u5FF5\uFF0C\u5C31\u638C\u63E1\u4E86Kubernetes\u4E2D\u5B58\u50A8\u7CFB\u7EDF\u7684\u6838\u5FC3\u3002",-1),ra=s("h1",{id:"_11-1-kubernetes-volume",tabindex:"-1"},[n("11.1 Kubernetes Volume "),s("a",{class:"header-anchor",href:"#_11-1-kubernetes-volume","aria-hidden":"true"},"#")],-1),ia=s("h1",{id:"_11-2-persistentvolume\uFF08pv\uFF09",tabindex:"-1"},[n("11.2 PersistentVolume\uFF08PV\uFF09 "),s("a",{class:"header-anchor",href:"#_11-2-persistentvolume\uFF08pv\uFF09","aria-hidden":"true"},"#")],-1),pa=s("p",null,"PersistentVolume\uFF08PV\uFF09\u662F\u7531\u7BA1\u7406\u5458\u8BBE\u7F6E\u7684\u5B58\u50A8\uFF0C\u5B83\u662F\u7FA4\u96C6\u7684\u4E00\u90E8\u5206\u3002\u5C31\u50CF\u8282\u70B9\u662F\u96C6\u7FA4\u4E2D\u7684\u8D44\u6E90\u4E00\u6837\uFF0CPV \u4E5F\u662F\u96C6\u7FA4\u4E2D\u7684\u8D44\u6E90\u3002 PV \u662F Volume \u4E4B\u7C7B\u7684\u5377\u63D2\u4EF6\uFF0C\u4F46\u5177\u6709\u72EC\u7ACB\u4E8E\u4F7F\u7528 PV \u7684 Pod \u7684\u751F\u547D\u5468\u671F\u3002\u6B64 API \u5BF9\u8C61\u5305\u542B\u5B58\u50A8\u5B9E\u73B0\u7684\u7EC6\u8282\uFF0C\u5373 NFS\u3001iSCSI \u6216\u7279\u5B9A\u4E8E\u4E91\u4F9B\u5E94\u5546\u7684\u5B58\u50A8\u7CFB\u7EDF\u3002",-1),Aa=s("p",null,[s("strong",null,"1.\u5B89\u88C5\u5E76\u914D\u7F6ENFS")],-1),Ca=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# yum install -y nfs-utils rpcbind")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# mkdir -p /data/k8s-nfs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/exports")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/data/k8s-nfs *(rw,sync,no_root_squash)")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),da=s("p",null,"\u542F\u52A8NFS",-1),ua=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable rpcbind nfs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl start rpcbind nfs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ya=s("p",null,[s("strong",null,"2.\u521B\u5EFA\u5E76\u67E5\u770BPV")],-1),ha=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim nfs-pv.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: PersistentVolume")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: pv-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  capacity:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"storage: 1Gi")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  volumeMode: Filesystem")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  accessModes:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - ReadWriteOnce")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  persistentVolumeReclaimPolicy: Recycle")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  storageClassName: nfs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  nfs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    path: /data/k8s-nfs/pv-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    server: 192.168.56.11")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f nfs-pv.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'persistentvolume "pv-demo" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Da=s("p",null,"\u67E5\u770B\u521B\u5EFA\u7684PV",-1),ga=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pv")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME      CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS      CLAIM     STORAGECLASS   REASON    AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pv-demo   1Gi        RWO            Recycle          Available             nfs                      15s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ma=s("h1",{id:"_11-3-persistentvolumeclaim\uFF08pvc\uFF09",tabindex:"-1"},[n("11.3 PersistentVolumeClaim\uFF08PVC\uFF09 "),s("a",{class:"header-anchor",href:"#_11-3-persistentvolumeclaim\uFF08pvc\uFF09","aria-hidden":"true"},"#")],-1),_a=s("p",null,"PersistentVolumeClaim\uFF08PVC\uFF09\u662F\u7528\u6237\u5B58\u50A8\u7684\u8BF7\u6C42\u3002\u5B83\u4E0E Pod \u76F8\u4F3C\u3002Pod \u6D88\u8017\u8282\u70B9\u8D44\u6E90\uFF0CPVC \u6D88\u8017 PV \u8D44\u6E90\u3002Pod \u53EF\u4EE5\u8BF7\u6C42\u7279\u5B9A\u7EA7\u522B\u7684\u8D44\u6E90\uFF08CPU \u548C\u5185\u5B58\uFF09\u3002\u58F0\u660E\u53EF\u4EE5\u8BF7\u6C42\u7279\u5B9A\u7684\u5927\u5C0F\u548C\u8BBF\u95EE\u6A21\u5F0F\uFF08\u4F8B\u5982\uFF0C\u53EF\u4EE5\u4EE5\u8BFB/\u5199\u4E00\u6B21\u6216 \u53EA\u8BFB\u591A\u6B21\u6A21\u5F0F\u6302\u8F7D\uFF09\u3002",-1),ba=s("p",null,"1.\u521B\u5EFAPVC",-1),ka=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim nfs-pvc.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: PersistentVolumeClaim")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: pvc-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  accessModes:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - ReadWriteOnce")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  resources:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    requests:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      storage: 1Gi")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  storageClassName: nfs")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),va=s("p",null,"\u521B\u5EFA\u5E76\u67E5\u770BPVC",-1),fa=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl create -f nfs-pvc.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'persistentvolumeclaim "pvc-demo" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pvc")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME       STATUS    VOLUME    CAPACITY   ACCESS MODES   STORAGECLASS   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pvc-demo   Bound     pv-demo   1Gi        RWO            nfs            6s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),xa=s("p",null,"2.\u4F7F\u7528PVC",-1),Pa=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim nginx-deployment-pvc.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: apps/v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: nginx-deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  replicas: 3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  selector:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    matchLabels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  template:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - name: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        image: nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - containerPort: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        volumeMounts:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'        - mountPath: "/usr/share/nginx/html"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          name: pvc-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      volumes:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - name: pvc-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        persistentVolumeClaim:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"          claimName: pvc-demo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Sa=s("h1",{id:"_11-4-storageclass",tabindex:"-1"},[n("11.4 StorageClass "),s("a",{class:"header-anchor",href:"#_11-4-storageclass","aria-hidden":"true"},"#")],-1),Ea=s("h1",{id:"_7-\u7B2C\u4E03\u6B65\uFF1A\u4F7F\u7528rancher\u7BA1\u7406kubernetes\u96C6\u7FA4",tabindex:"-1"},[n("7 \u7B2C\u4E03\u6B65\uFF1A\u4F7F\u7528Rancher\u7BA1\u7406Kubernetes\u96C6\u7FA4 "),s("a",{class:"header-anchor",href:"#_7-\u7B2C\u4E03\u6B65\uFF1A\u4F7F\u7528rancher\u7BA1\u7406kubernetes\u96C6\u7FA4","aria-hidden":"true"},"#")],-1),Na=s("p",null,"\u73B0\u5728\u6211\u4EEC\u5DF2\u7ECF\u5177\u5907\u628A\u5E94\u7528\u8FC1\u79FB\u5230Kubernetes\u4E2D\u6765\u7684\u80FD\u529B\uFF0C\u90A3\u4E48\u73B0\u5728\uFF0C\u8FC1\u79FB\u540E\uFF0C\u65E5\u5E38\u7684\u8FD0\u7EF4\u5DE5\u4F5C\u5C31\u53D1\u751F\u7684\u53D8\u5316\uFF0C\u622A\u6B62\u76EE\u524D\uFF0C\u5728\u751F\u4EA7\u73AF\u5883\u4E2D\uFF0C\u6211\u4EEC\u5F88\u5C11\u4F7F\u7528\u5B98\u65B9\u81EA\u5E26\u7684Dashbaord\u6765\u5B8C\u6210\u65E5\u5E38\u7684\u8FD0\u7EF4\u5DE5\u4F5C\uFF0C\u800C\u662F\u4F7F\u7528\u7B2C\u4E09\u65B9\u7684\u8FD0\u7EF4\u5DE5\u5177Rancher\u3002",-1),Ra=s("h2",{id:"_7-1-rancher\u5FEB\u901F\u5165\u95E8",tabindex:"-1"},[n("7.1 Rancher\u5FEB\u901F\u5165\u95E8 "),s("a",{class:"header-anchor",href:"#_7-1-rancher\u5FEB\u901F\u5165\u95E8","aria-hidden":"true"},"#")],-1),Ta=s("p",null,"\u5FEB\u901F\u90E8\u7F72\u5355\u673A\u7248Rancher",-1),Ka=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# mkdir /opt/rancher")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker run -d --restart=unless-stopped -v /opt/rancher:/var/lib/rancher/ -p 80:80 -p 443:443 rancher/rancher")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ia=s("h2",{id:"_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406",tabindex:"-1"},[n("7.2 \u4F7F\u7528Rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406 "),s("a",{class:"header-anchor",href:"#_7-2-\u4F7F\u7528rancher\u8FDB\u884C\u65E5\u5E38\u7BA1\u7406","aria-hidden":"true"},"#")],-1),Ma=s("h2",{id:"_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72",tabindex:"-1"},[n("7.3 Rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72 "),s("a",{class:"header-anchor",href:"#_7-3-rancher\u751F\u4EA7\u96C6\u7FA4\u90E8\u7F72","aria-hidden":"true"},"#")],-1),wa=s("h1",{id:"\u7B2C\u516D\u90E8\u5206-\u7BA1\u7406kubernetes\u4E2D\u7684\u5E94\u7528",tabindex:"-1"},[n("\u7B2C\u516D\u90E8\u5206 \u7BA1\u7406Kubernetes\u4E2D\u7684\u5E94\u7528 "),s("a",{class:"header-anchor",href:"#\u7B2C\u516D\u90E8\u5206-\u7BA1\u7406kubernetes\u4E2D\u7684\u5E94\u7528","aria-hidden":"true"},"#")],-1),La=s("h1",{id:"_13-\u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236\u548C\u5065\u5EB7\u68C0\u67E5",tabindex:"-1"},[n("13 \u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236\u548C\u5065\u5EB7\u68C0\u67E5 "),s("a",{class:"header-anchor",href:"#_13-\u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236\u548C\u5065\u5EB7\u68C0\u67E5","aria-hidden":"true"},"#")],-1),ja=s("h1",{id:"_13-1-\u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236",tabindex:"-1"},[n("13.1 \u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236 "),s("a",{class:"header-anchor",href:"#_13-1-\u5E94\u7528\u7684\u8D44\u6E90\u9650\u5236","aria-hidden":"true"},"#")],-1),Oa=s("h1",{id:"_13-2-\u5E94\u7528\u7684\u5065\u5EB7\u68C0\u67E5",tabindex:"-1"},[n("13.2 \u5E94\u7528\u7684\u5065\u5EB7\u68C0\u67E5 "),s("a",{class:"header-anchor",href:"#_13-2-\u5E94\u7528\u7684\u5065\u5EB7\u68C0\u67E5","aria-hidden":"true"},"#")],-1),Ga=s("h3",{id:"liveness\u63A2\u6D4B",tabindex:"-1"},[n("Liveness\u63A2\u6D4B "),s("a",{class:"header-anchor",href:"#liveness\u63A2\u6D4B","aria-hidden":"true"},"#")],-1),Ua=s("p",null,"Kubernetes\u6709\u4E24\u79CD\u63A2\u6D4B\u673A\u5236\uFF0CLiveness\u548CReadiness\uFF0C\u914D\u7F6E\u90FD\u662F\u76F8\u4F3C\u7684\uFF0C\u53EA\u662F\u5B9E\u73B0\u7684\u529F\u80FD\u4E0D\u540C\u3002 Liveness\u63A2\u6D4B\u662F\u9488\u5BF9Pod\u5065\u5EB7\u72B6\u6001\u7684\u63A2\u6D4B\uFF0C\u7C7B\u4F3C\u4E8E\u96C6\u7FA4\u4E2D\u7684\u5065\u5EB7\u68C0\u67E5\uFF0C\u7528\u6237\u53EF\u4EE5\u81EA\u5B9A\u4E49\u8FD9\u4E2A\u5065\u5EB7\u68C0\u67E5\u7684\u6761\u4EF6\uFF0C\u5982\u679C\u63A2\u6D4B\u5931\u8D25\uFF0CKubernetes\u5C06\u4F1A\u91CD\u542F\u5BB9\u5668\u3002 \u5982\u679C\u60A8\u5E0C\u671B\u5BB9\u5668\u5728\u63A2\u6D4B\u5931\u8D25\u65F6\u88AB\u6740\u6B7B\u5E76\u91CD\u65B0\u542F\u52A8\uFF0C\u90A3\u4E48\u8BF7\u6307\u5B9A\u4E00\u4E2ALiveness\u914D\u7F6E\uFF0C\u5E76\u6307\u5B9ArestartPolicy \u4E3A Always \u6216 OnFailure\u3002 \u914D\u7F6E\u6848\u4F8B",-1),Va=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"livenessProbe:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"exec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    command:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - ps aux | grep nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"initialDelaySeconds: 10")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"periodSeconds: 5")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"timeoutSeconds: 3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ha=s("h3",{id:"readiness\u63A2\u6D4B",tabindex:"-1"},[n("Readiness\u63A2\u6D4B "),s("a",{class:"header-anchor",href:"#readiness\u63A2\u6D4B","aria-hidden":"true"},"#")],-1),Ya=s("p",null,"Readiness\u63A2\u6D4B\u662F\u63A2\u6D4BPod\u662F\u5426\u51C6\u5907\u597D\u5BF9\u5916\u63D0\u4F9B\u8BBF\u95EE\uFF0C\u4F8B\u5982\u6211\u4EEC\u5728Pod\u91CC\u9762\u8FD0\u884C\u4E00\u4E2ATomcat\u7684\u5BB9\u5668\uFF0C\u91CC\u9762\u8FD0\u884C\u4E86\u4E00\u4E2AJenkins\u7684\u5E94\u7528\uFF0C\u90A3\u4E48\u7B49Jenkins\u5B8C\u5168\u542F\u52A8\u80FD\u63D0\u4F9B\u670D\u52A1\u53EF\u80FD\u9700\u89811\u5206\u949F\uFF0C\u6240\u4EE5\u5728\u57281\u5206\u949F\u4E4B\u524D\u662F\u4E0D\u80FD\u63D0\u4F9B\u7ED9\u7528\u6237\u8BBF\u95EE\u7684\uFF0C\u4E5F\u5C31\u662F\u4E0D\u80FD\u52A0\u5165Service\u7684\u8D1F\u8F7D\u5747\u8861\u4E2D\uFF0C\u8FD9\u4E2A\u5C31\u9760Readiness\u63A2\u6D4B\u6765\u63A7\u5236\u3002 Readiness\u7528\u6765\u63A7\u5236\u544A\u8BC9Kubernetes\u4EC0\u4E48\u65F6\u95F4\u53EF\u4EE5\u5C06\u5BB9\u5668\u52A0\u5165\u5230Service\u7684\u8D1F\u8F7D\u5747\u8861\u4E2D\uFF0C\u914D\u7F6E\u65B9\u6CD5\u548CLiveness\u4E00\u6837\uFF0C\u53EA\u9700\u8981\u4FEE\u6539livennessProbe\u66FF\u6362\u4E3AreadinessProbe\u5373\u53EF\u3002",-1),Fa=s("h2",{id:"\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5",tabindex:"-1"},[n("\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5 "),s("a",{class:"header-anchor",href:"#\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5","aria-hidden":"true"},"#")],-1),Ba=s("p",null,"Kubernetes\u7684\u5065\u5EB7\u68C0\u67E5\u662F\u7531\u8FD0\u884C\u5728\u5404\u4E2ANode\u4E0A\u7684kubelet\u6765\u5B8C\u6210\u7684\uFF0Ckubelet\u76EE\u524D\u652F\u6301\u4EE5\u4E0B\u4E09\u79CD\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5\uFF1A",-1),$a=s("ul",null,[s("li",null,"ExecAction\uFF1A\u5728\u5BB9\u5668\u4E2D\u6267\u884C\u6307\u5B9A\u7684\u547D\u4EE4\u3002\u5982\u679C\u547D\u4EE4\u9000\u51FA\u65F6\u72B6\u6001\u7801\u4E3A0\uFF0C\u5219\u8BA4\u4E3A\u8BCA\u65AD\u6210\u529F\u3002"),s("li",null,"TCPSocketAction:\u5BF9\u6307\u5B9A\u7AEF\u53E3\u4E0A\u5BB9\u5668\u7684IP\u5730\u5740\u6267\u884CTCP\u68C0\u67E5\u3002\u5982\u679C\u7AEF\u53E3\u662F\u6253\u5F00\u7684\uFF0C\u5219\u8BA4\u4E3A\u8BCA\u65AD\u662F\u6210\u529F\u7684\u3002"),s("li",null,"HTTPGetAction:\u5BF9\u6307\u5B9A\u7AEF\u53E3\u548C\u8DEF\u5F84\u4E0A\u5BB9\u5668\u7684IP\u5730\u5740\u6267\u884CHTTP Get\u8BF7\u6C42\u3002\u5982\u679C\u54CD\u5E94\u7684\u72B6\u6001\u7801\u5927\u4E8E\u6216\u7B49\u4E8E200\uFF0C\u5C0F\u4E8E400\uFF0C\u5219\u8BA4\u4E3A\u8BCA\u65AD\u662F\u6210\u529F\u7684\u3002")],-1),qa=s("p",null,"\u4EE5\u4E0A\u4E09\u79CD\u5065\u5EB7\u68C0\u67E5\u7684\u65B9\u6CD5\u4F1A\u6709\u4E09\u79CD\u8FD4\u56DE\u7ED3\u679C\uFF1A",-1),Ja=s("ul",null,[s("li",null,[s("p",null,"Success\uFF1A\u6210\u529F\uFF0C\u5BB9\u5668\u901A\u8FC7\u8BCA\u65AD\u3002")]),s("li",null,[s("p",null,"Failure\uFF1A\u5931\u8D25\uFF0C\u5BB9\u5668\u8BCA\u65AD\u5931\u8D25\u3002")]),s("li",null,[s("p",null,"Unknown\uFF1A\u63A2\u6D4B\u5931\u8D25\uFF0C\u65E0\u6CD5\u6267\u884C\u63A2\u6D4B\uFF0C\u6240\u4EE5\u4E0D\u5E94\u8BE5\u91C7\u53D6\u4EFB\u4F55\u884C\u52A8\u3002"),s("p",null,"\u9488\u5BF9\u4E8E\u63A2\u9488\u6709\u4EE5\u4E0B\u914D\u7F6E\u53C2\u6570\uFF0C\u9700\u8981\u6CE8\u610F\u4E0D\u7BA1\u662FLiveness\u8FD8\u662FReadiness\u63A2\u6D4B\uFF0C\u63A2\u9488\u7684\u4F7F\u7528\u90FD\u662F\u76F8\u540C\u7684\uFF0C\u552F\u4E00\u7684\u4E0D\u540C\u662F\u63A2\u6D4B\u5B8C\u6BD5\u540E\uFF0C\u6267\u884C\u64CD\u4F5C\u7684\u4E0D\u540C\u3002")]),s("li",null,[s("p",null,"initialDelaySeconds: \u63A2\u6D4B\u7684\u5EF6\u8FDF\u65F6\u95F4\uFF0C\u5355\u4F4D\u662F\u79D2\u3002\u4E5F\u5C31\u662F\u8BF4\u5728\u5BB9\u5668\u542F\u52A8\u591A\u5C11\u79D2\u4E4B\u540E\u5F00\u59CB\u8FDB\u884C\u7B2C\u4E00\u6B21\u63A2\u6D4B\uFF0C\u4F8B\u5982\u4F60\u542F\u52A8\u4E00\u4E2AJava\u7684\u5E94\u7528\u9700\u898150\u79D2\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u503C\u5C31\u9700\u8981\u5927\u4E8E50s\u3002\u6240\u4EE5\u8FD9\u4E2A\u503C\u662F\u9700\u8981\u6839\u636E\u5E94\u7528\u7684\u5177\u4F53\u60C5\u51B5\u6765\u8BBE\u7F6E\u3002")]),s("li",null,[s("p",null,"periodSeconds\uFF1A\u63A2\u6D4B\u6267\u884C\u7684\u5468\u671F\u65F6\u95F4\uFF0C\u5355\u4F4D\u662F\u79D2\u3002\u662F\u6307\u6BCF\u9694\u591A\u957F\u65F6\u95F4\u6267\u884C\u4E00\u6B21\u63A2\u6D4B\uFF0C\u9891\u7387\u8D8A\u9AD8\uFF0C\u53D1\u73B0\u6545\u969C\u7684\u65F6\u95F4\u4E5F\u5C31\u8D8A\u77ED\uFF0C\u5E76\u4E0D\u662F\u8D8A\u77ED\u8D8A\u597D\u3002\u5982\u679C\u5E94\u7528\u670D\u52A1\u4E0D\u591F\u7A33\u5B9A\uFF0C\u592A\u9AD8\u7684\u9891\u7387\u53CD\u800C\u4F1A\u5BFC\u81F4\u5F88\u591A\u4F60\u8BA4\u4E3A\u7684\u201C\u8BEF\u62A5\u201D\u3002\u9ED8\u8BA4\u662F10\u79D2\uFF0C\u6700\u5C0F\u503C\u662F1\u79D2\u3002")]),s("li",null,[s("p",null,"timeoutSeconds: \u63A2\u6D4B\u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\u662F\u79D2\uFF0C\u6267\u884C\u63A2\u6D4B\u5982\u679C\u8D85\u8FC7\u8FD9\u4E2A\u65F6\u95F4\u6CA1\u6709\u8FD4\u56DE\u7ED3\u679C\uFF0C\u53D8\u610F\u5473\u7740\u63A2\u6D4B\u7684\u7ED3\u679C\u662F\u5931\u8D25\u3002\u9ED8\u8BA4\u4E3A1\u79D2\u3002\u6700\u5C0F\u503C\u662F1\u79D2\u3002")]),s("li",null,[s("p",null,"failureThreshold\uFF1A\u63A2\u6D4B\u6210\u529F\u540E\uFF0C\u6700\u5C11\u8FDE\u7EED\u63A2\u6D4B\u5931\u8D25\u591A\u5C11\u6B21\u624D\u88AB\u8BA4\u5B9A\u4E3A\u5931\u8D25\u3002\u8FD9\u4E2A\u662FKubernetes\u5C06\u5728\u653E\u5F03\u4E4B\u524D\u5C1D\u8BD5\u5931\u8D25\u9608\u503C\u65F6\u95F4\u3002\u653E\u5F03\u751F\u547D\u63A2\u6D4B\u610F\u5473\u7740\u91CD\u65B0\u542F\u52A8Pod\u3002\u4E00\u65E6\u51C6\u5907\u5C31\u7EEA\uFF0CPod\u5C06\u88AB\u6807\u8BB0\u4E3A\u672A\u51C6\u5907\u5C31\u7EEA\u3002\u9ED8\u8BA4\u4E3A3\u3002\u6700\u5C0F\u503C\u662F1\u3002")]),s("li",null,[s("p",null,"successThreshold: \u5728\u63A2\u6D4B\u5931\u8D25\u540E\uFF0C\u6700\u5C11\u8FDE\u7EED\u63A2\u6D4B\u6210\u529F\u591A\u5C11\u6B21\u624D\u88AB\u8BA4\u5B9A\u4E3A\u6210\u529F\u3002\u9ED8\u8BA4\u4E3A1\uFF0C\u4E5F\u5C31\u662F\u5FC5\u987B\u63A2\u6D4B\u6210\u529F1\u6B21\uFF0C\u624D\u80FD\u8BA4\u4E3A\u72B6\u6001\u6062\u590D\uFF0C\u6700\u5C0F\u503C\u662F1\u3002"),s("h1",{id:"\u7BA1\u7406\u5E94\u7528\u7684dns\u8BBF\u95EE",tabindex:"-1"},[n("\u7BA1\u7406\u5E94\u7528\u7684DNS\u8BBF\u95EE "),s("a",{class:"header-anchor",href:"#\u7BA1\u7406\u5E94\u7528\u7684dns\u8BBF\u95EE","aria-hidden":"true"},"#")])])],-1),za=s("h1",{id:"_14-1-kubernetes\u4E2D\u7684dns",tabindex:"-1"},[s("a",{href:"http://k8s.unixhot.com/",target:"_blank",rel:"noreferrer"},"14.1 Kubernetes\u4E2D\u7684DNS"),n(),s("a",{class:"header-anchor",href:"#_14-1-kubernetes\u4E2D\u7684dns","aria-hidden":"true"},"#")],-1),Wa=s("h1",{id:"\u5E94\u7528\u7684dns\u7BA1\u7406",tabindex:"-1"},[n("\u5E94\u7528\u7684DNS\u7BA1\u7406 "),s("a",{class:"header-anchor",href:"#\u5E94\u7528\u7684dns\u7BA1\u7406","aria-hidden":"true"},"#")],-1),Za=s("h3",{id:"pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565",tabindex:"-1"},[n("Pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565 "),s("a",{class:"header-anchor",href:"#pod\u7684\u57DF\u540D\u89E3\u6790\u7B56\u7565","aria-hidden":"true"},"#")],-1),Xa=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl run dns-test --generator=run-pod/v1 --image=alpine --replicas=1 sleep 360000")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"pod/dns-test created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Qa=s("p",null,"\u67E5\u770BPod",-1),so=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod dns-test")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME       READY   STATUS    RESTARTS   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"dns-test   1/1     Running   0          79s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),no=s("p",null,"Pod\u9ED8\u8BA4\u7684DNS\u914D\u7F6E",-1),lo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl exec -it dns-test /bin/sh")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/ # cat /etc/resolv.conf ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nameserver 10.1.0.10")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"search default.svc.cluster.local svc.cluster.local cluster.local")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"options ndots:5")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),eo=s("p",null,"\u5982\u4F55\u8BBF\u95EEService\u540D\u79F0",-1),ao=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/ # ping -c 3 wordpress-service.default.svc.cluster.local")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"PING wordpress-service.default.svc.cluster.local (10.1.92.244): 56 data bytes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"64 bytes from 10.1.92.244: seq=0 ttl=64 time=0.074 ms")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"64 bytes from 10.1.92.244: seq=1 ttl=64 time=0.141 ms")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"64 bytes from 10.1.92.244: seq=2 ttl=64 time=0.187 ms")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--- wordpress-service.default.svc.cluster.local ping statistics ---")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3 packets transmitted, 3 packets received, 0% packet loss")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"round-trip min/avg/max = 0.074/0.134/0.187 ms")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),oo=s("p",null,"DNS\u67E5\u8BE2\u7B56\u7565",-1),to=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod dns-test -o yaml | grep dnsPolicy")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  dnsPolicy: ClusterFirst")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),co=s("ul",null,[s("li",null,"Default: Pod\u4ECE\u5176\u8FD0\u884C\u7684\u8282\u70B9\u4E2D\u7EE7\u627F\u540D\u79F0\u89E3\u6790\u914D\u7F6E\u3002"),s("li",null,"ClusterFirst:\uFF08\u9ED8\u8BA4\u7B56\u7565\uFF09\u4E0E\u914D\u7F6E\u7684\u7FA4\u96C6\u57DF\u540D\u540E\u7F00\u4E0D\u5339\u914D\u7684\u4EFB\u4F55DNS\u67E5\u8BE2\u90FD\u5C06\u8F6C\u53D1\u5230\u4ECE\u8282\u70B9\u7EE7\u627F\u7684\u4E0A\u6E38\u540D\u79F0\u670D\u52A1\u5668\u3002"),s("li",null,"ClusterFirstWithHostNet: \u5982\u679CPod\u4F7F\u7528\u4E86hostNetwork\uFF08\u4F8B\u5982Ingress Controller Treafik\u5C31\u662F\u4F7F\u7528\u4E86hostNetwok\uFF09\uFF0C\u5E94\u663E\u5F0F\u8BBE\u7F6E\u5176DNS\u7B56\u7565\u4E3A\u201CClusterFirstWithHostNet\u201D\u3002"),s("li",null,"None: \u5B83\u5141\u8BB8Pod\u5FFD\u7565Kubernetes\u73AF\u5883\u4E2D\u7684DNS\u8BBE\u7F6E\uFF0C\u8FD9\u65F6\u5019\u4F1A\u4F7F\u7528Pod Spec\u4E2D\u7684dnsConfig\u5B57\u6BB5\u63D0\u4F9B\u7684DNS\u8BBE\u7F6E\u3002")],-1),ro=s("h2",{id:"\u5E94\u7528\u7684dns\u7BA1\u7406-1",tabindex:"-1"},[n("\u5E94\u7528\u7684DNS\u7BA1\u7406 "),s("a",{class:"header-anchor",href:"#\u5E94\u7528\u7684dns\u7BA1\u7406-1","aria-hidden":"true"},"#")],-1),io=s("h2",{id:"_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E",tabindex:"-1"},[n("15.1 \u4F7F\u7528ConfigMap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E "),s("a",{class:"header-anchor",href:"#_15-1-\u4F7F\u7528configmap\u7BA1\u7406\u5E94\u7528\u914D\u7F6E","aria-hidden":"true"},"#")],-1),po=s("h3",{id:"\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap",tabindex:"-1"},[n("\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAConfigMap "),s("a",{class:"header-anchor",href:"#\u901A\u8FC7kubectl\u547D\u4EE4\u521B\u5EFAconfigmap","aria-hidden":"true"},"#")],-1),Ao=s("p",null,[s("strong",null,"\u521B\u5EFA\u4E00\u4E2A\u540D\u79F0\u4E3Acmd-config\u7684ConfigMap")],-1),Co=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap cmd-config --from-literal=host=www.unixhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/cmd-config created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),uo=s("p",null,[s("strong",null,"\u67E5\u770BConfigMap")],-1),yo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get configmap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME         DATA   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"cmd-config   1      63s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ho=s("p",null,[s("strong",null,"\u67E5\u770BConfigMap\u5185\u5BB9")],-1),Do=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl describe configmap cmd-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Name:         cmd-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Namespace:    default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Labels:       <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Annotations:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Data")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"====")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"host:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"----")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"www.unixhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Events:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),go=s("p",null,[s("strong",null,"ConfigMap\u4E2D\u5305\u542B\u591A\u4E2A\u952E\u503C\u5BF9"),n(" \u53EF\u4EE5\u591A\u6B21\u4F7F\u7528--from-literal\u4E3A\u4E00\u4E2AConfigMap\u521B\u5EFA\u591A\u4E2A\u952E\u503C\u5BF9\uFF0C\u4E2D\u95F4\u7528\u7A7A\u683C\u5206\u9694")],-1),mo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap mcmd-config --from-literal=host=www.unixhot.com --from-literal=port=443 --from-literal=ssl=on")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/mcmd-config created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),_o=s("h3",{id:"\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap",tabindex:"-1"},[n("\u901A\u8FC7YAML\u6587\u4EF6\u521B\u5EFAConfigMap "),s("a",{class:"header-anchor",href:"#\u901A\u8FC7yaml\u6587\u4EF6\u521B\u5EFAconfigmap","aria-hidden":"true"},"#")],-1),bo=s("p",null,"\u67E5\u770B\u5DF2\u521B\u5EFA\u7684ConfigMap\u751F\u6210\u7684YAML\u6587\u4EF6",-1),ko=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get configmap mcmd-config -o yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"data:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  host: www.unixhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  port: "443"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  ssl: "on"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: ConfigMap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  creationTimestamp: "2019-11-05T01:45:13Z"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: mcmd-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  resourceVersion: "5394993"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  selfLink: /api/v1/namespaces/default/configmaps/mcmd-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  uid: 02012d69-e324-4e9d-ba04-7132e9f6ecd8")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),vo=s("p",null,"\u53EA\u9700\u8981\u5C06metadata\u4E2D\u65E0\u9700\u6307\u5B9A\u7684\u5B57\u6BB5\u53BB\u6389\u5373\u53EF\u751F\u6210\u4E00\u4E2AYAML\u6587\u4EF6\u3002",-1),fo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get configmap mcmd-config -o yaml > mcmd-config-v2.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# vim mcmd-config-v2.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"data:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  host: www.unixhot.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  port: "443"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  ssl: "on"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: ConfigMap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: mcmd-config-v2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),xo=s("p",null,[s("a",{href:"http://xn--metadata-0n3mp82lcujlhxj58f8qvb.name",target:"_blank",rel:"noreferrer"},"\u6CE8\u610F\u9700\u8981\u4FEE\u6539metadata.name"),n(",\u4FEE\u6539\u5B8C\u6BD5\u540E\u76F4\u63A5\u521B\u5EFA\u5373\u53EF")],-1),Po=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create -f mcmd-config-v2.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/mcmd-config-v2 created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get configmap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME             DATA   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"cmd-config       1      24m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mcmd-config      3      16m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"mcmd-config-v2   3      9s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),So=s("h3",{id:"\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap",tabindex:"-1"},[n("\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAConfigMap "),s("a",{class:"header-anchor",href:"#\u901A\u8FC7\u6587\u4EF6\u521B\u5EFAconfigmap","aria-hidden":"true"},"#")],-1),Eo=s("p",null,"ConfigMap\u9664\u4E86\u53EF\u4EE5\u5B58\u50A8\u5355\u4E2A\u6216\u8005\u591A\u4E2A\u952E\u503C\u5BF9\u4E4B\u5916\uFF0C\u53EF\u4EE5\u5B58\u50A8\u5B8C\u6574\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u5C06\u5355\u4E2A\u914D\u7F6E\u6587\u4EF6\u76F4\u63A5\u8F6C\u6362\u4E3AConfigMap\u5728\u751F\u4EA7\u4E2D\u5341\u5206\u5E38\u7528",-1),No=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap file-config --from-file=/etc/hosts")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/file-config created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ro=s("p",null,"\u53EF\u4EE5\u770B\u5230ConfigMap\u76F4\u63A5\u5B58\u50A8\u4E86\u6587\u4EF6\u7684\u5185\u5BB9\uFF0CKey\u540D\u79F0\u4E3A\u6587\u4EF6\u540Dhosts\uFF0C\u4E5F\u53EF\u4EE5\u624B\u52A8\u6307\u5B9AKey\u7684\u540D\u79F0\u3002",-1),To=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl describe configmap file-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Name:         file-config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Namespace:    default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Labels:       <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Annotations:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Data")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"====")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"hosts:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"----")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"::1         localhost localhost.localdomain localhost6 localhost6.localdomain6")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.27 k8s-master1 k8s-master1.dianjoy.com ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.28 k8s-master2 k8s-master2.dianjoy.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.29 k8s-master3 k8s-master3.dianjoy.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Events:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ko=s("p",null,"\u5C06Key\u624B\u52A8\u6307\u5B9A\u4E3Ahost-hosts",-1),Io=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap file-config-v2 --from-file=host-hosts=/etc/hosts")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/file-config-v2 created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl describe configmap file-config-v2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Name:         file-config-v2")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Namespace:    default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Labels:       <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Annotations:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Data")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"====")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"host-hosts:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"----")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"::1         localhost localhost.localdomain localhost6 localhost6.localdomain6")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.27 k8s-master1 k8s-master1.dianjoy.com ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.28 k8s-master2 k8s-master2.dianjoy.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"192.168.99.29 k8s-master3 k8s-master3.dianjoy.com")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Events:  <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Mo=s("h3",{id:"\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap",tabindex:"-1"},[n("\u4ECE\u76EE\u5F55\u521B\u5EFAConfigMap "),s("a",{class:"header-anchor",href:"#\u4ECE\u76EE\u5F55\u521B\u5EFAconfigmap","aria-hidden":"true"},"#")],-1),wo=s("p",null,"ConfigMap\u8FD8\u652F\u6301\u901A\u8FC7\u76EE\u5F55\u521B\u5EFA\uFF0Ckubectl\u4F1A\u4E3A\u76EE\u5F55\u4E2D\u7684\u6BCF\u4E2A\u6587\u4EF6\u5355\u72EC\u521B\u5EFA\u6761\u76EE\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F\u5982\u679C\u76EE\u5F55\u4E0B\u9762\u5305\u542B\u5B50\u76EE\u5F55\uFF0C\u4F1A\u5FFD\u7565\u8FD9\u4E9B\u5B50\u76EE\u5F55\u548C\u5B50\u76EE\u5F55\u91CC\u9762\u7684\u5185\u5BB9\u3002",-1),Lo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap dir-config --from-file=/etc/kubernetes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/dir-config created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),jo=s("h3",{id:"\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap",tabindex:"-1"},[n("\u6DF7\u5408\u9009\u9879\u521B\u5EFAConfigMap "),s("a",{class:"header-anchor",href:"#\u6DF7\u5408\u9009\u9879\u521B\u5EFAconfigmap","aria-hidden":"true"},"#")],-1),Oo=s("p",null,"\u540C\u65F6\u4F7F\u7528\u547D\u4EE4\u884C\u3001\u6587\u4EF6\u3001\u76EE\u5F55\u521B\u5EFAConfigMap\u4E5F\u662F\u652F\u6301\u7684\uFF0C\u53EA\u9700\u8981\u4F7F\u7528\u4E0D\u540C\u7684\u9009\u9879\u5373\u53EF\u3002",-1),Go=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl create configmap mycp --from-literal=env=test \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," --from-file=/etc/hosts \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," --from-file=myhosts=/etc/hosts \\")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," --from-file=/etc/kubernetes")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"configmap/mycp created")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Uo=s("p",null,"ConfigMap\u7684\u5185\u5BB9\u53EF\u4EE5\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7684\u5F62\u6210\u4F20\u9012\u7ED9\u5BB9\u5668\uFF0C\u4E5F\u53EF\u901A\u8FC7\u548CVolume\u7684\u5F62\u5F0F\u6302\u8F7D\u5230\u5BB9\u5668\u4E2D\u3002",-1),Vo=s("h3",{id:"\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap",tabindex:"-1"},[n("\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012ConfigMap "),s("a",{class:"header-anchor",href:"#\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7ED9\u5BB9\u5668\u4F20\u9012configmap","aria-hidden":"true"},"#")],-1),Ho=s("p",null,"\u53EF\u4EE5\u5C06ConfigMap\u4E2D\u7684\u952E\u503C\u5BF9\u6570\u636E\u901A\u8FC7\u73AF\u5883\u53D8\u91CF\u7684\u5F62\u5F0F\u4F20\u9012\u5230\u5BB9\u5668\u4E2D\uFF0C\u8FD9\u6837\u5728\u914D\u7F6E\u5BB9\u5668\u7684\u65F6\u5019\u6709\u4E00\u4E9B\u6570\u636E\u53EF\u4EE5\u4F7F\u7528\u73AF\u5883\u53D8\u91CF\uFF0C\u7136\u540E\u4F7F\u7528ConfigMap\u8FDB\u884C\u586B\u5145\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u5B9E\u73B0\u914D\u7F6E\u548CPod\u7684\u5206\u79BB\u3002",-1),Yo=s("h2",{id:"_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E",tabindex:"-1"},[n("15.2 \u4F7F\u7528Secret\u7BA1\u7406\u654F\u611F\u6570\u636E "),s("a",{class:"header-anchor",href:"#_15-2-\u4F7F\u7528secret\u7BA1\u7406\u654F\u611F\u6570\u636E","aria-hidden":"true"},"#")],-1),Fo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u5728\u5E94\u7528\u542F\u52A8\u8FC7\u7A0B\u4E2D\u7ECF\u5E38\u4F1A\u6709\u4E00\u4E9B\u654F\u611F\u4FE1\u606F\u9700\u8981\u5B58\u50A8\uFF0C\u4F8B\u5982\u7528\u6237\u540D\u548C\u5BC6\u7801\u7B49\uFF0C\u5982\u679C\u76F4\u63A5\u660E\u6587\u7684\u65B9\u5F0F\u4FDD\u5B58\u4F1A\u6709\u5B89\u5168\u98CE\u9669\u3002\u5728Kubernetes\u4E2DSecret\u8FD9\u4E2A\u8D44\u6E90\u5BF9\u8C61\u7C7B\u578B\u7528\u6765\u4FDD\u5B58\u654F\u611F\u4FE1\u606F\uFF0C\u4F8B\u5982\u5BC6\u7801\u3001\u5BC6\u94A5\u3001\u8BBF\u95EE\u4EE4\u724C\u3001SSH Key\u7B49\u4F60\u8BA4\u4E3A\u9700\u8981\u4FDD\u5BC6\u7684\u654F\u611F\u4FE1\u606F\u3002\u76F8\u5BF9\u4E8E\u5C06\u8FD9\u4E9B\u5185\u5BB9\u4FDD\u5B58\u5230\u5BB9\u5668\u955C\u50CF\u6216\u8005Pod\u7684\u5B9A\u4E49\u6587\u4EF6\u4E2D\uFF0C\u66F4\u52A0\u7684\u7075\u6D3B\u548C\u5B89\u5168\u3002")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Bo=s("h3",{id:"\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF",tabindex:"-1"},[n("\u914D\u7F6EPod\u4F7F\u7528Harbor\u955C\u50CF "),s("a",{class:"header-anchor",href:"#\u914D\u7F6Epod\u4F7F\u7528harbor\u955C\u50CF","aria-hidden":"true"},"#")],-1),$o=s("p",null,"1\uFF0Edocker login\u5F97\u5230 docker\u5BC6\u7801\u6587\u4EF6",-1),qo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# docker login 192.168.56.11")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Jo=s("p",null,"2.\u5BF9\u5BC6\u7801\u6587\u4EF6\u8FDB\u884C\u52A0\u5BC6",-1),zo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cat /root/.docker/config.json |base64")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Wo=s("p",null,"3.\u521B\u5EFAharbor\u4F7F\u7528\u7684Secret YAML\u6587\u4EF6\uFF1A",-1),Zo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim harbor-secret.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Secret")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: harbor-secret")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"data:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  .dockerconfigjson: 'ewoJImF1dGhzIjogewoJCSJyZWcuZ3JlYXRvcHMubmV0IjogewoJCQkiYXV0aCI6ICJZV1J0YVc0Nk1YRmhlbmh6ZHpJPSIKCQl9Cgl9Cn0='")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"type: kubernetes.io/dockerconfigjson")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Xo=s("p",null,"4.\u521B\u5EFASecret",-1),Qo=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@jenkins k8s-deploy]# kubectl create -f reg-harbor.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'secret "reg-harbor" created')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),st=s("p",null,"5.\u521B\u5EFApod\u5E76\u6302\u8F7D\u8D44\u6E90",-1),nt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: sectest")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - name: sectest")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    image: 123.207.154.16/base/redis:alpine")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - containerPort: 6379")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  imagePullSecrets:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - name: harbor-secret")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),lt=s("h1",{id:"\u4F7F\u7528helm\u7BA1\u7406kubernetes\u5E94\u7528",tabindex:"-1"},[n("\u4F7F\u7528Helm\u7BA1\u7406Kubernetes\u5E94\u7528 "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528helm\u7BA1\u7406kubernetes\u5E94\u7528","aria-hidden":"true"},"#")],-1),et=s("p",null,"\u901A\u8FC7\u524D\u9762\u7684\u5B66\u4E60\uFF0C\u638C\u63E1\u4E86\u5C06\u5E94\u7528\u8FC1\u79FB\u81F3Kubernetes\u7684\u6B65\u9AA4\u548C\u6280\u5DE7\uFF0C\u8FC7\u7A0B\u6BD4\u8F83\u8270\u8F9B\u3002\u4F8B\u5982\u6211\u4EEC\u521B\u5EFA\u4E00\u4E2A\u5E94\u7528\uFF0C\u6D89\u53CA\u5230Deployment\u3001Service\u3001Ingress\u3001PV\u3001PVC\uFF0C\u5982\u4F55\u6709\u6548\u7684\u7BA1\u7406\u8FD9\u4E9B\u8D44\u6E90\u5462\uFF0CKubernetes\u7ED9\u51FA\u4E86\u4E00\u4E2A\u6700\u4F73\u5B9E\u8DF5\u5C31\u662FHelm\u3002 Helm\u662F\u4E00\u4E2Akubernetes\u5E94\u7528\u7684\u5305\u7BA1\u7406\u5DE5\u5177\uFF0C\u7528\u6765\u7BA1\u7406charts\u2014\u2014\u9884\u5148\u914D\u7F6E\u597D\u7684\u5B89\u88C5\u5305\u8D44\u6E90\uFF0C\u6709\u70B9\u7C7B\u4F3C\u4E8EUbuntu\u7684APT\u548CCentOS\u4E2D\u7684yum\u3002 Helm chart\u662F\u7528\u6765\u5C01\u88C5kubernetes\u539F\u751F\u5E94\u7528\u7A0B\u5E8F\u7684yaml\u6587\u4EF6\uFF0C\u53EF\u4EE5\u5728\u4F60\u90E8\u7F72\u5E94\u7528\u7684\u65F6\u5019\u81EA\u5B9A\u4E49\u5E94\u7528\u7A0B\u5E8F\u7684\u4E00\u4E9Bmetadata\uFF0C\u4FBF\u4E0E\u5E94\u7528\u7A0B\u5E8F\u7684\u5206\u53D1\u3002",-1),at=s("p",null,"Helm\u548Ccharts\u7684\u4E3B\u8981\u4F5C\u7528\uFF1A",-1),ot=s("ul",null,[s("li",null,"\u5E94\u7528\u7A0B\u5E8F\u5C01\u88C5"),s("li",null,"\u7248\u672C\u7BA1\u7406"),s("li",null,"\u4F9D\u8D56\u68C0\u67E5"),s("li",null,"\u4FBF\u4E8E\u5E94\u7528\u7A0B\u5E8F\u5206\u53D1")],-1),tt=s("h2",{id:"helm\u90E8\u7F72",tabindex:"-1"},[n("Helm\u90E8\u7F72 "),s("a",{class:"header-anchor",href:"#helm\u90E8\u7F72","aria-hidden":"true"},"#")],-1),ct=s("h3",{id:"\u5B89\u88C5helm",tabindex:"-1"},[n("\u5B89\u88C5Helm "),s("a",{class:"header-anchor",href:"#\u5B89\u88C5helm","aria-hidden":"true"},"#")],-1),rt=s("p",null,"1.\u90E8\u7F72Helm\u5BA2\u6237\u7AEF",-1),it=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd /usr/local/src")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# wget https://get.helm.sh/helm-v3.0.2-linux-amd64.tar.gz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# tar zxf helm-v3.0.2-linux-amd64.tar.gz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# mv linux-amd64/helm /usr/local/bin/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),pt=s("p",null,"2.\u9A8C\u8BC1\u5B89\u88C5\u662F\u5426\u6210\u529F",-1),At=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm version")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'version.BuildInfo{Version:"v3.0.2", GitCommit:"19e47ee3283ae98139d98460de796c1be1e3975f", GitTreeState:"clean", GoVersion:"go1.13.5"}')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ct=s("h3",{id:"\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528",tabindex:"-1"},[n("\u4F7F\u7528Helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528 "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528helm\u90E8\u7F72\u7B2C\u4E00\u4E2A\u5E94\u7528","aria-hidden":"true"},"#")],-1),dt=s("p",null,"4.\u641C\u7D22Helm\u5E94\u7528",-1),ut=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm search jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME              CHART VERSION    APP VERSION    DESCRIPTION                                       ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"stable/jenkins    0.13.5           2.73           Open source continuous integration server. It s...")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),yt=s("p",null,"5.\u67E5\u770B\u4ED3\u5E93",-1),ht=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm repo list")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME      URL                                                   ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"stable    https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"local     http://127.0.0.1:8879/charts")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Dt=s("p",null,"6.\u5B89\u88C5\u7B2C\u4E00\u4E2A\u5E94\u7528",-1),gt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm install stable/jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME:   viable-seal")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"LAST DEPLOYED: Thu Jul 26 19:21:07 2018")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAMESPACE: default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"STATUS: DEPLOYED")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"RESOURCES:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/ConfigMap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                       DATA  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins        3     1s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins-tests  1     1s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/PersistentVolumeClaim")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                 STATUS   VOLUME  CAPACITY  ACCESS MODES  STORAGECLASS  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins  Pending  1s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                       TYPE          CLUSTER-IP   EXTERNAL-IP  PORT(S)         AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins-agent  ClusterIP     10.1.154.54  <none>       50000/TCP       1s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins        LoadBalancer  10.1.63.24   <pending>    8080:20031/TCP  0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1beta1/Deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                 DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins  1        1        1           0          0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Pod(related)")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                                  READY  STATUS   RESTARTS  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins-7f5c7bd8d4-gc5hv  0/1    Pending  0         0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Secret")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                 TYPE    DATA  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal-jenkins  Opaque  2     1s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NOTES:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1. Get your 'admin' user password by running:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  printf $(kubectl get secret --namespace default viable-seal-jenkins -o jsonpath="{.data.jenkins-admin-password}" | base64 --decode);echo')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"2. Get the Jenkins URL to visit by running these commands in the same shell:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  NOTE: It may take a few minutes for the LoadBalancer IP to be available.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        You can watch the status of by running 'kubectl get svc --namespace default -w viable-seal-jenkins'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  export SERVICE_IP=$(kubectl get svc --namespace default viable-seal-jenkins --template "{{ range (index .status.loadBalancer.ingress 0) }}{{ . }}{{ end }}")')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  echo http://$SERVICE_IP:8080/login")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3. Login with the password from step 1 and the username: admin")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"For more information on running Jenkins on Kubernetes, visit:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https://cloud.google.com/solutions/jenkins-on-container-engine")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),mt=s("h1",{id:"_15-2-\u6DF1\u5165\u7406\u89E3helm",tabindex:"-1"},[n("15.2 \u6DF1\u5165\u7406\u89E3Helm "),s("a",{class:"header-anchor",href:"#_15-2-\u6DF1\u5165\u7406\u89E3helm","aria-hidden":"true"},"#")],-1),_t=s("h3",{id:"helm\u7EC4\u4EF6",tabindex:"-1"},[n("Helm\u7EC4\u4EF6 "),s("a",{class:"header-anchor",href:"#helm\u7EC4\u4EF6","aria-hidden":"true"},"#")],-1),bt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# tree ~/.helm/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/root/.helm/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 cache")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2514\u2500\u2500 archive")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502       \u2514\u2500\u2500 jenkins-0.13.5.tgz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 plugins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 repository")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 cache")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2502   \u251C\u2500\u2500 local-index.yaml -> /root/.helm/repository/local/index.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2502   \u2514\u2500\u2500 stable-index.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 local")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2502   \u2514\u2500\u2500 index.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2514\u2500\u2500 repositories.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2514\u2500\u2500 starters")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"7 directories, 5 files")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),kt=s("p",null,"\u9ED8\u8BA4\u7F13\u5B58\u7684\u6587\u4EF6",-1),vt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd .helm/cache/archive/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 archive]# ls -l")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"total 16")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r-- 1 root root 12650 Jul 26 19:21 jenkins-0.13.5.tgz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 archive]# tar zxf jenkins-0.13.5.tgz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 archive]# mv jenkins ~/.helm/repository/local/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd ~/.helm/repository/local/jenkins/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 jenkins]# tree")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},".")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 Chart.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 OWNERS")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 README.md")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 templates")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 config.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 _helpers.tpl")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 home-pvc.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-agent-svc.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-master-deployment.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-master-ingress.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-master-networkpolicy.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-master-svc.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jenkins-test.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 jobs.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 NOTES.txt")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 rbac.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 secret.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 service-account.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2514\u2500\u2500 test-config.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2514\u2500\u2500 values.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1 directory, 19 files")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ft=s("h3",{id:"\u81EA\u5B9A\u4E49jenkins\u7684chart",tabindex:"-1"},[n("\u81EA\u5B9A\u4E49Jenkins\u7684Chart "),s("a",{class:"header-anchor",href:"#\u81EA\u5B9A\u4E49jenkins\u7684chart","aria-hidden":"true"},"#")],-1),xt=s("p",null,"\u4FEE\u6539\u4E3ANodePort",-1),Pt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 jenkins]# vim values.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ServiceType: NodePort")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),St=s("p",null,"\u68C0\u67E5",-1),Et=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm lint ~/.helm/repository/local/jenkins/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> Linting /root/.helm/repository/local/jenkins/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Lint OK")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1 chart(s) linted, no failures")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Nt=s("p",null,"\u67E5\u770B\u6709\u54EA\u4E9B\u5E94\u7528",-1),Rt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm list")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME           REVISION    UPDATED                     STATUS      CHART          NAMESPACE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"viable-seal    1           Thu Jul 26 19:21:07 2018    DEPLOYED    jenkins-0.13.5 default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm delete --purge viable-seal")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'release "viable-seal" deleted')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm install ~/.helm/repository/local/jenkins/ --name devops-jenkins ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME:   devops-jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"LAST DEPLOYED: Thu Jul 26 19:36:10 2018")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAMESPACE: default")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"STATUS: DEPLOYED")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"RESOURCES:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Secret")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            TYPE    DATA  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins  Opaque  2     0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/ConfigMap")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                  DATA  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins        3     0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins-tests  1     0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/PersistentVolumeClaim")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            STATUS   VOLUME  CAPACITY  ACCESS MODES  STORAGECLASS  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins  Pending  0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                  TYPE       CLUSTER-IP   EXTERNAL-IP  PORT(S)         AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins-agent  ClusterIP  10.1.74.175  <none>       50000/TCP       0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins        NodePort   10.1.3.112   <none>       8080:23558/TCP  0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1beta1/Deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME            DESIRED  CURRENT  UP-TO-DATE  AVAILABLE  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins  1        1        1           0          0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"==> v1/Pod(related)")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                            READY  STATUS   RESTARTS  AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"devops-jenkins-64d54b79c-pwjfb  0/1    Pending  0         0s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NOTES:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"1. Get your 'admin' user password by running:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  printf $(kubectl get secret --namespace default devops-jenkins -o jsonpath="{.data.jenkins-admin-password}" | base64 --decode);echo')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"2. Get the Jenkins URL to visit by running these commands in the same shell:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  export NODE_PORT=$(kubectl get --namespace default -o jsonpath="{.spec.ports[0].nodePort}" services devops-jenkins)')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  export NODE_IP=$(kubectl get nodes --namespace default -o jsonpath="{.items[0].status.addresses[0].address}")')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  echo http://$NODE_IP:$NODE_PORT/login")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"3. Login with the password from step 1 and the username: admin")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"For more information on running Jenkins on Kubernetes, visit:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https://cloud.google.com/solutions/jenkins-on-container-engine")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Tt=s("p",null,"\u67E5\u770B\u72B6\u6001",-1),Kt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm status devops-jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),It=s("h2",{id:"\u521B\u5EFA\u81EA\u5DF1\u7684chart",tabindex:"-1"},[n("\u521B\u5EFA\u81EA\u5DF1\u7684Chart "),s("a",{class:"header-anchor",href:"#\u521B\u5EFA\u81EA\u5DF1\u7684chart","aria-hidden":"true"},"#")],-1),Mt=s("h3",{id:"\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart",tabindex:"-1"},[n("\u521B\u5EFA\u81EA\u5B9A\u4E49Nginx\u7684Chart "),s("a",{class:"header-anchor",href:"#\u521B\u5EFA\u81EA\u5B9A\u4E49nginx\u7684chart","aria-hidden":"true"},"#")],-1),wt=s("p",null,"1.\u521B\u5EFA\u81EA\u5B9A\u4E49Chart Nginx\u7684\u7ED3\u6784",-1),Lt=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm create helm-nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Creating helm-nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}}," [root@linux-node1 ~]# tree helm-nginx/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"opencmdb/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 charts       #\u4F9D\u8D56\u7684chart")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 Chart.yaml   #\u672Cchart\u7684\u4FE1\u606F")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u251C\u2500\u2500 templates    #\u6A21\u677F\u76EE\u5F55")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 deployment.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 _helpers.tpl")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 ingress.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u251C\u2500\u2500 NOTES.txt")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2502   \u2514\u2500\u2500 service.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2514\u2500\u2500 values.yaml   #\u6A21\u677F\u8D4B\u503C")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),jt=s("p",null,"2.\u7F16\u8F91Chart\u914D\u7F6E",-1),Ot=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd helm-nginx/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 helm-nginx]# vim values.yaml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Gt=s("p",null,"3.\u9A8C\u8BC1Chart\u914D\u7F6E\uFF0C\u6700\u540E\u9762\u7684\u70B9\u8868\u793A\u5F53\u524D\u76EE\u5F55",-1),Ut=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 helm-nginx]# helm install --dry-run --debug --name helm-nginx .")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Vt=s("p",null,"4.\u5B89\u88C5\u81EA\u5B9A\u4E49Chart\uFF0C\u6700\u540E\u9762\u7684\u70B9\u8868\u793A\u5F53\u524D\u76EE\u5F55",-1),Ht=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 helm-nginx]# helm install --name helm-nginx .")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Yt=s("h3",{id:"\u67E5\u770Bhelm\u5B9E\u4F8B",tabindex:"-1"},[n("\u67E5\u770BHelm\u5B9E\u4F8B "),s("a",{class:"header-anchor",href:"#\u67E5\u770Bhelm\u5B9E\u4F8B","aria-hidden":"true"},"#")],-1),Ft=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# helm list")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME          REVISION    UPDATED                     STATUS      CHART                 NAMESPACE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"helm-nginx    1           Sun Sep 16 19:32:19 2018    DEPLOYED    helm-nginx-0.1.0      default  ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                          READY     STATUS    RESTARTS   AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"helm-nginx-6975f8dbcd-htvtd   1/1       Running   0          51s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get ingress")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME         HOSTS                ADDRESS   PORTS     AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"helm-nginx   www.helm-nginx.com             80        1m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Bt=s("h1",{id:"_17-\u5E94\u7528\u7684\u65E5\u5FD7\u91C7\u96C6\u4E0E\u5206\u6790",tabindex:"-1"},[n("17 \u5E94\u7528\u7684\u65E5\u5FD7\u91C7\u96C6\u4E0E\u5206\u6790 "),s("a",{class:"header-anchor",href:"#_17-\u5E94\u7528\u7684\u65E5\u5FD7\u91C7\u96C6\u4E0E\u5206\u6790","aria-hidden":"true"},"#")],-1),$t=s("h2",{id:"prometheus\u5FEB\u901F\u5165\u95E8",tabindex:"-1"},[n("Prometheus\u5FEB\u901F\u5165\u95E8 "),s("a",{class:"header-anchor",href:"#prometheus\u5FEB\u901F\u5165\u95E8","aria-hidden":"true"},"#")],-1),qt=s("h3",{id:"prometheus\u67B6\u6784\u4ECB\u7ECD",tabindex:"-1"},[n("Prometheus\u67B6\u6784\u4ECB\u7ECD "),s("a",{class:"header-anchor",href:"#prometheus\u67B6\u6784\u4ECB\u7ECD","aria-hidden":"true"},"#")],-1),Jt=s("p",null,"\u5728\u5B66\u4E60Prometheus\u4E4B\u524D\u6211\u4EEC\u9700\u8981\u6E05\u6670\u7684\u638C\u63E1\u5176\u67B6\u6784\uFF0CPrometheus\u662F\u7531\u591A\u4E2A\u7EC4\u4EF6\u7EC4\u6210\u7684\u7684\u76D1\u63A7\u7CFB\u7EDF\uFF0C\u4E3B\u8981\u6709\uFF1APrometheus Server\u3001Alertmanager\u3001Pushgateway\u7EC4\u6210\uFF0C\u8FD9\u4E09\u4E2A\u7EC4\u4EF6\u5747\u4E3A\u72EC\u7ACB\u7684\u5E94\u7528\u670D\u52A1\uFF0C\u72EC\u7ACB\u90E8\u7F72\u548C\u8FD0\u884C\uFF0C\u5176\u4E2DPrometheus Server\u4E2D\u5185\u7F6E\u4E86Prometheus web UI\u3002",-1),zt=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/2ada1ece66fcc81d704c2ba46f9dd7d3.png",alt:"architecture"})],-1),Wt=s("p",null,[s("strong",null,"Prometheus Server\uFF1A")],-1),Zt=s("p",null,"Promethedus Server\u662F\u6838\u5FC3\u7EC4\u4EF6\uFF0C\u8D1F\u8D23\u6570\u636E\u7684\u83B7\u53D6\u3001\u5B58\u50A8\u3001\u67E5\u8BE2\u3002Prometheus\u901A\u8FC7Pull\u7684\u65B9\u5F0F\u5B9A\u671F\u7684\u4ECEJobs/Exporters\u4E2D\u83B7\u53D6\u6570\u636E\uFF0C\u5E76\u4FDD\u5B58\u5728\u5185\u7F6E\u7684TSDB\u4E2D\uFF1B\u5185\u7F6E\u7684Prometheus web UI\u53EF\u4EE5\u8BA9\u7528\u6237\u901A\u8FC7PromQL\u7684\u65B9\u5F0F\u8FDB\u884C\u6570\u636E\u7684\u68C0\u7D22\u3002",-1),Xt=s("p",null,[s("strong",null,"Exporters\uFF1A")],-1),Qt=s("p",null,"Exporters\u4E5F\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684\u7EC4\u4EF6\uFF0C\u6709\u5B98\u65B9\u63D0\u4F9B\u7684Exporters\u4E5F\u6709\u793E\u533A\u8D21\u732E\u7684Exportes\uFF0C\u5B83\u5C06\u76D1\u63A7\u91C7\u96C6\u7684\u6570\u636E\u901A\u8FC7HTTP\u7684\u65B9\u5F0F\u66B4\u9732\u7ED9Prometheus Server\uFF0CServer\u5B9A\u671F\u83B7\u53D6\u6570\u636E\u3002\u4F8B\u5982\u6709\u4E00\u4E2AExporters\u53EB\u505ANode Exporter\uFF0C\u5B83\u5B89\u88C5\u5728\u53D7\u91C7\u96C6\u7684\u4E3B\u673A\u4E0A\uFF0C\u4E3AServer\u63D0\u4F9B\u6570\u636E\uFF0C\u6709\u70B9\u7C7B\u4F3C\u4E8EZabbix\u76D1\u63A7\u7CFB\u7EDF\u4E2D\u7684Zabbix Agent\u3002",-1),sc=s("p",null,[s("strong",null,"Prometheus web UI\uFF1A")],-1),nc=s("p",null,"Prometheus web UI\u662FServer\u542F\u52A8\u540E\u5185\u7F6E\u7684\u4E00\u4E2AWeb\u754C\u9762\uFF0C\u901A\u8FC7\u8BE5Web\u754C\u9762\u6211\u4EEC\u53EF\u4EE5\u8FDB\u884C\u6570\u636E\u67E5\u8BE2\u5DE5\u4F5C\uFF0C\u4E0D\u5305\u542B\u8BBE\u7F6E\u7684\u76F8\u5173\u529F\u80FD\u3002",-1),lc=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/cc11e0cf02ff729fb905ac3648af18f7.png",alt:"img"})],-1),ec=s("p",null,[s("strong",null,"PromQL\uFF1A")],-1),ac=s("p",null,"PromQL\u662FPrometheus\u5185\u7F6E\u7684\u81EA\u5B9A\u4E49\u7684\u67E5\u8BE2\u8BED\u8A00\uFF0C\u63D0\u4F9B\u5BF9Prometheus Server\u4E2D\u7684TSDB\u8FD9\u4E2A\u65F6\u95F4\u5E8F\u5217\u6570\u636E\u5E93\u8FDB\u884C\u6570\u636E\u67E5\u8BE2\uFF0C\u652F\u6301\u6570\u636E\u805A\u5408\u548C\u4E00\u4E9B\u903B\u8F91\u8FD0\u7B97\uFF0C\u662F\u4E00\u4E2A\u76F8\u5BF9\u7B80\u5355\u7684\u67E5\u8BE2\u8BED\u8A00\uFF0C\u800C\u4E14PromQL\u4E5F\u63D0\u4F9B\u4E86\u4E00\u4E9B\u5185\u7F6E\u51FD\u6570\uFF0C\u5E2E\u52A9\u6211\u4EEC\u8FDB\u884C\u6570\u636E\u5904\u7406\u3002",-1),oc=s("p",null,[s("strong",null,"Alertmanager\uFF1A")],-1),tc=s("p",null,"Alertmanager\u662FPromethedus\u7684\u544A\u8B66\u7BA1\u7406\u7EC4\u4EF6\uFF0C\u5B83\u652F\u6301\u57FA\u4E8EPromQL\u6765\u521B\u5EFA\u544A\u8B66\u89C4\u5219\uFF0C\u7C7B\u4F3C\u4E8EZabbix\u4E2D\u7684\u544A\u8B66\u8868\u8FBE\u5F0F\uFF0C\u5BF9\u83B7\u53D6\u5230\u7684\u6570\u636E\u8FDB\u884C\u8BA1\u7B97\u548C\u6BD4\u8F83\uFF0C\u5982\u679C\u6EE1\u8DB3PromQL\u5B9A\u4E49\u7684\u89C4\u5219\u6761\u4EF6\uFF0C\u5C31\u4F1A\u4EA7\u751F\u62A5\u8B66\u3002",-1),cc=s("p",null,[s("strong",null,"Pushgateway\uFF1A")],-1),rc=s("p",null,"Pushgateway\u53EF\u4EE5\u7406\u89E3\u4E3A\u6570\u636E\u7684\u4E00\u4E2A\u4E2D\u8F6C\u7AD9\uFF0C\u4F8B\u5982\u5F53Prometheus Server\u4E0D\u80FD\u76F4\u63A5\u548CExporters\u8FDB\u884C\u901A\u4FE1\u7684\u573A\u666F\u4E0B\u3002",-1),ic=s("h3",{id:"\u5B89\u88C5prometheus",tabindex:"-1"},[n("\u5B89\u88C5Prometheus "),s("a",{class:"header-anchor",href:"#\u5B89\u88C5prometheus","aria-hidden":"true"},"#")],-1),pc=s("p",null,"\u5B66\u4E60Prometheus\u7684\u7B2C\u4E00\u6B65\u5C31\u662F\u5148\u90E8\u7F72\u4E00\u4E2A\u5B9E\u9A8C\u73AF\u5883\uFF0C\u5B98\u65B9\u63D0\u4F9B\u4E86\u591A\u79CD\u65B9\u5F0F\u8FDB\u884CPrometheus\u5B89\u88C5\uFF1A",-1),Ac=s("ul",null,[s("li",null,"\u6E90\u7801\u7F16\u8BD1\u5B89\u88C5"),s("li",null,"\u4E0B\u8F7D\u9884\u7F16\u8BD1\u597D\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6"),s("li",null,"\u4F7F\u7528Docker\u90E8\u7F72"),s("li",null,"\u4F7F\u7528\u7B2C\u4E09\u65B9\u5DE5\u5177\uFF1AAnsible\u3001SaltStack\u3001Puppet\u3001Chef\u3002")],-1),Cc=s("p",null,[n("\u4E3A\u4E86\u65B9\u4FBF\u5B66\u4E60\uFF0C\u9996\u5148\u6211\u4EEC\u4F7F\u7528\u4E8C\u8FDB\u5236\u65B9\u5F0F\u90E8\u7F72\uFF0C\u53EF\u4EE5\u5728\u8FD9\u91CC"),s("a",{href:"https://prometheus.io/download/%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A2%84%E7%BC%96%E8%AF%91%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E3%80%82",target:"_blank",rel:"noreferrer"},"https://prometheus.io/download/\u4E0B\u8F7D\u5BF9\u5E94\u7684\u9884\u7F16\u8BD1\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\u3002")],-1),dc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd /usr/local/src")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# wget")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"https://github.com/prometheus/prometheus/releases/download/v2.7.1/prometheus-2.7.1.linux-amd64.tar.gz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# tar zxf prometheus-2.7.1.linux-amd64.tar.gz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# mv prometheus-2.7.1.linux-amd64 /usr/local/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# ln -s /usr/local/prometheus-2.7.1.linux-amd64/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/usr/local/prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),uc=s("p",null,[s("strong",null,"Prometheus\u914D\u7F6E")],-1),yc=s("p",null,"Prometheus\u7684\u914D\u7F6E\u6587\u4EF6\u5728prometheus.yml\u4E2D\uFF0C\u76F4\u63A5\u542F\u52A8\u4E5F\u4F1A\u5230\u547D\u4EE4\u7684\u5F53\u524D\u76EE\u5F55\u4E0B\u5BFB\u627E\u8BE5\u6587\u4EF6\u3002",-1),hc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd /usr/local/prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 prometheus]# vim prometheus.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# my global config")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"global:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# scrape_timeout is set to the global default (10s).")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# Alertmanager configuration")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"alerting:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"alertmanagers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- static_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- targets:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# - alertmanager:9093")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# Load rules once and periodically evaluate them according to the global")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"'evaluation_interval'.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"rule_files:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'# - "first_rules.yml"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'# - "second_rules.yml"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# A scrape configuration containing exactly one endpoint to scrape:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# Here it's Prometheus itself.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scrape_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# The job name is added as a label `job=<job_name>` to any timeseries")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scraped from this config.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- job_name: 'prometheus'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# metrics_path defaults to '/metrics'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# scheme defaults to 'http'.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"static_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- targets: ['localhost:9090']")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Dc=s("p",null,[s("strong",null,"\u542F\u52A8Prometheus")],-1),gc=s("p",null,'\u9ED8\u8BA4\u60C5\u51B5\u4E0BPrometheus\u4F1A\u628A\u6570\u636E\u5199\u5728\u542F\u52A8\u76EE\u5F55\u7684./data\u76EE\u5F55\u4E0B\uFF0C\u53EF\u4EE5\u901A\u8FC7\u542F\u52A8\u53C2\u6570\u6307\u5B9A\u76EE\u5F55\uFF1A--storage.tsdb.path="data/"\uFF0C\u66F4\u591A\u53C2\u6570\u53EF\u4EE5\u901A\u8FC7\u2014help\u67E5\u770B',-1),mc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 prometheus]# ./prometheus \u2013help")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 prometheus]# ./prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"\u2026")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'level=info ts=2019-02-12T08:04:03.799169159Z caller=main.go:620 msg="Starting')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'TSDB ..."')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'level=info ts=2019-02-12T08:04:03.835497463Z caller=main.go:635 msg="TSDB')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'started"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'level=info ts=2019-02-12T08:04:03.835598421Z caller=main.go:695 msg="Loading')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'configuration file" filename=prometheus.yml')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'level=info ts=2019-02-12T08:04:03.83756508Z caller=main.go:722 msg="Completed')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'loading of configuration file" filename=prometheus.yml')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'level=info ts=2019-02-12T08:04:03.83760078Z caller=main.go:589 msg="Server is')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'ready to receive web requests."')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"level=info ts=2019-02-12T08:04:03.837641772Z caller=web.go:416 component=web")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'msg="Start listening for connections" address=0.0.0.0:9090')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),_c=s("p",null,"\u9ED8\u8BA4\u4F1A\u5728\u524D\u53F0\u542F\u52A8\uFF0C\u5E76\u76D1\u542C9090\u7AEF\u53E3\uFF0C\u4F1A\u81EA\u52A8\u521B\u5EFAdata\u76EE\u5F55\uFF0C\u5E76\u5B58\u653E\u6570\u636E\u3002\u6CE8\u610F\u5982\u4F55\u670D\u52A1\u5668\u65F6\u95F4\u4E0D\u6B63\u786E\u4F1A\u6709\u8B66\u544A\u63D0\u793A\uFF0C\u8BF7\u4FDD\u8BC1\u670D\u52A1\u5668\u65F6\u95F4\u540C\u6B65\u3002",-1),bc=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/266a101825cbabc2782820895e161f59.png",alt:"img"})],-1),kc=s("p",null,[s("strong",null,"\u653E\u7F6E\u5728\u540E\u53F0\u8FD0\u884C")],-1),vc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# groupadd prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# useradd -g prometheus -d /var/lib/prometheus -s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/sbin/nologin prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /usr/lib/systemd/system/prometheus.service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Unit]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Description=prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"After=network.target")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Service]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Type=simple")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"User=prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ExecStart=/usr/local/prometheus/prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--config.file=/usr/local/prometheus/prometheus.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"--storage.tsdb.path=/var/lib/prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Restart=on-failure")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Install]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"WantedBy=multi-user.target")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),fc=s("p",null,"\u540E\u53F0\u542F\u52A8",-1),xc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl start prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Pc=s("p",null,"\u67E5\u770B\u542F\u52A8\u72B6\u6001",-1),Sc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# netstat -ntlp | grep 9090")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"tcp6 0 0 :::9090 :::* LISTEN 61333/prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Ec=s("h3",{id:"\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E",tabindex:"-1"},[n("\u4F7F\u7528Node Exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528node-exporter\u91C7\u96C6\u4E3B\u673A\u6570\u636E","aria-hidden":"true"},"#")],-1),Nc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# cd /usr/local/src")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# wget")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"<https://github.com/prometheus/node_exporter/releases/download/v0.17.0/node_exporter-0.17.0.linux-amd64.tar.gz>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# tar zxf node_exporter-0.17.0.linux-amd64.tar.gz")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# mv node_exporter-0.17.0.linux-amd64 /usr/local/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 src]# ln -s /usr/local/node_exporter-0.17.0.linux-amd64/")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/usr/local/node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /usr/lib/systemd/system/node_exporter.service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Unit]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Description=node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"After=network.target")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Service]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Type=simple")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"User=prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"ExecStart=/usr/local/prometheus/node_exporter/node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Restart=on-failure")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[Install]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"WantedBy=multi-user.target")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Rc=s("p",null,"\u542F\u52A8Node Exporter",-1),Tc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl start node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Kc=s("p",null,"\u67E5\u770B\u72B6\u6001 [root@linux-node1 ~]# netstat -ntlp | grep 9100",-1),Ic=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"tcp6 0 0 :::9100 :::* LISTEN 66239/node_exporter")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Mc=s("p",null,"\u9ED8\u8BA4\u60C5\u51B5\u4E0BNode Exporter\u76D1\u542C9100\u7AEF\u53E3\uFF0C\u901A\u8FC7/metrics\u66B4\u9732\u91C7\u96C6\u5230\u7684\u76D1\u63A7\u6570\u636E\uFF0CPrometheus\u9ED8\u8BA4\u4E5F\u4ECE\u8BE5\u5730\u5740\u83B7\u53D6\u6570\u636E\u3002",-1),wc=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/1004a69a33423c72a2989005be5a790e.png",alt:"img"})],-1),Lc=s("p",null,[s("strong",null,"\u914D\u7F6EPrometheus\u8BFB\u53D6Node Exporter\u6570\u636E")],-1),jc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /usr/local/prometheus/prometheus.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scrape_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# The job name is added as a label `job=<job_name>` to any timeseries")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"scraped from this config.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- job_name: 'prometheus'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# metrics_path defaults to '/metrics'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"# scheme defaults to 'http'.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"static_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- targets: ['localhost:9090']")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- job_name: 'linux-node1'")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"static_configs:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- targets: ['192.168.56.11:9100']")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"instance: linux-node1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Oc=s("p",null,[s("strong",null,"\u91CD\u542Fprometheus")],-1),Gc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl restart prometheus")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Uc=s("p",null,[s("strong",null,"\u67E5\u770B\u76D1\u63A7\u72B6\u6001")],-1),Vc=s("p",null,"\u767B\u5F55Prometheus\u7684Web\u63A7\u5236\u53F0\uFF0CStatusTargets\u5982\u679C\u53EF\u4EE5linux-node1\u5E76\u4E14\u72B6\u6001\u662FUP\u7684\u72B6\u6001\u5373\u4E3A\u914D\u7F6E\u6210\u529F\u3002",-1),Hc=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/8c3da60dbf5558dc649de1fd6ce43bf0.png",alt:"img"})],-1),Yc=s("h3",{id:"\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E",tabindex:"-1"},[n("\u4F7F\u7528Prometheus UI\u67E5\u770B\u6570\u636E "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528prometheus-ui\u67E5\u770B\u6570\u636E","aria-hidden":"true"},"#")],-1),Fc=s("p",null,[n("\u73B0\u5728Prometheus\u4F1A\u5B9A\u671F\u7684\u4ECE"),s("a",{href:"http://192.168.56.11:9100/metrics%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%B9%B6%E5%AD%98%E5%82%A8%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8Prometheus",target:"_blank",rel:"noreferrer"},"http://192.168.56.11:9100/metrics\u83B7\u53D6\u6570\u636E\uFF0C\u5E76\u5B58\u50A8\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4F7F\u7528Prometheus"),n(" UI\u6765\u67E5\u770B\u76D1\u63A7\u6570\u636E\u3002")],-1),Bc=s("h3",{id:"\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316",tabindex:"-1"},[n("\u4F7F\u7528Grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316 "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528grafana\u8FDB\u884C\u6570\u636E\u53EF\u89C6\u5316","aria-hidden":"true"},"#")],-1),$c=s("p",null,[s("strong",null,"1.\u5B89\u88C5Grafana")],-1),qc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/yum.repos.d/grafana.repo")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[grafana]")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"name=grafana")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"baseurl=https://packages.grafana.com/oss/rpm")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"repo_gpgcheck=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"enabled=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gpgcheck=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"gpgkey=https://packages.grafana.com/gpg.key")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sslverify=1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"sslcacert=/etc/pki/tls/certs/ca-bundle.crt")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# yum install -y grafana")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Jc=s("p",null,[s("strong",null,"2.\u914D\u7F6EGrafana")],-1),zc=s("p",null,"Grafana\u7684\u914D\u7F6E\u6587\u4EF6\u5728/etc/grafana/grafana.ini\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0BGrafana\u76D1\u542C3000\u7AEF\u53E3",-1),Wc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim /etc/grafana/grafana.ini")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Zc=s("p",null,[s("strong",null,"3.\u542F\u52A8Grafana")],-1),Xc=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl enable grafana-server")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# systemctl start grafana-server")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# netstat -ntlp | grep 3000")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"tcp6 0 0 :::3000 :::* LISTEN 81427/grafana-serve")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Qc=s("p",null,[s("strong",null,"4.\u8BBF\u95EEGrafana")],-1),sr=s("p",null,[n("\u8BBF\u95EE"),s("a",{href:"http://192.168.56.11:3000/",target:"_blank",rel:"noreferrer"},"http://192.168.56.11:3000"),n("\uFF0C\u7528\u6237\u540D\u548C\u5BC6\u7801\u9ED8\u8BA4\u4E3Aadmin/admin\uFF0C\u7B2C\u4E00\u6B21\u767B\u9646\u4F1A\u8981\u6C42\u4FEE\u6539\u5BC6\u7801\uFF0C\u8BF7\u4F7F\u7528\u5B89\u5168\u5BC6\u7801\u3002")],-1),nr=s("p",null,[s("strong",null,"5.\u589E\u52A0Prometheus\u6570\u636E\u6E90")],-1),lr=s("p",null,"\u70B9\u51FB",-1),er=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/b681a9b528d2ff21ba66666ce2452e51.png",alt:"img"})],-1),ar=s("p",null,"\uFF0C\u7136\u540E\u9009\u62E9",-1),or=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/d3e83ac4f090a51c5b5e0c341b99dda5.png",alt:"img"})],-1),tr=s("p",null,"\u3002",-1),cr=s("p",null,[n("\u914D\u7F6EURL\u4E3A\uFF1A"),s("a",{href:"http://192.168.56.11:9090/",target:"_blank",rel:"noreferrer"},"http://192.168.56.11:9090"),n("\uFF0C\u5E76\u70B9\u51FBSave&Test\u3002")],-1),rr=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/e35d8aaebedd7e168ebd1b29b65b30bb.png",alt:"img"})],-1),ir=s("p",null,[s("strong",null,"6.\u8BBE\u7F6EDashboard")],-1),pr=s("p",null,"\u6570\u636E\u6E90\u8BBE\u7F6E\u5B8C\u6BD5\u540E\uFF0C\u5C31\u53EF\u4EE5\u8BBE\u7F6EDashboard\u56FE\u5F62\u5C55\u793A\uFF0C\u53EF\u4EE5\u624B\u52A8\u6DFB\u52A0\uFF0C\u4E5F\u53EF\u4EE5\u76F4\u63A5\u4E0B\u8F7D\u522B\u4EBA\u914D\u7F6E\u597D\u4FDD\u6301\u7684Json\u6587\u4EF6\u76F4\u63A5\u5BFC\u5165\u5373\u53EF\u3002",-1),Ar=s("p",null,[n("\u4E0B\u8F7D\u5730\u5740\uFF1A"),s("a",{href:"https://grafana.com/dashboards/405%EF%BC%8C%E5%9C%A8%E5%8F%B3%E4%BE%A7%E6%9C%89Download",target:"_blank",rel:"noreferrer"},"https://grafana.com/dashboards/405\uFF0C\u5728\u53F3\u4FA7\u6709Download"),n(" Json\u6309\u94AE\uFF0C\u4E0B\u8F7D\u8BE5Json\u6587\u4EF6\u3002")],-1),Cr=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/d9ab69b29a964a12df52512a7b128b5b.png",alt:"img"})],-1),dr=s("p",null,"\u70B9\u51FBHome\u4E0B\u7684Import Dashboard",-1),ur=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/53ffc0e739ca7b9421f9568ae4cbf117.png",alt:"img"})],-1),yr=s("p",null,"\u7136\u540E\u76F4\u63A5\u4E0A\u4F20\u521A\u624D\u4E0B\u8F7D\u7684JSON\u6587\u4EF6\u3002",-1),hr=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/500958891a82067b0c987d514239ffb0.png",alt:"img"})],-1),Dr=s("p",null,"\u5BFC\u5165\u5B8C\u6BD5\u540E\uFF0C\u5C31\u53EF\u4EE5\u5728Grafana\u4E0A\u67E5\u770B\u5BF9\u5E94\u8282\u70B9\u7684\u76D1\u63A7\u6570\u636E\u56FE\u8868\u3002\u4F60\u53EF\u4EE5\u901A\u8FC7\u9F20\u6807\u62D6\u62FD\u8FDB\u884C\u56FE\u8868\u7684\u81EA\u5B9A\u4E49\u5927\u5C0F\u548C\u4F4D\u7F6E\u7684\u4FEE\u6539\uFF0C\u6548\u679C\u5982\u4E0B\uFF1A",-1),gr=s("p",null,[s("img",{src:"http://k8s.unixhot.com/kubernetes/media/698a6241faa0adc1af6c09cc369b259b.png",alt:"img"})],-1),mr=s("h1",{id:"\u7B2C\u4E03\u90E8\u5206-kubernetes\u9AD8\u7EA7\u8FDB\u9636",tabindex:"-1"},[n("\u7B2C\u4E03\u90E8\u5206 Kubernetes\u9AD8\u7EA7\u8FDB\u9636 "),s("a",{class:"header-anchor",href:"#\u7B2C\u4E03\u90E8\u5206-kubernetes\u9AD8\u7EA7\u8FDB\u9636","aria-hidden":"true"},"#")],-1),_r=s("h1",{id:"kubernetes\u7684\u6743\u9650\u63A7\u5236rbac",tabindex:"-1"},[n("Kubernetes\u7684\u6743\u9650\u63A7\u5236RBAC "),s("a",{class:"header-anchor",href:"#kubernetes\u7684\u6743\u9650\u63A7\u5236rbac","aria-hidden":"true"},"#")],-1),br=s("p",null,[s("strong",null,"\u89D2\u8272")],-1),kr=s("ul",null,[s("li",null,[s("p",null,"Role: \u89D2\u8272\uFF0C\u547D\u540D\u7A7A\u95F4\u8303\u56F4\u5185\u7684\u4E00\u4E2A\u6743\u9650\u96C6\u5408\u3002")]),s("li",null,[s("p",null,"ClusterRole\uFF1A\u96C6\u7FA4\u89D2\u8272\uFF0C\u96C6\u7FA4\u8303\u56F4\u5185\u7684\u4E00\u4E2A\u6743\u9650\u7684\u96C6\u5408\uFF0C"),s("p",null,"Role\u548CClusterROle\u5728Kubernetes\u4E2D\u90FD\u88AB\u5B9A\u4E49\u4E3A\u96C6\u7FA4\u5185\u90E8\u7684 API \u8D44\u6E90\uFF0C\u548C\u6211\u4EEC\u524D\u9762\u5B66\u4E60\u8FC7\u7684 Pod\u3001ConfigMap \u8FD9\u4E9B\u7C7B\u4F3C\uFF0C\u90FD\u662F\u6211\u4EEC\u96C6\u7FA4\u7684\u8D44\u6E90\u5BF9\u8C61\uFF0C\u6240\u4EE5\u540C\u6837\u7684\u53EF\u4EE5\u4F7F\u7528\u6211\u4EEC\u524D\u9762\u7684kubectl\u76F8\u5173\u7684\u547D\u4EE4\u6765\u8FDB\u884C\u64CD\u4F5C Subject\uFF1A\u4E3B\u9898\uFF0C\u5BF9\u5E94\u5728\u96C6\u7FA4\u4E2D\u5C1D\u8BD5\u64CD\u4F5C\u7684\u5BF9\u8C61\uFF0C\u96C6\u7FA4\u4E2D\u5B9A\u4E49\u4E863\u79CD\u7C7B\u578B\u7684\u4E3B\u9898\u8D44\u6E90\uFF1A")])],-1),vr=s("p",null,"User Account\uFF1A\u7528\u6237\uFF0C\u8FD9\u662F\u6709\u5916\u90E8\u72EC\u7ACB\u670D\u52A1\u8FDB\u884C\u7BA1\u7406\u7684\uFF0C\u7BA1\u7406\u5458\u8FDB\u884C\u79C1\u94A5\u7684\u5206\u914D\uFF0C\u7528\u6237\u53EF\u4EE5\u4F7F\u7528 KeyStone\u6216\u8005 Goolge \u5E10\u53F7\uFF0C\u751A\u81F3\u4E00\u4E2A\u7528\u6237\u540D\u548C\u5BC6\u7801\u7684\u6587\u4EF6\u5217\u8868\u4E5F\u53EF\u4EE5\u3002\u5BF9\u4E8E\u7528\u6237\u7684\u7BA1\u7406\u96C6\u7FA4\u5185\u90E8\u6CA1\u6709\u4E00\u4E2A\u5173\u8054\u7684\u8D44\u6E90\u5BF9\u8C61\uFF0C\u6240\u4EE5\u7528\u6237\u4E0D\u80FD\u901A\u8FC7\u96C6\u7FA4\u5185\u90E8\u7684 API \u6765\u8FDB\u884C\u7BA1\u7406 Group\uFF1A\u7EC4\uFF0C\u8FD9\u662F\u7528\u6765\u5173\u8054\u591A\u4E2A\u8D26\u6237\u7684\uFF0C\u96C6\u7FA4\u4E2D\u6709\u4E00\u4E9B\u9ED8\u8BA4\u521B\u5EFA\u7684\u7EC4\uFF0C\u6BD4\u5982cluster-admin Service Account\uFF1A\u670D\u52A1\u5E10\u53F7\uFF0C\u901A\u8FC7Kubernetes API \u6765\u7BA1\u7406\u7684\u4E00\u4E9B\u7528\u6237\u5E10\u53F7\uFF0C\u548C namespace \u8FDB\u884C\u5173\u8054\u7684\uFF0C\u9002\u7528\u4E8E\u96C6\u7FA4\u5185\u90E8\u8FD0\u884C\u7684\u5E94\u7528\u7A0B\u5E8F\uFF0C\u9700\u8981\u901A\u8FC7 API \u6765\u5B8C\u6210\u6743\u9650\u8BA4\u8BC1\uFF0C\u6240\u4EE5\u5728\u96C6\u7FA4\u5185\u90E8\u8FDB\u884C\u6743\u9650\u64CD\u4F5C\uFF0C\u6211\u4EEC\u90FD\u9700\u8981\u4F7F\u7528\u5230 ServiceAccount\uFF0C\u8FD9\u4E5F\u662F\u6211\u4EEC\u8FD9\u8282\u8BFE\u7684\u91CD\u70B9 RoleBinding \u548C ClusterRoleBinding\uFF1A\u89D2\u8272\u7ED1\u5B9A\u548C\u96C6\u7FA4\u89D2\u8272\u7ED1\u5B9A\uFF0C\u7B80\u5355\u6765\u8BF4\u5C31\u662F\u628A\u58F0\u660E\u7684 Subject \u548C\u6211\u4EEC\u7684 Role \u8FDB\u884C\u7ED1\u5B9A\u7684\u8FC7\u7A0B(\u7ED9\u67D0\u4E2A\u7528\u6237\u7ED1\u5B9A\u4E0A\u64CD\u4F5C\u7684\u6743\u9650)\uFF0C\u4E8C\u8005\u7684\u533A\u522B\u4E5F\u662F\u4F5C\u7528\u8303\u56F4\u7684\u533A\u522B\uFF1ARoleBinding \u53EA\u4F1A\u5F71\u54CD\u5230\u5F53\u524D namespace \u4E0B\u9762\u7684\u8D44\u6E90\u64CD\u4F5C\u6743\u9650\uFF0C\u800C ClusterRoleBinding \u4F1A\u5F71\u54CD\u5230\u6240\u6709\u7684 namespace\u3002",-1),fr=s("p",null,[s("strong",null,"\u521B\u5EFA\u7528\u6237\u51ED\u8BC1")],-1),xr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# openssl genrsa -out jenkins.key 2048")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'[root@linux-node1 ~]# openssl req -new -key jenkins.key -out jenkins.csr -subj "/CN=jenkins/O=vmware"')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# openssl x509 -req -in jenkins.csr -CA /etc/kubernetes/pki/ca.crt -CAkey /etc/kubernetes/pki/ca.key -CAcreateserial -out jenkins.crt -days 365")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl config set-credentials jenkins --client-certificate=jenkins.crt  --client-key=jenkins.key")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl config set-context jenkins-context --cluster=kubernetes --namespace=jenkins --user=jenkins  ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pods --context=jenkins-context")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Pr=s("p",null,[s("strong",null,"\u521B\u5EFA\u89D2\u8272")],-1),Sr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim jenkins-role.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: rbac.authorization.k8s.io/v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Role")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: jenkins-role")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"rules:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'- apiGroups: ["", "extensions", "apps"]')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  resources: ["deployments", "replicasets", "pods"]')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Er=s("p",null,[s("strong",null,"\u521B\u5EFA\u89D2\u8272\u7ED1\u5B9A")],-1),Nr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# vim jenkins-role-binding.yml")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: rbac.authorization.k8s.io/v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: RoleBinding")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: jenkins-rolebinding")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"subjects:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"- kind: User")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: jenkins")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  apiGroup: ""')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"roleRef:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  kind: Role")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: jenkins-role")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  apiGroup: ""')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Rr=s("h1",{id:"_22-\u6DF1\u5165\u7406\u89E3pod\u8C03\u5EA6",tabindex:"-1"},[n("22 \u6DF1\u5165\u7406\u89E3Pod\u8C03\u5EA6 "),s("a",{class:"header-anchor",href:"#_22-\u6DF1\u5165\u7406\u89E3pod\u8C03\u5EA6","aria-hidden":"true"},"#")],-1),Tr=s("h1",{id:"\u6DF1\u5165\u7406\u89E3pod\u8C03\u5EA6",tabindex:"-1"},[n("\u6DF1\u5165\u7406\u89E3Pod\u8C03\u5EA6 "),s("a",{class:"header-anchor",href:"#\u6DF1\u5165\u7406\u89E3pod\u8C03\u5EA6","aria-hidden":"true"},"#")],-1),Kr=s("p",null,"\u5728\u524D\u9762\u7684\u7AE0\u8282\u6211\u4EEC\u5DF2\u7ECF\u77E5\u9053\u5728Kubernetes\u4E2D\u4F7F\u7528kube-scheduler\u8FDB\u884CPod\u8C03\u5EA6\uFF0C\u5B83\u7684\u76EE\u6807\u662F\u5C06Pod\u7ED1\u5B9A\u5230\u5BF9\u5E94\u7684Node\u4E0A\uFF0C\u7ECF\u8FC7\u4E00\u7CFB\u5217\u7684\u6761\u4EF6\u548C\u7B97\u6CD5\u5C3D\u53EF\u80FD\u7684\u8BA9\u6BCF\u4E2APod\u90FD\u6EE1\u610F\u3002kube-scheduler\u662FKubernetes\u9ED8\u8BA4\u7684\u8C03\u5EA6\u5668\u3002",-1),Ir=s("p",null,[n("kube-scheduler\u7684\u4EE3\u7801\u4F4D\u4E8E"),s("a",{href:"https://github.com/kubernetes/kubernetes/tree/master/pkg/scheduler",target:"_blank",rel:"noreferrer"},"GitHub")],-1),Mr=s("p",null,"\u53EF\u4EE5\u5C06\u4EE3\u7801\u514B\u9686\u5230\u672C\u5730\u65B9\u4FBF\u67E5\u770B",-1),wr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# git clone --depth 1 https://github.com/kubernetes/kubernetes.git")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Lr=s("p",null,"\u5728algorithm\u4E0B\u6709\u8C03\u5EA6\u7B97\u6CD5\uFF0C\u8C03\u5EA6\u7B97\u6CD5\u5206\u4E3A\u4E24\u4E2A\u9636\u6BB5\uFF1APredicates\u548Cpriorities\uFF0C\u9996\u5148\u5BF9Node\u8FDB\u884C\u8FC7\u6EE4\u770B\u54EA\u4E9BNode\u7B26\u5408\u8C03\u5EA6\u8981\u6C42\uFF0C\u7136\u540E\u5728\u7B26\u5408\u8C03\u5EA6\u8981\u6C42\u7684Node\u4E0A\u8FDB\u884C\u4F18\u5148\u7EA7\u8BA1\u7B97\uFF0C\u5224\u65AD\u8C03\u5EA6\u5230\u54EA\u4E2ANode\u6700\u5408\u9002\u3002",-1),jr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 algorithm]# pwd")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"/root/kubernetes/pkg/scheduler/algorithm")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 algorithm]# ls -l")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"total 20")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r-- 1 root root 1256 Dec 17 22:52 BUILD")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r-- 1 root root  735 Dec 17 22:52 doc.go")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"drwxr-xr-x 2 root root  276 Dec 17 22:52 predicates")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"drwxr-xr-x 3 root root 4096 Dec 17 22:52 priorities")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r-- 1 root root 3278 Dec 17 22:52 scheduler_interface.go")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"-rw-r--r-- 1 root root 3383 Dec 17 22:52 types.go")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Or=s("p",null,[n("\u5B98\u65B9\u6587\u6863\u8BE6\u7EC6\u7684\u4ECB\u7ECD\u4E86\u6240\u6709\u7684\u6B65\u9AA4\uFF1A"),s("a",{href:"https://kubernetes.io/docs/concepts/scheduling/kube-scheduler/",target:"_blank",rel:"noreferrer"},"https://kubernetes.io/docs/concepts/scheduling/kube-scheduler/")],-1),Gr=s("p",null,[s("strong",null,"\u8BBE\u7F6E\u8C03\u5EA6\u5668")],-1),Ur=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get pod kube-proxy-5wbtf -n kube-system -o yaml | grep schedulerName")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  schedulerName: default-scheduler")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Vr=s("h2",{id:"taints\uFF08\u6C61\u70B9\uFF09",tabindex:"-1"},[n("Taints\uFF08\u6C61\u70B9\uFF09 "),s("a",{class:"header-anchor",href:"#taints\uFF08\u6C61\u70B9\uFF09","aria-hidden":"true"},"#")],-1),Hr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl describe node linux-node1.unixhot.com | grep Taints")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Taints:             node-role.kubernetes.io/master:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Yr=s("p",null,"Taints\u7684\u8868\u73B0\u5F62\u5F0F\u4E3A",-1),Fr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"<key>=<value>:<effect>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Br=s("p",null,"effect\u7684\u4E09\u79CD\u7C7B\u578B\uFF1A",-1),$r=s("ul",null,[s("li",null,"NoSchedule: \u5982\u679CPod\u6CA1\u6709\u5BB9\u5FCD\u8BE5\u6C61\u70B9\uFF0C\u4E0D\u8C03\u5EA6\u5230\u8BE5\u8282\u70B9\u4E0A\u3002"),s("li",null,"PreferNoSchedule\uFF1A\u5C3D\u91CF\u963B\u6B62Pod\u88AB\u8C03\u5EA6\u5230\u8FD9\u4E2A\u8282\u70B9\u4E0A\uFF0C\u4F46\u662F\u5982\u679C\u6CA1\u6709\u5176\u5B83\u8282\u70B9\u80FD\u591F\u8C03\u5EA6\uFF0C\u53EF\u4EE5\u8C03\u5EA6\u5230\u8BE5\u8282\u70B9\u3002"),s("li",null,"NoExecute\uFF1A NoScheduler\u548CPreferNoSchedule\u53EA\u662F\u5728\u8C03\u5EA6\u9636\u6BB5\u8D77\u4F5C\u7528\uFF0C\u4F46\u662FNoExecute\u4F1A\u5F71\u54CD\u6B63\u5E38\u8FD0\u884C\u7684Pod\uFF0C\u5982\u679C\u4E00\u4E2A\u8282\u70B9\u88AB\u6253\u4E86NoExecute\u7684\u6C61\u70B9\uFF0C\u800C\u8FD0\u884C\u5728\u8BE5\u8282\u70B9\u7684Pod\u6CA1\u6709\u5BB9\u5FCD\u4F1A\u76F4\u63A5\u88AB\u8FD9\u4E2A\u8282\u70B9\u79FB\u9664\u3002")],-1),qr=s("p",null,"\u67E5\u770BFlannel\u4E3A\u4F55\u80FD\u8C03\u5EA6\u5230Master\u8282\u70B9",-1),Jr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl get po -n kube-system | grep flannel")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-flannel-ds-amd64-f2jrk                       1/1     Running   2          22h")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-flannel-ds-amd64-mh75v                       1/1     Running   2          22h")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-flannel-ds-amd64-n52zm                       1/1     Running   4          22h")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl describe pod kube-flannel-ds-amd64-f2jrk -n kube-system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"...")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Tolerations:     :NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/disk-pressure:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/memory-pressure:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/network-unavailable:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/not-ready:NoExecute")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/pid-pressure:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/unreachable:NoExecute")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"                 node.kubernetes.io/unschedulable:NoSchedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),zr=s("h3",{id:"\u81EA\u5B9A\u4E49\u6C61\u70B9",tabindex:"-1"},[n("\u81EA\u5B9A\u4E49\u6C61\u70B9 "),s("a",{class:"header-anchor",href:"#\u81EA\u5B9A\u4E49\u6C61\u70B9","aria-hidden":"true"},"#")],-1),Wr=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 ~]# kubectl taint node linux-node2.example.com node-ytpe=gpu:NoSchedule       ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"node/linux-node2.example.com tainted")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 example]# cat nginx-deployment-taint.yaml    ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: apps/v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: nginx-deployment")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  replicas: 3")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  selector:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    matchLabels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  template:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        app: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - name: nginx")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        image: nginx:1.13.12")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        ports:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        - containerPort: 80")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      tolerations:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      - key: node-type")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        operator: Equal")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        value: gpu")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"        effect: Noschedule")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@linux-node1 example]# kubectl get po -o wide")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME                                READY   STATUS    RESTARTS   AGE     IP          NODE                      NOMINATED NODE   READINESS GATES")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"dns-test                            1/1     Running   1          6h15m   10.2.2.23   linux-node3.example.com   <none>           <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-deployment-77564d4546-2jkw9   1/1     Running   0          13s     10.2.2.26   linux-node3.example.com   <none>           <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-deployment-77564d4546-4hrbf   1/1     Running   0          13s     10.2.2.24   linux-node3.example.com   <none>           <none>")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"nginx-deployment-77564d4546-s2r4h   1/1     Running   0          13s     10.2.2.25   linux-node3.example")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Zr=s("h2",{id:"\u4EB2\u7F18\u6027\u8C03\u5EA6",tabindex:"-1"},[n("\u4EB2\u7F18\u6027\u8C03\u5EA6 "),s("a",{class:"header-anchor",href:"#\u4EB2\u7F18\u6027\u8C03\u5EA6","aria-hidden":"true"},"#")],-1),Xr=s("h1",{id:"_23-kubernetes-api\u4ECB\u7ECD",tabindex:"-1"},[n("23 Kubernetes API\u4ECB\u7ECD "),s("a",{class:"header-anchor",href:"#_23-kubernetes-api\u4ECB\u7ECD","aria-hidden":"true"},"#")],-1),Qr=s("p",null,"\u67E5\u770B\u96C6\u7FA4\u72B6\u6001",-1),si=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl cluster-info")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Kubernetes master is running at https://192.168.56.11:6443")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"KubeDNS is running at https://192.168.56.11:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ni=s("p",null,"\u76F4\u63A5\u8BBF\u95EEKubernetes API\u9700\u8981\u9A8C\u8BC1\uFF0C\u65E0\u6CD5\u76F4\u63A5\u8BBF\u95EE\u3002",-1),li=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# curl -k https://192.168.56.11:6443")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "kind": "Status",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "apiVersion": "v1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "metadata": {')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  },")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "status": "Failure",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "message": "forbidden: User \\"system:anonymous\\" cannot get path \\"/\\"",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "reason": "Forbidden",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "details": {')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  },")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "code": 403')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"}")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ei=s("p",null,[s("strong",null,"\u901A\u8FC7Proxy\u8BBF\u95EEKubernetes API")],-1),ai=s("p",null,"\u4F7F\u7528kubectl proxy\u53EF\u4EE5\u5728Master\u672C\u5730\u542F\u52A8\u4E00\u4E2A\u4EE3\u7406",-1),oi=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl proxy")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Starting to serve on 127.0.0.1:8001")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ti=s("p",null,"\u53EF\u4EE5\u901A\u8FC7127.0.0.1:8001\u4E0EAPI Server\u8FDB\u884C\u4EA4\u4E92",-1),ci=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# curl http://127.0.0.1:8001")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"{")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'  "paths": [')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/api",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/api/v1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/admissionregistration.k8s.io",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/admissionregistration.k8s.io/v1beta1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apiextensions.k8s.io",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apiextensions.k8s.io/v1beta1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apiregistration.k8s.io",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apiregistration.k8s.io/v1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apiregistration.k8s.io/v1beta1",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},'    "/apis/apps",')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"...\uFF08\u7701\u7565\u5176\u5B83\u8F93\u51FA\uFF09")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),ri=s("p",null,"\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539\u76D1\u542C\u5730\u5740\uFF0C\u5E76\u5173\u95ED\u8FC7\u6EE4\uFF0C\u5B9E\u73B0\u5728\u5176\u5B83\u5730\u65B9\u767B\u5F55\u548C\u67E5\u770B\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u5728\u672C\u5730\u6D4F\u89C8\u5668\u8BBF\u95EEAPI\u3002\u5207\u8BB0\u4E0D\u8981\u518D\u751F\u4EA7\u73AF\u5883\u5C06\u4EE3\u7406\u5730\u5740\u66B4\u9732\u5728\u5916\u7F51\u3002",-1),ii=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl proxy --address=0.0.0.0 --disable-filter=true")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"W1105 16:18:45.669591   16730 proxy.go:142] Request filter disabled, your proxy is vulnerable to XSRF attacks, please be cautious")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"Starting to serve on [::]:8001")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),pi=s("h3",{id:"\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92",tabindex:"-1"},[n("\u4F7F\u7528Swagger UI\u8FDB\u884CAPI\u4EA4\u4E92 "),s("a",{class:"header-anchor",href:"#\u4F7F\u7528swagger-ui\u8FDB\u884Capi\u4EA4\u4E92","aria-hidden":"true"},"#")],-1),Ai=s("p",null,"Kubernetes\u652F\u6301Swagger UI\u8BBF\u95EEAPI\uFF0C\u9700\u8981\u5728API Server\u5F00\u542F\uFF0C\u5982\u679C\u5DF2\u7ECF\u6839\u636E\u672C\u4E66\u4F7F\u7528kubeadm\u90E8\u7F72\u7684\u96C6\u7FA4\uFF0C\u53EF\u4EE5\u901A\u8FC7\u4FEE\u6539Pod\u7684YAML\u6587\u4EF6\uFF0C\u91CD\u5EFAPod\u6765\u5F00\u542F",-1),Ci=s("p",null,[s("strong",null,"\u4FEE\u6539API Server\u7684Pod\u5B9A\u4E49\u6587\u4EF6")],-1),di=s("p",null,"\u5728- kube-apiserver\u4E0B\u9762\u4E00\u884C\u589E\u52A0--enable-swagger-ui=true",-1),ui=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# vim /etc/kubernetes/manifests/kube-apiserver.yaml ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"apiVersion: v1")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kind: Pod")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"metadata:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  creationTimestamp: null")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  labels:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    component: kube-apiserver")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    tier: control-plane")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  name: kube-apiserver")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  namespace: kube-system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"spec:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  containers:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"  - command:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - kube-apiserver")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --enable-swagger-ui=true")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --advertise-address=192.168.56.11")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    - --allow-privileged=true")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),yi=s("p",null,"\u5220\u9664Pod\uFF0Ckubelet\u4F1A\u901A\u8FC7\u8BE5YAML\u91CD\u5EFAPod",-1),hi=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get pod -n kube-system | grep api")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kube-apiserver-linux-node1.unixhot.com            1/1     Running   0          55m")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl delete pod kube-apiserver-linux-node1.unixhot.com -n kube-system")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),Di=s("p",null,"\u53EF\u4EE5\u770B\u5230\u914D\u7F6E\u5DF2\u7ECF\u751F\u6548",-1),gi=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl describe pod kube-apiserver-linux-node1.unixhot.com -n kube-system ")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"...")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"    Command:")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      kube-apiserver")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      --enable-swagger-ui=true")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"      --advertise-address=192.168.99.27")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"....")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),mi=s("p",null,"\u90E8\u7F72\u4E00\u4E2ASwagger UI\u670D\u52A1\u67E5\u770BAPI",-1),_i=s("div",{class:"language-"},[s("span",{class:"copy"}),s("pre",null,[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl run swagger-ui --image=swaggerapi/swagger-ui:latest")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl expose deployment swagger-ui --port=8080 --type=NodePort")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"[root@k8s-master1 ~]# kubectl get service")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"NAME         TYPE        CLUSTER-IP    EXTERNAL-IP     PORT(S)          AGE")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"kubernetes   ClusterIP   10.1.0.1      <none>          443/TCP          43d")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}},"swagger-ui   NodePort    10.1.205.94   <none>   8080:30410/TCP   34s")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#A6ACCD"}})])])])],-1),bi=s("p",null,"\u56E0\u4E3A\u6211\u4EEC\u90E8\u7F72\u7684Swagger UI\u548CAPI Server\u4E0D\u5728\u4E00\u4E2A\u57DF\u540D\u4E0B\uFF0C\u6240\u4EE5\u4F1A\u6709\u8DE8\u57DF\u7684\u95EE\u9898\uFF0CChrome\u6D4F\u89C8\u5668\u9700\u8981\u63D0\u524D\u5B89\u88C5Allow CROS\u63D2\u4EF6\u89E3\u51B3",-1),ki=s("hr",null,null,-1),vi=s("hr",null,null,-1),fi=s("p",null,"\u6458\u5F55\u81EA\u8D75\u73ED\u957F--------",-1);function xi(e,Pi,Si,Ei,t,Ni){const c=r;return A(),p(c,{frontmatter:t.frontmatter,data:t.data},{"main-content-md":l(()=>[u,y,h,D,g,m,_,b,k,v,f,x,P,S,E,N,R,T,K,I,M,w,L,j,O,G,U,V,H,Y,F,B,$,q,J,z,W,Z,X,Q,ss,ns,ls,es,as,os,ts,cs,rs,is,ps,As,Cs,ds,us,ys,hs,Ds,gs,ms,_s,bs,ks,vs,fs,xs,Ps,Ss,Es,Ns,Rs,Ts,Ks,Is,Ms,ws,Ls,js,Os,Gs,Us,Vs,Hs,Ys,Fs,Bs,$s,qs,Js,zs,Ws,Zs,Xs,Qs,sn,nn,ln,en,an,on,tn,cn,rn,pn,An,Cn,dn,un,yn,hn,Dn,gn,mn,_n,bn,kn,vn,fn,xn,Pn,Sn,En,Nn,Rn,Tn,Kn,In,Mn,wn,Ln,jn,On,Gn,Un,Vn,Hn,Yn,Fn,Bn,$n,qn,Jn,zn,Wn,Zn,Xn,Qn,sl,nl,ll,el,al,ol,tl,cl,rl,il,pl,Al,Cl,dl,ul,yl,hl,Dl,gl,ml,_l,bl,kl,vl,fl,xl,Pl,Sl,El,Nl,Rl,Tl,Kl,Il,Ml,wl,Ll,jl,Ol,Gl,Ul,Vl,Hl,Yl,Fl,Bl,$l,ql,Jl,zl,Wl,Zl,Xl,Ql,se,ne,le,ee,ae,oe,te,ce,re,ie,pe,Ae,Ce,de,ue,ye,he,De,ge,me,_e,be,ke,ve,fe,xe,Pe,Se,Ee,Ne,Re,Te,Ke,Ie,Me,we,Le,je,Oe,Ge,Ue,Ve,He,Ye,Fe,Be,$e,qe,Je,ze,We,Ze,Xe,Qe,sa,na,la,ea,aa,oa,ta,ca,ra,ia,pa,Aa,Ca,da,ua,ya,ha,Da,ga,ma,_a,ba,ka,va,fa,xa,Pa,Sa,Ea,Na,Ra,Ta,Ka,Ia,Ma,wa,La,ja,Oa,Ga,Ua,Va,Ha,Ya,Fa,Ba,$a,qa,Ja,za,Wa,Za,Xa,Qa,so,no,lo,eo,ao,oo,to,co,ro,io,po,Ao,Co,uo,yo,ho,Do,go,mo,_o,bo,ko,vo,fo,xo,Po,So,Eo,No,Ro,To,Ko,Io,Mo,wo,Lo,jo,Oo,Go,Uo,Vo,Ho,Yo,Fo,Bo,$o,qo,Jo,zo,Wo,Zo,Xo,Qo,st,nt,lt,et,at,ot,tt,ct,rt,it,pt,At,Ct,dt,ut,yt,ht,Dt,gt,mt,_t,bt,kt,vt,ft,xt,Pt,St,Et,Nt,Rt,Tt,Kt,It,Mt,wt,Lt,jt,Ot,Gt,Ut,Vt,Ht,Yt,Ft,Bt,$t,qt,Jt,zt,Wt,Zt,Xt,Qt,sc,nc,lc,ec,ac,oc,tc,cc,rc,ic,pc,Ac,Cc,dc,uc,yc,hc,Dc,gc,mc,_c,bc,kc,vc,fc,xc,Pc,Sc,Ec,Nc,Rc,Tc,Kc,Ic,Mc,wc,Lc,jc,Oc,Gc,Uc,Vc,Hc,Yc,Fc,Bc,$c,qc,Jc,zc,Wc,Zc,Xc,Qc,sr,nr,lr,er,ar,or,tr,cr,rr,ir,pr,Ar,Cr,dr,ur,yr,hr,Dr,gr,mr,_r,br,kr,vr,fr,xr,Pr,Sr,Er,Nr,Rr,Tr,Kr,Ir,Mr,wr,Lr,jr,Or,Gr,Ur,Vr,Hr,Yr,Fr,Br,$r,qr,Jr,zr,Wr,Zr,Xr,Qr,si,ni,li,ei,ai,oi,ti,ci,ri,ii,pi,Ai,Ci,di,ui,yi,hi,Di,gi,mi,_i,bi,ki,vi,fi]),"main-header":l(()=>[a(e.$slots,"main-header")]),"main-header-after":l(()=>[a(e.$slots,"main-header-after")]),"main-nav":l(()=>[a(e.$slots,"main-nav")]),"main-content":l(()=>[a(e.$slots,"main-content")]),"main-content-after":l(()=>[a(e.$slots,"main-content-after")]),"main-nav-before":l(()=>[a(e.$slots,"main-nav-before")]),"main-nav-after":l(()=>[a(e.$slots,"main-nav-after")]),comment:l(()=>[a(e.$slots,"comment")]),footer:l(()=>[a(e.$slots,"footer")]),aside:l(()=>[a(e.$slots,"aside")]),"aside-custom":l(()=>[a(e.$slots,"aside-custom")]),default:l(()=>[a(e.$slots,"default")]),_:3},8,["frontmatter","data"])}const Li=i(d,[["render",xi]]);export{wi as __pageData,Li as default};
