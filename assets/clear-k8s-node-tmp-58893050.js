import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang-e7d89830.js";import{_ as p,c as h,w as a,o as u,a as _,b as e,d as s,e as o,r as t,f as m,p as f}from"./app-4d89398e.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-2ca9ab31.js";import"./YunCard.vue_vue_type_style_index_0_lang-4f49289b.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-a8598bd1.js";const R=JSON.parse('{"title":"清理k8s节点空间","description":"","frontmatter":{"title":"清理k8s节点空间","date":"2025-07-08T16:49:11.000Z","updated":"2025-07-08T16:49:11.000Z","tags":null,"categories":null,"end":false},"headers":[{"level":2,"title":"背景","slug":"背景","link":"#背景","children":[]},{"level":2,"title":"步骤","slug":"步骤","link":"#步骤","children":[{"level":3,"title":"1. 确认 Pod 的 UID","slug":"_1-确认-pod-的-uid","link":"#_1-确认-pod-的-uid","children":[]},{"level":3,"title":"2. 查找 Pod 的名称","slug":"_2-查找-pod-的名称","link":"#_2-查找-pod-的名称","children":[]},{"level":3,"title":"3. 确认 Pod 所在的命名空间","slug":"_3-确认-pod-所在的命名空间","link":"#_3-确认-pod-所在的命名空间","children":[]},{"level":3,"title":"4. 进入 Pod 检查数据","slug":"_4-进入-pod-检查数据","link":"#_4-进入-pod-检查数据","children":[]},{"level":3,"title":"5. 评估和清理数据","slug":"_5-评估和清理数据","link":"#_5-评估和清理数据","children":[]}]}],"relativePath":"pages/posts/clear-k8s-node-tmp.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/clear-k8s-node-tmp.md","lastUpdated":1752023798000}'),d=JSON.parse('{"title":"清理k8s节点空间","description":"","frontmatter":{"title":"清理k8s节点空间","date":"2025-07-08T16:49:11.000Z","updated":"2025-07-08T16:49:11.000Z","tags":null,"categories":null,"end":false},"headers":[{"level":2,"title":"背景","slug":"背景","link":"#背景","children":[]},{"level":2,"title":"步骤","slug":"步骤","link":"#步骤","children":[{"level":3,"title":"1. 确认 Pod 的 UID","slug":"_1-确认-pod-的-uid","link":"#_1-确认-pod-的-uid","children":[]},{"level":3,"title":"2. 查找 Pod 的名称","slug":"_2-查找-pod-的名称","link":"#_2-查找-pod-的名称","children":[]},{"level":3,"title":"3. 确认 Pod 所在的命名空间","slug":"_3-确认-pod-所在的命名空间","link":"#_3-确认-pod-所在的命名空间","children":[]},{"level":3,"title":"4. 进入 Pod 检查数据","slug":"_4-进入-pod-检查数据","link":"#_4-进入-pod-检查数据","children":[]},{"level":3,"title":"5. 评估和清理数据","slug":"_5-评估和清理数据","link":"#_5-评估和清理数据","children":[]}]}],"relativePath":"pages/posts/clear-k8s-node-tmp.md","path":"/Users/vlinux/vlinux/blog/valaxy/vlinux.github.io/pages/posts/clear-k8s-node-tmp.md","lastUpdated":1752023798000}'),b={name:"pages/posts/clear-k8s-node-tmp.md",data(){return{data:d,frontmatter:d.frontmatter}},setup(){f("pageData",d)}},g={id:"kubernetes-pod-数据清理笔记",tabindex:"-1"},C={id:"背景",tabindex:"-1"},k=e("p",null,[s("在 Kubernetes 集群中，节点的磁盘空间不足，触发了磁盘告警。为了清理不必要的数据，我需要找出 "),e("code",null,"/var/lib/kubelet/pods/44be8a3d-d1dc-4b41-8d16-1ecb80d216f5/volumes/kubernetes.io~empty-dir/tmpdata/persistent-queue/"),s(" 目录下的数据是由哪个 Pod 或容器生成的。")],-1),v={id:"步骤",tabindex:"-1"},y={id:"_1-确认-pod-的-uid",tabindex:"-1"},D=e("p",null,[s("首先，我确认了该路径中的 UID，即 "),e("code",null,"44be8a3d-d1dc-4b41-8d16-1ecb80d216f5"),s("，这是目标 Pod 在 Kubernetes 中的唯一标识符。")],-1),A={id:"_2-查找-pod-的名称",tabindex:"-1"},P=e("p",null,"使用以下命令列出当前命名空间下的所有 Pods，以找到与该 UID 相对应的 Pod 名称：",-1),x=e("div",{class:"language-bash"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#FFCB6B"}},"kubectl"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C3E88D"}},"get"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C3E88D"}},"pods"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C3E88D"}},"--all-namespaces"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C3E88D"}},"-o"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C3E88D"}},"json"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"|"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"jq"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"'"),e("span",{style:{color:"#C3E88D"}},'.items[] | select(.metadata.uid=="44be8a3d-d1dc-4b41-8d16-1ecb80d216f5") | .metadata.name'),e("span",{style:{color:"#89DDFF"}},"'")]),s(`
`),e("span",{class:"line"})])])],-1),$=e("p",null,[s("如果您没有安装 "),e("code",null,"jq"),s("，可以手动逐个检查 Pods，确认 UID。")],-1),F={id:"_3-确认-pod-所在的命名空间",tabindex:"-1"},U=e("p",null,"在查找 Pod 名称的同时，确认该 Pod 所在的命名空间，之后使用下述命令确认 Pod 的详细信息：",-1),B=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"kubectl describe pod <pod-name> -n <namespace>")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})])])])],-1),N={id:"_4-进入-pod-检查数据",tabindex:"-1"},E=e("p",null,"确认 Pod 和容器信息后，我可以进入该 Pod 的终端，以查看具体存储在指定路径下的数据：",-1),I=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"kubectl exec -it <pod-name> -n <namespace> -- /bin/sh")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})])])])],-1),T=e("p",null,"或者",-1),V=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"kubectl exec -it <pod-name> -n <namespace> -- /bin/bash")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})])])])],-1),q=e("p",null,"进入之后，检查该目录：",-1),K=e("div",{class:"language-"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"cd /tmpdata/persistent-queue/")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"ls -la")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}})])])])],-1),Z={id:"_5-评估和清理数据",tabindex:"-1"},j=e("p",null,"通过检查该目录中的文件和数据，评估哪些数据可以安全地删除，以释放磁盘空间。",-1);function S(l,w,J,O,i,L){const n=m,r=c;return u(),h(r,{frontmatter:i.frontmatter,data:i.data},{"main-content-md":a(()=>[_(" more "),e("h1",g,[s("Kubernetes Pod 数据清理笔记 "),o(n,{class:"header-anchor",href:"#kubernetes-pod-数据清理笔记","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),e("h2",C,[s("背景 "),o(n,{class:"header-anchor",href:"#背景","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),k,e("h2",v,[s("步骤 "),o(n,{class:"header-anchor",href:"#步骤","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),e("h3",y,[s("1. 确认 Pod 的 UID "),o(n,{class:"header-anchor",href:"#_1-确认-pod-的-uid","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),D,e("h3",A,[s("2. 查找 Pod 的名称 "),o(n,{class:"header-anchor",href:"#_2-查找-pod-的名称","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),P,x,$,e("h3",F,[s("3. 确认 Pod 所在的命名空间 "),o(n,{class:"header-anchor",href:"#_3-确认-pod-所在的命名空间","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),U,B,e("h3",N,[s("4. 进入 Pod 检查数据 "),o(n,{class:"header-anchor",href:"#_4-进入-pod-检查数据","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),E,I,T,V,q,K,e("h3",Z,[s("5. 评估和清理数据 "),o(n,{class:"header-anchor",href:"#_5-评估和清理数据","aria-hidden":"true"},{default:a(()=>[s("#")]),_:1})]),j]),"main-header":a(()=>[t(l.$slots,"main-header")]),"main-header-after":a(()=>[t(l.$slots,"main-header-after")]),"main-nav":a(()=>[t(l.$slots,"main-nav")]),"main-content":a(()=>[t(l.$slots,"main-content")]),"main-content-after":a(()=>[t(l.$slots,"main-content-after")]),"main-nav-before":a(()=>[t(l.$slots,"main-nav-before")]),"main-nav-after":a(()=>[t(l.$slots,"main-nav-after")]),comment:a(()=>[t(l.$slots,"comment")]),footer:a(()=>[t(l.$slots,"footer")]),aside:a(()=>[t(l.$slots,"aside")]),"aside-custom":a(()=>[t(l.$slots,"aside-custom")]),default:a(()=>[t(l.$slots,"default")]),_:3},8,["frontmatter","data"])}const W=p(b,[["render",S]]);export{R as __pageData,W as default};
