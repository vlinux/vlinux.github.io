import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.DBuGQqdy.js";import"./chunks/@vueuse/motion.BITvz5PP.js";import{e as c,u,a as E}from"./chunks/vue-router.BxaDuBsg.js";import{aa as y,ap as l,ag as n,ae as m,af as s,ai as a,P as b,ab as F,a1 as A}from"./framework.GHZxz7jq.js";import"./index.DpUV-Spk.js";import"./chunks/dayjs.BldX5ftQ.js";import"./chunks/vue-i18n.C7V8WoQZ.js";import"./chunks/pinia.BfAlK2F6.js";import"./chunks/nprogress.BZwbcB2O.js";/* empty css                    */import"./YunComment.vue_vue_type_style_index_0_lang.MEbNDp3K.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.fblE3Fel.js";import"./post.CjbzLuOT.js";const f=c("/posts/install-nacos",async e=>JSON.parse('{"title":"Nacos开启鉴权","description":"","frontmatter":{"title":"Nacos开启鉴权","date":"2024-10-08 10:51:37","updated":"2024-10-08 10:51:37","tags":"Nacos","categories":"Linux技术","end":false},"headers":[],"relativePath":"pages/posts/install-nacos.md","lastUpdated":null}'),{lazy:(e,h)=>e.name===h.name}),U={__name:"install-nacos",setup(e,{expose:h}){const{data:k}=f(),o=E(),p=u(),r=Object.assign(p.meta.frontmatter||{},k.value?.frontmatter||{});return o.currentRoute.value.data=k.value,A("valaxy:frontmatter",r),globalThis.$frontmatter=r,h({frontmatter:{title:"Nacos开启鉴权",date:"2024-10-08 10:51:37",updated:"2024-10-08 10:51:37",tags:"Nacos",categories:"Linux技术",end:!1}}),(t,i)=>{const d=g;return F(),y(d,{frontmatter:b(r)},{"main-content-md":l(()=>[m(" more "),i[0]||(i[0]=s("h1",{id:"安装nacos",tabindex:"-1"},[a("安装Nacos "),s("a",{class:"header-anchor",href:"#安装nacos","aria-label":'Permalink to "安装Nacos"'},"​")],-1)),i[1]||(i[1]=s("h2",{id:"单节点安装",tabindex:"-1"},[a("单节点安装 "),s("a",{class:"header-anchor",href:"#单节点安装","aria-label":'Permalink to "单节点安装"'},"​")],-1)),i[2]||(i[2]=s("p",null,"参考：",-1)),i[3]||(i[3]=s("p",null,[s("a",{href:"https://nacos.io/docs/latest/manual/admin/deployment/deployment-standalone/",target:"_blank",rel:"noreferrer"},"https://nacos.io/docs/latest/manual/admin/deployment/deployment-standalone/")],-1)),i[4]||(i[4]=s("p",null,[s("a",{href:"https://www.cnblogs.com/liuqq1015/p/17822802.html",target:"_blank",rel:"noreferrer"},"https://www.cnblogs.com/liuqq1015/p/17822802.html")],-1)),i[5]||(i[5]=s("ol",null,[s("li",null,"安装JDK1.8或以上"),s("li",null,"安装数据库，版本要求：5.6.5+ ，或使用内置数据库（使用内置数据库不用修改配置文件有关数据库字段application.properties）"),s("li",null,[a("初始化mysql数据库，数据库初始化文件："),s("a",{href:"https://github.com/alibaba/nacos/blob/master/distribution/conf/mysql-schema.sql",target:"_blank",rel:"noreferrer"},"mysql-schema.sql")]),s("li",null,"配置application.properties")],-1)),i[6]||(i[6]=s("div",{class:"language-"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"db.num=1")]),a(`
`),s("span",{class:"line"},[s("span",null,"db.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC")]),a(`
`),s("span",{class:"line"},[s("span",null,"db.user.0=*******")]),a(`
`),s("span",{class:"line"},[s("span",null,"db.password.0=********")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[7]||(i[7]=s("ol",{start:"5"},[s("li",null,"启动单节点模式sh startup.sh -m standalone，查看日志tail -f /opt/nacos/logs/start.out")],-1)),i[8]||(i[8]=s("h2",{id:"集群模式安装",tabindex:"-1"},[a("集群模式安装 "),s("a",{class:"header-anchor",href:"#集群模式安装","aria-label":'Permalink to "集群模式安装"'},"​")],-1)),i[9]||(i[9]=s("p",null,"此处暂时省略，可以查看官方文档",-1)),i[10]||(i[10]=s("h2",{id:"开启鉴权",tabindex:"-1"},[a("开启鉴权 "),s("a",{class:"header-anchor",href:"#开启鉴权","aria-label":'Permalink to "开启鉴权"'},"​")],-1)),i[11]||(i[11]=s("h3",{id:"_1、nacos开启鉴权",tabindex:"-1"},[a("1、nacos开启鉴权 "),s("a",{class:"header-anchor",href:"#_1、nacos开启鉴权","aria-label":'Permalink to "1、nacos开启鉴权"'},"​")],-1)),i[12]||(i[12]=s("ul",null,[s("li",null,"2.2.2版本之前的Nacos默认控制台，无论服务端是否开启鉴权，都会存在一个登录页，这就导致很多用户被误导认为Nacos默认是存在鉴权的。"),s("li",null,"在社区安全工程师的建议下，Nacos自2.2.2版本开始，在未开启鉴权时，默认控制台将不需要登录即可访问，同时在控制台中给予提示，提醒用户当前集群未开启鉴权，在用户开启鉴权后，控制台才需要进行登录访问。"),s("li",null,"开启鉴权功能之后，访问Nacos服务端API和控制台都需要输入用户名和密码（默认的用户名和密码都是nacos，可以登录控制台进行修改密码），可以提高Nacos的安全性，如果客户端（其它服务或者控制台用户）无法提供正确的用户名和密码，将无法访问Nacos Server，这样可以防止服务端被非授权访问，所以对于生产环境中的Nacos Server推荐设置为true。"),s("li",null,"如果Nacos禁用鉴权功能，此时访问Nacos服务端API和控制台不需要任何登录即可匿名访问。")],-1)),i[13]||(i[13]=s("h4",{id:"_1-1、修改nacos配置文件-application-properties",tabindex:"-1"},[a("1.1、修改nacos配置文件（application.properties） "),s("a",{class:"header-anchor",href:"#_1-1、修改nacos配置文件-application-properties","aria-label":'Permalink to "1.1、修改nacos配置文件（application.properties）"'},"​")],-1)),i[14]||(i[14]=s("p",null,[a("如果 "),s("code",null,"nacos.core.auth.enabled"),a(" 设置为true，必须添加以下"),s("code",null,"nacos.core.auth.server.identity.key"),a("、"),s("code",null,"nacos.core.auth.server.identity.value"),a("、"),s("code",null,"nacos.core.auth.plugin.nacos.token.secret.key"),a("配置，否则无法启动节点。 "),s("strong",null,"推荐开启如下配置")],-1)),i[15]||(i[15]=s("div",{class:"language-ini"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ini"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 开启鉴权功能")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.enabled"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=true")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 关闭使用user-agent判断服务端请求并放行鉴权的功能")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.enable.userAgentAuthWhite"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=false")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 配置自定义身份识别的key和value，这两个属性是auth的白名单，用于标识来自其它服务器的请求，具体实现见 com.alibaba.nacos.core.auth.AuthFilter。")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.server.identity.key"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=authKey")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.server.identity.value"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=shigzh")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 自定义用于生成JWT令牌的密钥，注意：原始密钥长度不得低于32字符，且一定要进行Base64编码，否则无法启动节点。")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.plugin.nacos.token.secret.key"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=bmFjb3NfMjAyNDAxMTBfc2hpZ3poX25hY29zX3Rva2Vu")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 权限缓存开关，开启后权限缓存的更新默认有15秒的延迟，默认 : false")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"nacos.core.auth.caching.enabled"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"=true")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[16]||(i[16]=s("h4",{id:"_1-2、自定义生成jwt令牌的密钥",tabindex:"-1"},[a("1.2、自定义生成JWT令牌的密钥 "),s("a",{class:"header-anchor",href:"#_1-2、自定义生成jwt令牌的密钥","aria-label":'Permalink to "1.2、自定义生成JWT令牌的密钥"'},"​")],-1)),i[17]||(i[17]=s("p",null,"注意：原始密钥长度不得低于32字符，且一定要进行Base64编码，否则无法启动节点。",-1)),i[18]||(i[18]=s("div",{class:"language-typescript"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"typescript"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"/**")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * <p>")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * nacos中JWT令牌密钥生成器<br>")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * 生成 nacos.core.auth.plugin.nacos.token.secret.key 的值")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * </p>")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@author"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," shigzh")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," * "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"@since"),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," 2024/1/10 13:41")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}}," */")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"public "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"class"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," NacosSecretUtil"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    public"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"String"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[] "),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"args"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") {")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 自定义生成JWT令牌的密钥")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        String nacosSecret "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "nacos_20240110_shigzh_nacos_token"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 输出密钥长度，要求不得低于32字符，否则无法启动节点。")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"密钥长度》》》"'),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nacosSecret."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"length"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"());")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 密钥进行Base64编码")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        byte[] data "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nacosSecret."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getBytes"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(StandardCharsets."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"UTF_8"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        System.out."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"println"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"密钥Base64编码》》》"'),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Base64Utils."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"encodeToString"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(data));")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[19]||(i[19]=s("h3",{id:"_2、nacos鉴权测试",tabindex:"-1"},[a("2、nacos鉴权测试 "),s("a",{class:"header-anchor",href:"#_2、nacos鉴权测试","aria-label":'Permalink to "2、nacos鉴权测试"'},"​")],-1)),i[20]||(i[20]=s("h4",{id:"_2-1、不开启鉴权测试",tabindex:"-1"},[a("2.1、不开启鉴权测试 "),s("a",{class:"header-anchor",href:"#_2-1、不开启鉴权测试","aria-label":'Permalink to "2.1、不开启鉴权测试"'},"​")],-1)),i[21]||(i[21]=s("p",null,[a("如果nacos不开启鉴权，即 "),s("code",null,"nacos.core.auth.enabled = false"),a("，在这种情况下通过一些请求就可以绕过nacos的权限认证，然后访问nacos的一些数据。 1、在未登录认证的情况下，通过postman以get方式访问"),s("code",null,"/nacos/v1/cs/configs"),a("请求来获取nacos的配置信息，可以正常获取到数据。")],-1)),i[22]||(i[22]=s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"http://sgz.wz:8848/nacos/v1/cs/configs?dataId"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&group"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&appName"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&config_tags"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&pageNo"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&pageSize"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"10"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&tenant"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&search"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"accurate"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&accessToken"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&username"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[23]||(i[23]=s("figure",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111151531287-527499284.png",alt:"img",loading:"lazy",decoding:"async"})],-1)),i[24]||(i[24]=s("p",null,[a("2、在未登录认证的情况下，通过postman以get方式访问"),s("code",null,"/nacos/v1/auth/users"),a("请求来获取nacos的用户信息，可以正常获取到数据。")],-1)),i[25]||(i[25]=s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"http://sgz.wz:8848/nacos/v1/auth/users?pageNo"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&pageSize"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"9"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&search"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"blur")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[26]||(i[26]=s("figure",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111151728348-2065281444.png",alt:"img",loading:"lazy",decoding:"async"})],-1)),i[27]||(i[27]=s("p",null,[a("3、在未登录认证的情况下，通过postman以post方式访问"),s("code",null,"/nacos/v1/auth/users"),a("请求，传入指定参数，可以直接新增用户。")],-1)),i[28]||(i[28]=s("div",{class:"language-bash"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"http://sgz.wz:8848/nacos/v1/auth/users?username"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"=test2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&password"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"test2")])])]),s("button",{class:"code-block-unfold-btn"})],-1)),i[29]||(i[29]=s("p",null,[s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111151906922-1323107565.png",alt:"img"}),a(" 数据库中也存在新增的用户信息 "),s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111152308299-1210876117.png",alt:"img"})],-1)),i[30]||(i[30]=s("h4",{id:"_2-2、开启鉴权测试",tabindex:"-1"},[a("2.2、开启鉴权测试 "),s("a",{class:"header-anchor",href:"#_2-2、开启鉴权测试","aria-label":'Permalink to "2.2、开启鉴权测试"'},"​")],-1)),i[31]||(i[31]=s("p",null,[a("如果nacos开启鉴权，即 "),s("code",null,"nacos.core.auth.enabled = true"),a("，在这种情况下就可以避免上面的nacos权限认证问题，如果不登录认证就不能访问nacos的一些数据，此时访问就会报403 Forbidden错误。 "),s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111152900291-825669718.png",alt:"img"}),a(" 此时在请求header里添加一对属性参数 "),s("code",null,"authKey=shigzh"),a("，即我们配置的自定义身份识别的 "),s("code",null,"nacos.core.auth.server.identity.key=authKey"),a(" 和 "),s("code",null,"nacos.core.auth.server.identity.value=shigzh"),a("（这两个属性是auth的白名单，用于标识来自其他服务器的请求），这样也可以正常操作nacos的一些接口，相当于鉴权了，即可跳过权限认证。 "),s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111161156423-206201221.png",alt:"img"})],-1)),i[32]||(i[32]=s("p",null,[a("header属性配置"),s("code",null,"authKey=shigzh"),a("能够跳过权限认证的原理是 com.alibaba.nacos.core.auth.AuthFilter 过滤器，具体逻辑如下图 "),s("img",{src:"https://cos.vlinux.cn/www-vlinux-cn-blog-img/1680363-20240111163713753-808447754.png",alt:"img"})],-1))]),"main-header":l(()=>[n(t.$slots,"main-header")]),"main-header-after":l(()=>[n(t.$slots,"main-header-after")]),"main-nav":l(()=>[n(t.$slots,"main-nav")]),"main-content-before":l(()=>[n(t.$slots,"main-content-before")]),"main-content":l(()=>[n(t.$slots,"main-content")]),"main-content-after":l(()=>[n(t.$slots,"main-content-after")]),"main-nav-before":l(()=>[n(t.$slots,"main-nav-before")]),"main-nav-after":l(()=>[n(t.$slots,"main-nav-after")]),comment:l(()=>[n(t.$slots,"comment")]),footer:l(()=>[n(t.$slots,"footer")]),aside:l(()=>[n(t.$slots,"aside")]),"aside-custom":l(()=>[n(t.$slots,"aside-custom")]),default:l(()=>[n(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{U as default,f as usePageData};
